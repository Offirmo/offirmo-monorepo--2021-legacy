<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
</head>
<body>

<script>
	const JSW_BASEURL__TEAM = 'https://jdog.jira-dev.com'
	const JSW_PROJECT__TEAM = 'KURO'
	const TEAM_ID = (new URL(window.location.href)).searchParams.get('teamid') || 'yjutard'
	const JQL_DATE_BEGIN = '2020/07/01'
	const JQL_DATE_END = '2021/06/30'
	const HELLO_SPACE__TEAM = 'agile'

	window.document.title = TEAM_ID

	const input_elt = document.createElement('pre')
	const DATA = { TEAM_ID, JQL_DATE_BEGIN, JQL_DATE_END, HELLO_SPACE__TEAM, JSW_BASEURL__TEAM, JSW_PROJECT__TEAM }
	input_elt.innerHTML = '*** INPUT:\n' + Object.keys(DATA).map(k => `${k}: ${DATA[k]}`).join('\n')
	document.body.appendChild(input_elt)

	const DERIVED = {
		yjutard: {
			'atlassian.com': {
				id: '557058:485ecbf7-91cf-4faf-8e04-fc1752ff04a6',
			},
			'jdog.jira-dev.com': {
				//id: '???',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~yjutard',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: 'fccd7d3b-b928-4b1a-890e-aae6b8442e6b'
				},
			},
		},

		amoret: {
			'atlassian.com': {
				id: '5ebbb9ce0590bb0b7b5d68c2',
			},
			'jdog.jira-dev.com': {
				//id: '???',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~813251567',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: '158b4faf-37b9-48d2-a4d8-8c3b8af79507'
				},
			},
		},
		fyasir: {
			'atlassian.com': {
				id: '5d02eb56a315460bc8469c43',
			},
			'jdog.jira-dev.com': {
				id: '5d02ed595b75cc0c04cca627',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~272466779',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: '???'
				},
			},
		},
		ffort: {
			'atlassian.com': {
				id: '6023a9ece7deee00692be3f5',
			},
			'jdog.jira-dev.com': {
				//id: '???',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~262405381',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: '???'
				},
			},
		},
		jhe2: {
			'atlassian.com': {
				id: '5fbe3905aca10c006979ae2e',
			},
			'jdog.jira-dev.com': {
				id: '5fbe2b3aaca10c00697924a3',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~692782091',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: '???'
				},
			},
		},
		jwong5: {
			'atlassian.com': {
				id: '5fbe391af8b0120069a2d790',
			},
			'jdog.jira-dev.com': {
				id: '5fbe2b5ffacfd60076ecbc10',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~620663553',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: '???'
				},
			},
		},
		mperzanowski: {
			'atlassian.com': {
				id: '5acd57c4af21cf2a748381c9',
			},
			'jdog.jira-dev.com': {
				id: '5acee3544fe2de2a7f631619',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~mperzanowski',
				}
			},
			'bitbucket.org': {
				'atlassian': {
					id: 'a2c94e6c-4e70-467b-8093-d4b8403c47e5'
				},
			},
		},
		wkuang: {
			'atlassian.com': {
				id: '5f86c1e3bdef80006f8d5e33',
			},
			'jdog.jira-dev.com': {
				id: '5f86c2f7b2964c006e69c68f',
			},
			'hello.atlassian.net': {
				'wiki': {
					space_id: '~519519104',
				}
			},
			/*'team.atlassian.com': {
				people: 'c814de94-1f14-4dbc-ae26-52e79ae2432a',
			},*/
			'bitbucket.org': {
				'atlassian': {
					id: '501440f2-e88c-4e68-bacc-aeb4e98e6599'
				},
			},
		},
	}

	const FACT_SOURCES = {

		'directory': () => {
			return `https://directory.prod.atl-paas.net/employees/${TEAM_ID}`
		},
		'kudos--received': () => {
			//https://hello.atlassian.net/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+RP+AND+created+%3E%3D+%272018%2F07%2F01%27+AND+created+%3C+%272019%2F07%2F01%27+AND+Nominee+in+%28lbain%29+&src=confmacro
			// note: the team id doesn't always work, atlassian id is more reliable
			const url = new URL('https://hello.atlassian.net/secure/IssueNavigator.jspa')
			url.searchParams.append('jqlQuery', `project = RP AND created >= '${JQL_DATE_BEGIN}' AND created <= '${JQL_DATE_END}' AND Nominee = ${DERIVED[TEAM_ID]['atlassian.com'].id}`)

			return url.href
		},
		'kudos--given': () => {
			//https://hello.atlassian.net/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+RP+AND+created+%3E%3D+%272018%2F07%2F01%27+AND+created+%3C+%272019%2F07%2F01%27+AND+Nominee+in+%28lbain%29+&src=confmacro
			// note: the team id doesn't always work, atlassian id is more reliable

			const url = new URL('https://hello.atlassian.net/secure/IssueNavigator.jspa')
			//url.searchParams.append('reset', true)
			url.searchParams.append('jqlQuery', `project = RP AND created >= '${JQL_DATE_BEGIN}' AND created <= '${JQL_DATE_END}' AND reporter = ${DERIVED[TEAM_ID]['atlassian.com'].id}`)

			return url.href
		},

		'JSW issues--resolved': () => {
			//https://jdog.jira-dev.com?jql=project%20%3D%20%22KURO%22%20AND%20reporter%20%3D%20%225fbe2b3aaca10c00697924a3%22%20AND%20resolved%20%3E%3D%20%222021-04-25%22%20AND%20resolved%20%3C%3D%20%222021-06-30%22%20ORDER%20BY%20created%20DESC
			// note: the team id doesn't always work, atlassian id is more reliable

			//	https://jdog.jira-dev.com/issues/?jql=project %3D KURO and assignee %3D 5cbfb11750ff750e51012b24 and resolutiondate > '2019%2F07%2F01'
			// assignee = 'lbain@atlassian.com' and resolutiondate >= '2018/07/01' and resolutiondate < '2019/07/01' order by updated ASC

			const url = new URL(`/jira/software/projects/${JSW_PROJECT__TEAM}/issues`, JSW_BASEURL__TEAM)
			//url.searchParams.append('reset', true)
			url.searchParams.append('jql', `project = ${JSW_PROJECT__TEAM} AND resolutiondate >= '${JQL_DATE_BEGIN}' AND resolutiondate <= '${JQL_DATE_END}' AND assignee = ${(DERIVED[TEAM_ID]['jdog.jira-dev.com'] || DERIVED[TEAM_ID]['atlassian.com']).id} ORDER BY resolutiondate ASC`)

			return url.href
		},
		'JSW issues--created': () => {
			const url = new URL(`/jira/software/projects/${JSW_PROJECT__TEAM}/issues`, JSW_BASEURL__TEAM)
			//url.searchParams.append('reset', true)
			// TODO creator or reporter
			url.searchParams.append('jql', `project = ${JSW_PROJECT__TEAM} AND createdDate >= '${JQL_DATE_BEGIN}' AND createdDate <= '${JQL_DATE_END}' AND creator = ${(DERIVED[TEAM_ID]['jdog.jira-dev.com'] || DERIVED[TEAM_ID]['atlassian.com']).id} ORDER BY createdDate ASC`)

			return url.href
		},

		'PRs--merged--JIRACLOUD--jira-frontend': () => {
			const url = new URL(`https://stash.atlassian.com/projects/JIRACLOUD/repos/jira-frontend/pull-requests`)
			url.searchParams.append('state', `MERGED`)
			url.searchParams.append('author', TEAM_ID)

			return url.href

		},
		'PRs--declined--JIRACLOUD--jira-frontend': () => {
			const url = new URL(`https://stash.atlassian.com/projects/JIRACLOUD/repos/jira-frontend/pull-requests`)
			url.searchParams.append('state', `DECLINED`)
			url.searchParams.append('author', TEAM_ID)

			return url.href

		},
		'PRs--reviewed--JIRACLOUD--jira-frontend': () => {
			const url = new URL(`https://stash.atlassian.com/projects/JIRACLOUD/repos/jira-frontend/pull-requests`)
			url.searchParams.append('state', `ALL`)
			url.searchParams.append('reviewer', TEAM_ID)

			return url.href
		},

		'PRs--merged--JIRACLOUD--jira': () => {
			const url = new URL(`https://stash.atlassian.com/projects/JIRACLOUD/repos/jira/pull-requests`)
			url.searchParams.append('state', `MERGED`)
			url.searchParams.append('author', TEAM_ID)

			return url.href

		},

		'PRs--merged--atlassian-frontend': () => {
			const url = new URL(`https://bitbucket.org/atlassian/atlassian-frontend/pull-requests/`)
			url.searchParams.append('state', `MERGED`)
			url.searchParams.append('author', DERIVED[TEAM_ID]['bitbucket.org'].atlassian.id)

			return url.href

		},
		'PRs--declined--atlassian-frontend': () => {
			const url = new URL(`https://bitbucket.org/atlassian/atlassian-frontend/pull-requests/`)
			url.searchParams.append('state', `DECLINED`)
			url.searchParams.append('author', DERIVED[TEAM_ID]['bitbucket.org'].atlassian.id)

			return url.href

		},
		'PRs--reviewed--atlassian-frontend': () => {
			const url = new URL(`https://bitbucket.org/atlassian/atlassian-frontend/pull-requests/`)
			url.searchParams.append('state', `ALL`)
			url.searchParams.append('author', DERIVED[TEAM_ID]['bitbucket.org'].atlassian.id)

			return url.href
		},


		'team-central': () => {
			// https://team.atlassian.com/people/5f86c1e3bdef80006f8d5e33
			const url = new URL(`https://team.atlassian.com/people/${DERIVED[TEAM_ID]['atlassian.com'].id}`)

			return url.href
		},
		'recently-worked-on': () => {
			const url = new URL(`https://team.atlassian.com/people/${DERIVED[TEAM_ID]['atlassian.com'].id}/work`)

			return url.href
		},

		'HOTs': () => {
			// https://ops.internal.atlassian.com/jira/issues/?jql=project %3D HOT AND (assignee in (amoret) O reporter in (amoret)
			const url = new URL(`https://ops.internal.atlassian.com/jira/issues/`)
			url.searchParams.append('jql', `project = HOT AND created >= '${JQL_DATE_BEGIN}' AND created <= '${JQL_DATE_END}' AND (assignee = ${TEAM_ID} OR reporter = ${TEAM_ID}) ORDER BY created ASC`)

			return url.href
		},

		'hello blog posts in own space': () => {
			// https://hello.atlassian.net/wiki/search?spaces=~519519104&type=blogpost&lastModified=custom&from=2021-04-26&to=2021-06-30
			const url = new URL(`https://hello.atlassian.net/wiki/search`)
			url.searchParams.append('spaces', DERIVED[TEAM_ID]['hello.atlassian.net'].wiki.space_id)
			url.searchParams.append('type', 'blogpost')
			url.searchParams.append('lastModified', 'custom')
			url.searchParams.append('from', JQL_DATE_BEGIN.replaceAll('/', '-'))
			url.searchParams.append('to', JQL_DATE_END.replaceAll('/', '-'))

			return url.href
		},

		'hello pages in team space': () => {
			// https://hello.atlassian.net/wiki/search?spaces=~519519104&type=blogpost&lastModified=custom&from=2021-04-26&to=2021-06-30
			const url = new URL(`https://hello.atlassian.net/wiki/search`)
			url.searchParams.append('spaces', HELLO_SPACE__TEAM)
			url.searchParams.append('type', 'page')
			url.searchParams.append('contributors', DERIVED[TEAM_ID]['atlassian.com'].id)
			url.searchParams.append('lastModified', 'custom')
			url.searchParams.append('from', JQL_DATE_BEGIN.replaceAll('/', '-'))
			url.searchParams.append('to', JQL_DATE_END.replaceAll('/', '-'))


			return url.href
		},

		'shipits': () => {
			// https://shipit.atlassian.net/issues/?jql=assignee%20in%20(557058%3A485ecbf7-91cf-4faf-8e04-fc1752ff04a6)%20order%20by%20created%20DESC
			const url = new URL(`https://shipit.atlassian.net/issues/`)
			url.searchParams.append('jql', `created >= '${JQL_DATE_BEGIN}' AND created <= '${JQL_DATE_END}' AND (assignee = ${TEAM_ID} OR reporter = ${TEAM_ID}) ORDER BY created ASC`)

			return url.href
		},

		'bugs reported -- JAC': () => {
			// https://jira.atlassian.com/browse/CONFCLOUD-62195?jql=project%20%3D%20CONFCLOUD%20AND%20reporter%20in%20(yjutard)%20ORDER%20BY%20priority%20DESC%2C%20updated%20DESC
			const url = new URL(`https://jira.atlassian.com/issues/`)
			url.searchParams.append('jql', `created >= '${JQL_DATE_BEGIN}' AND created <= '${JQL_DATE_END}' AND reporter = ${TEAM_ID} ORDER BY created ASC`)

			return url.href
		},
		'bugs reported -- customer feedback': () => {
			const url = new URL(`https://customerfeedback.atlassian.net/issues/`)
			url.searchParams.append('jql', `created >= '${JQL_DATE_BEGIN}' AND created <= '${JQL_DATE_END}' AND reporter = ${TEAM_ID} ORDER BY created ASC`)

			return url.href
		},

		'interviewer status': () => {
			// https://aip.staging.atl-paas.net/app/people/sguio
			return `https://aip.staging.atl-paas.net/app/people/${TEAM_ID}`
		},

		// PIR approved https://ops.internal.atlassian.com/jira/browse/PIR-8801?filter=-4&jql=project%20%3D%20PIR%20AND%20Approved%20in%20(yjutard)%20order%20by%20created%20DESC

		//'TODO': () => { return 'TODO' },

	}


	const output_elt = document.createElement('ul')
	output_elt.innerHTML = Object.keys(FACT_SOURCES).map(src_key => {
		const url = FACT_SOURCES[src_key]()
		return `<li>${src_key}: <a href="${url}">${url}</a>`
	}).join('\n')
	document.body.appendChild(output_elt)


	Object.keys(FACT_SOURCES).forEach(src_key => {
		console.log(src_key, ':\n', FACT_SOURCES[src_key]())
	})

	//url.searchParams.append('reset', true)


</script>
</body>
</html>
