{"dependencies":[{"name":"/Users/yjutard/work/src/off/offirmo-monorepo/1-foundation/soft-execution-context/.babelrc","includedInParent":true,"mtime":1527315405077},{"name":"/Users/yjutard/work/src/off/offirmo-monorepo/1-foundation/soft-execution-context/package.json","includedInParent":true,"mtime":1527752875823}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// IMMUTABLE!\n\n/////////////////////\n\nvar instance_count = 0;\nfunction create(parent_state) {\n\treturn {\n\t\tsid: instance_count++, // not really useful yet, but helps debug\n\t\tparent: parent_state || null,\n\t\tplugins: {},\n\t\tcache: {} // per-SEC cache for complex computations\n\t};\n}\n\nfunction activate_plugin(state, PLUGIN, args) {\n\tvar plugin_parent_state = state.parent ? state.parent.plugins[PLUGIN.id] : null;\n\n\tvar plugin_state = PLUGIN.state.create(plugin_parent_state);\n\t//plugin_state = PLUGIN.state.init_from_creation_args(plugin_state, args)\n\n\treturn _extends({}, state, {\n\t\tplugins: _extends({}, state.plugins, _defineProperty({}, PLUGIN.id, _extends({}, plugin_state, {\n\t\t\tsid: state.sid\n\t\t})))\n\t});\n}\n\nfunction reduce_plugin(state, PLUGIN_ID, reducer) {\n\tvar initial_plugin_state = state.plugins[PLUGIN_ID];\n\tvar new_plugin_state = reducer(initial_plugin_state);\n\n\tif (new_plugin_state === initial_plugin_state) return state; // no change\n\n\treturn _extends({}, state, {\n\t\tplugins: _extends({}, state.plugins, _defineProperty({}, PLUGIN_ID, new_plugin_state))\n\t});\n}\n\n/////////////////////\n\nexports.create = create;\nexports.activate_plugin = activate_plugin;\nexports.reduce_plugin = reduce_plugin;","map":{"mappings":[{"generated":{"line":11,"column":0},"source":"../../src/state.js","original":{"line":1,"column":0}},{"generated":{"line":13,"column":0},"source":"../../src/state.js","original":{"line":3,"column":0}},{"generated":{"line":15,"column":0},"source":"../../src/state.js","original":{"line":5,"column":0}},{"name":"instance_count","generated":{"line":15,"column":4},"source":"../../src/state.js","original":{"line":5,"column":4}},{"generated":{"line":15,"column":21},"source":"../../src/state.js","original":{"line":5,"column":21}},{"generated":{"line":15,"column":22},"source":"../../src/state.js","original":{"line":5,"column":0}},{"generated":{"line":16,"column":0},"source":"../../src/state.js","original":{"line":6,"column":0}},{"name":"create","generated":{"line":16,"column":9},"source":"../../src/state.js","original":{"line":6,"column":9}},{"generated":{"line":16,"column":15},"source":"../../src/state.js","original":{"line":6,"column":0}},{"name":"parent_state","generated":{"line":16,"column":16},"source":"../../src/state.js","original":{"line":6,"column":16}},{"generated":{"line":16,"column":28},"source":"../../src/state.js","original":{"line":6,"column":0}},{"generated":{"line":16,"column":30},"source":"../../src/state.js","original":{"line":6,"column":30}},{"generated":{"line":17,"column":0},"source":"../../src/state.js","original":{"line":7,"column":1}},{"generated":{"line":17,"column":8},"source":"../../src/state.js","original":{"line":7,"column":8}},{"name":"sid","generated":{"line":18,"column":0},"source":"../../src/state.js","original":{"line":8,"column":2}},{"name":"instance_count","generated":{"line":18,"column":7},"source":"../../src/state.js","original":{"line":8,"column":7}},{"generated":{"line":18,"column":23},"source":"../../src/state.js","original":{"line":7,"column":8}},{"generated":{"line":18,"column":25},"source":"../../src/state.js","original":{"line":8,"column":25}},{"name":"parent","generated":{"line":19,"column":0},"source":"../../src/state.js","original":{"line":9,"column":2}},{"name":"parent_state","generated":{"line":19,"column":10},"source":"../../src/state.js","original":{"line":9,"column":10}},{"generated":{"line":19,"column":26},"source":"../../src/state.js","original":{"line":9,"column":26}},{"generated":{"line":19,"column":30},"source":"../../src/state.js","original":{"line":7,"column":8}},{"name":"plugins","generated":{"line":20,"column":0},"source":"../../src/state.js","original":{"line":10,"column":2}},{"generated":{"line":20,"column":11},"source":"../../src/state.js","original":{"line":10,"column":11}},{"generated":{"line":20,"column":13},"source":"../../src/state.js","original":{"line":7,"column":8}},{"name":"cache","generated":{"line":21,"column":0},"source":"../../src/state.js","original":{"line":11,"column":2}},{"generated":{"line":21,"column":9},"source":"../../src/state.js","original":{"line":11,"column":9}},{"generated":{"line":21,"column":11},"source":"../../src/state.js","original":{"line":7,"column":8}},{"generated":{"line":21,"column":12},"source":"../../src/state.js","original":{"line":11,"column":13}},{"generated":{"line":22,"column":0},"source":"../../src/state.js","original":{"line":7,"column":8}},{"generated":{"line":22,"column":2},"source":"../../src/state.js","original":{"line":7,"column":1}},{"generated":{"line":23,"column":0},"source":"../../src/state.js","original":{"line":13,"column":1}},{"generated":{"line":25,"column":0},"source":"../../src/state.js","original":{"line":16,"column":0}},{"name":"activate_plugin","generated":{"line":25,"column":9},"source":"../../src/state.js","original":{"line":16,"column":9}},{"generated":{"line":25,"column":24},"source":"../../src/state.js","original":{"line":16,"column":0}},{"name":"state","generated":{"line":25,"column":25},"source":"../../src/state.js","original":{"line":16,"column":25}},{"generated":{"line":25,"column":30},"source":"../../src/state.js","original":{"line":16,"column":0}},{"name":"PLUGIN","generated":{"line":25,"column":32},"source":"../../src/state.js","original":{"line":16,"column":32}},{"generated":{"line":25,"column":38},"source":"../../src/state.js","original":{"line":16,"column":0}},{"name":"args","generated":{"line":25,"column":40},"source":"../../src/state.js","original":{"line":16,"column":40}},{"generated":{"line":25,"column":44},"source":"../../src/state.js","original":{"line":16,"column":0}},{"generated":{"line":25,"column":46},"source":"../../src/state.js","original":{"line":16,"column":46}},{"generated":{"line":26,"column":0},"source":"../../src/state.js","original":{"line":17,"column":1}},{"name":"plugin_parent_state","generated":{"line":26,"column":5},"source":"../../src/state.js","original":{"line":17,"column":7}},{"name":"state","generated":{"line":26,"column":27},"source":"../../src/state.js","original":{"line":17,"column":29}},{"name":"parent","generated":{"line":26,"column":33},"source":"../../src/state.js","original":{"line":17,"column":35}},{"generated":{"line":26,"column":39},"source":"../../src/state.js","original":{"line":17,"column":29}},{"name":"state","generated":{"line":26,"column":42},"source":"../../src/state.js","original":{"line":18,"column":4}},{"name":"parent","generated":{"line":26,"column":48},"source":"../../src/state.js","original":{"line":18,"column":10}},{"generated":{"line":26,"column":54},"source":"../../src/state.js","original":{"line":18,"column":4}},{"name":"plugins","generated":{"line":26,"column":55},"source":"../../src/state.js","original":{"line":18,"column":17}},{"generated":{"line":26,"column":62},"source":"../../src/state.js","original":{"line":18,"column":4}},{"name":"PLUGIN","generated":{"line":26,"column":63},"source":"../../src/state.js","original":{"line":18,"column":25}},{"name":"id","generated":{"line":26,"column":70},"source":"../../src/state.js","original":{"line":18,"column":32}},{"generated":{"line":26,"column":72},"source":"../../src/state.js","original":{"line":18,"column":4}},{"generated":{"line":26,"column":73},"source":"../../src/state.js","original":{"line":17,"column":29}},{"generated":{"line":26,"column":76},"source":"../../src/state.js","original":{"line":19,"column":4}},{"generated":{"line":26,"column":80},"source":"../../src/state.js","original":{"line":17,"column":1}},{"generated":{"line":28,"column":0},"source":"../../src/state.js","original":{"line":21,"column":1}},{"name":"plugin_state","generated":{"line":28,"column":5},"source":"../../src/state.js","original":{"line":21,"column":5}},{"name":"PLUGIN","generated":{"line":28,"column":20},"source":"../../src/state.js","original":{"line":21,"column":20}},{"name":"state","generated":{"line":28,"column":27},"source":"../../src/state.js","original":{"line":21,"column":27}},{"generated":{"line":28,"column":32},"source":"../../src/state.js","original":{"line":21,"column":20}},{"name":"create","generated":{"line":28,"column":33},"source":"../../src/state.js","original":{"line":21,"column":33}},{"generated":{"line":28,"column":39},"source":"../../src/state.js","original":{"line":21,"column":20}},{"name":"plugin_parent_state","generated":{"line":28,"column":40},"source":"../../src/state.js","original":{"line":21,"column":40}},{"generated":{"line":28,"column":59},"source":"../../src/state.js","original":{"line":21,"column":20}},{"generated":{"line":28,"column":60},"source":"../../src/state.js","original":{"line":21,"column":1}},{"generated":{"line":29,"column":0},"source":"../../src/state.js","original":{"line":22,"column":1}},{"generated":{"line":31,"column":0},"source":"../../src/state.js","original":{"line":24,"column":1}},{"name":"state","generated":{"line":31,"column":21},"source":"../../src/state.js","original":{"line":25,"column":5}},{"generated":{"line":31,"column":26},"source":"../../src/state.js","original":{"line":24,"column":1}},{"name":"plugins","generated":{"line":32,"column":0},"source":"../../src/state.js","original":{"line":26,"column":2}},{"name":"state","generated":{"line":32,"column":24},"source":"../../src/state.js","original":{"line":27,"column":6}},{"name":"plugins","generated":{"line":32,"column":30},"source":"../../src/state.js","original":{"line":27,"column":12}},{"generated":{"line":32,"column":37},"source":"../../src/state.js","original":{"line":26,"column":2}},{"name":"PLUGIN","generated":{"line":32,"column":59},"source":"../../src/state.js","original":{"line":28,"column":4}},{"name":"id","generated":{"line":32,"column":66},"source":"../../src/state.js","original":{"line":28,"column":11}},{"generated":{"line":32,"column":68},"source":"../../src/state.js","original":{"line":26,"column":2}},{"name":"plugin_state","generated":{"line":32,"column":83},"source":"../../src/state.js","original":{"line":29,"column":7}},{"generated":{"line":32,"column":95},"source":"../../src/state.js","original":{"line":26,"column":2}},{"name":"sid","generated":{"line":33,"column":0},"source":"../../src/state.js","original":{"line":30,"column":4}},{"name":"state","generated":{"line":33,"column":8},"source":"../../src/state.js","original":{"line":30,"column":9}},{"name":"sid","generated":{"line":33,"column":14},"source":"../../src/state.js","original":{"line":30,"column":15}},{"generated":{"line":34,"column":0},"source":"../../src/state.js","original":{"line":26,"column":2}},{"generated":{"line":35,"column":0},"source":"../../src/state.js","original":{"line":24,"column":1}},{"generated":{"line":36,"column":0},"source":"../../src/state.js","original":{"line":34,"column":1}},{"generated":{"line":38,"column":0},"source":"../../src/state.js","original":{"line":37,"column":0}},{"name":"reduce_plugin","generated":{"line":38,"column":9},"source":"../../src/state.js","original":{"line":37,"column":9}},{"generated":{"line":38,"column":22},"source":"../../src/state.js","original":{"line":37,"column":0}},{"name":"state","generated":{"line":38,"column":23},"source":"../../src/state.js","original":{"line":37,"column":23}},{"generated":{"line":38,"column":28},"source":"../../src/state.js","original":{"line":37,"column":0}},{"name":"PLUGIN_ID","generated":{"line":38,"column":30},"source":"../../src/state.js","original":{"line":37,"column":30}},{"generated":{"line":38,"column":39},"source":"../../src/state.js","original":{"line":37,"column":0}},{"name":"reducer","generated":{"line":38,"column":41},"source":"../../src/state.js","original":{"line":37,"column":41}},{"generated":{"line":38,"column":48},"source":"../../src/state.js","original":{"line":37,"column":0}},{"generated":{"line":38,"column":50},"source":"../../src/state.js","original":{"line":37,"column":50}},{"generated":{"line":39,"column":0},"source":"../../src/state.js","original":{"line":38,"column":1}},{"name":"initial_plugin_state","generated":{"line":39,"column":5},"source":"../../src/state.js","original":{"line":38,"column":7}},{"name":"state","generated":{"line":39,"column":28},"source":"../../src/state.js","original":{"line":38,"column":30}},{"name":"plugins","generated":{"line":39,"column":34},"source":"../../src/state.js","original":{"line":38,"column":36}},{"generated":{"line":39,"column":41},"source":"../../src/state.js","original":{"line":38,"column":30}},{"name":"PLUGIN_ID","generated":{"line":39,"column":42},"source":"../../src/state.js","original":{"line":38,"column":44}},{"generated":{"line":39,"column":51},"source":"../../src/state.js","original":{"line":38,"column":30}},{"generated":{"line":39,"column":52},"source":"../../src/state.js","original":{"line":38,"column":1}},{"generated":{"line":40,"column":0},"source":"../../src/state.js","original":{"line":39,"column":1}},{"name":"new_plugin_state","generated":{"line":40,"column":5},"source":"../../src/state.js","original":{"line":39,"column":7}},{"name":"reducer","generated":{"line":40,"column":24},"source":"../../src/state.js","original":{"line":39,"column":26}},{"name":"initial_plugin_state","generated":{"line":40,"column":32},"source":"../../src/state.js","original":{"line":39,"column":34}},{"generated":{"line":40,"column":52},"source":"../../src/state.js","original":{"line":39,"column":26}},{"generated":{"line":40,"column":53},"source":"../../src/state.js","original":{"line":39,"column":1}},{"generated":{"line":42,"column":0},"source":"../../src/state.js","original":{"line":41,"column":1}},{"name":"new_plugin_state","generated":{"line":42,"column":5},"source":"../../src/state.js","original":{"line":41,"column":5}},{"name":"initial_plugin_state","generated":{"line":42,"column":26},"source":"../../src/state.js","original":{"line":41,"column":26}},{"generated":{"line":42,"column":46},"source":"../../src/state.js","original":{"line":41,"column":1}},{"generated":{"line":42,"column":48},"source":"../../src/state.js","original":{"line":42,"column":2}},{"name":"state","generated":{"line":42,"column":55},"source":"../../src/state.js","original":{"line":42,"column":9}},{"generated":{"line":42,"column":60},"source":"../../src/state.js","original":{"line":42,"column":2}},{"generated":{"line":42,"column":61},"source":"../../src/state.js","original":{"line":37,"column":50}},{"generated":{"line":42,"column":62},"source":"../../src/state.js","original":{"line":42,"column":15}},{"generated":{"line":44,"column":0},"source":"../../src/state.js","original":{"line":44,"column":1}},{"name":"state","generated":{"line":44,"column":21},"source":"../../src/state.js","original":{"line":45,"column":5}},{"generated":{"line":44,"column":26},"source":"../../src/state.js","original":{"line":44,"column":1}},{"name":"plugins","generated":{"line":45,"column":0},"source":"../../src/state.js","original":{"line":46,"column":2}},{"name":"state","generated":{"line":45,"column":24},"source":"../../src/state.js","original":{"line":47,"column":6}},{"name":"plugins","generated":{"line":45,"column":30},"source":"../../src/state.js","original":{"line":47,"column":12}},{"generated":{"line":45,"column":37},"source":"../../src/state.js","original":{"line":46,"column":2}},{"name":"PLUGIN_ID","generated":{"line":45,"column":59},"source":"../../src/state.js","original":{"line":48,"column":4}},{"generated":{"line":45,"column":68},"source":"../../src/state.js","original":{"line":46,"column":2}},{"name":"new_plugin_state","generated":{"line":45,"column":70},"source":"../../src/state.js","original":{"line":48,"column":16}},{"generated":{"line":45,"column":86},"source":"../../src/state.js","original":{"line":46,"column":2}},{"generated":{"line":46,"column":0},"source":"../../src/state.js","original":{"line":44,"column":1}},{"generated":{"line":47,"column":0},"source":"../../src/state.js","original":{"line":51,"column":1}},{"generated":{"line":49,"column":0},"source":"../../src/state.js","original":{"line":53,"column":0}},{"name":"create","generated":{"line":51,"column":8},"source":"../../src/state.js","original":{"line":56,"column":1}},{"name":"create","generated":{"line":51,"column":17},"source":"../../src/state.js","original":{"line":56,"column":1}},{"name":"activate_plugin","generated":{"line":52,"column":8},"source":"../../src/state.js","original":{"line":57,"column":1}},{"name":"activate_plugin","generated":{"line":52,"column":26},"source":"../../src/state.js","original":{"line":57,"column":1}},{"name":"reduce_plugin","generated":{"line":53,"column":8},"source":"../../src/state.js","original":{"line":58,"column":1}},{"name":"reduce_plugin","generated":{"line":53,"column":24},"source":"../../src/state.js","original":{"line":58,"column":1}}],"sources":{"../../src/state.js":"// IMMUTABLE!\n\n/////////////////////\n\nlet instance_count = 0\nfunction create(parent_state) {\n\treturn {\n\t\tsid: instance_count++, // not really useful yet, but helps debug\n\t\tparent: parent_state || null,\n\t\tplugins: {},\n\t\tcache: {}, // per-SEC cache for complex computations\n\t}\n}\n\n\nfunction activate_plugin(state, PLUGIN, args) {\n\tconst plugin_parent_state = state.parent\n\t\t? state.parent.plugins[PLUGIN.id]\n\t\t: null\n\n\tlet plugin_state = PLUGIN.state.create(plugin_parent_state)\n\t//plugin_state = PLUGIN.state.init_from_creation_args(plugin_state, args)\n\n\treturn {\n\t\t...state,\n\t\tplugins: {\n\t\t\t...state.plugins,\n\t\t\t[PLUGIN.id]: {\n\t\t\t\t...plugin_state,\n\t\t\t\tsid: state.sid,\n\t\t\t},\n\t\t}\n\t}\n}\n\n\nfunction reduce_plugin(state, PLUGIN_ID, reducer) {\n\tconst initial_plugin_state = state.plugins[PLUGIN_ID]\n\tconst new_plugin_state = reducer(initial_plugin_state)\n\n\tif (new_plugin_state === initial_plugin_state)\n\t\treturn state // no change\n\n\treturn {\n\t\t...state,\n\t\tplugins: {\n\t\t\t...state.plugins,\n\t\t\t[PLUGIN_ID]: new_plugin_state,\n\t\t}\n\t}\n}\n\n/////////////////////\n\nexport {\n\tcreate,\n\tactivate_plugin,\n\treduce_plugin,\n}\n"},"lineCount":null}},"hash":"b2b9de649349d75441757263aab69cb0","cacheData":{"env":{}}}