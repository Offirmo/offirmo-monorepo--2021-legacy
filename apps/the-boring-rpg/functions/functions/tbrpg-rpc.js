!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=101)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return r}),n.d(t,"__assign",function(){return a}),n.d(t,"__rest",function(){return i}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return u}),n.d(t,"__metadata",function(){return c}),n.d(t,"__awaiter",function(){return l}),n.d(t,"__generator",function(){return d}),n.d(t,"__exportStar",function(){return _}),n.d(t,"__values",function(){return m}),n.d(t,"__read",function(){return h}),n.d(t,"__spread",function(){return g}),n.d(t,"__await",function(){return p}),n.d(t,"__asyncGenerator",function(){return f}),n.d(t,"__asyncDelegator",function(){return y}),n.d(t,"__asyncValues",function(){return v}),n.d(t,"__makeTemplateObject",function(){return b}),n.d(t,"__importStar",function(){return w}),n.d(t,"__importDefault",function(){return E});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function r(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&(n[o[r]]=e[o[r]])}return n}function s(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}function u(e,t){return function(n,o){t(n,o,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{u(o.next(e))}catch(e){a(e)}}function s(e){try{u(o.throw(e))}catch(e){a(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,s)}u((o=o.apply(e,t||[])).next())})}function d(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function _(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function p(e){return this instanceof p?(this.v=e,this):new p(e)}function f(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){r[e]&&(o[e]=function(t){return new Promise(function(n,o){a.push([e,t,n,o])>1||s(e,t)})})}function s(e,t){try{(n=r[e](t)).value instanceof p?Promise.resolve(n.value.v).then(u,c):l(a[0][2],n)}catch(e){l(a[0][3],e)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function y(e){var t,n;return t={},o("next"),o("throw",function(e){throw e}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:p(e[o](t)),done:"return"===o}:r?r(t):t}:r}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise(function(o,r){(function(e,t,n,o){Promise.resolve(o).then(function(t){e({value:t,done:n})},t)})(o,r,(t=e[n](t)).done,t.value)})}}}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(46),t),o.__exportStar(n(47),t),o.__exportStar(n(66),t),o.__exportStar(n(135),t),o.__exportStar(n(136),t)},function(e,t,n){"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("string"==typeof e[0]){for(var n={},o=0,r=e;o<r.length;o++){var a=r[o];n[a]=a}return n}return e[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.Enum=o,function(e){function t(e){for(var t=[],n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];t.push(e[r])}return t}e.ofKeys=function(e){for(var t={},n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];t[r]=r}return t},e.keys=function(e){return Object.keys(e)},e.values=t,e.isType=function(e,n){return-1!==t(e).indexOf(n)}}(o=t.Enum||(t.Enum={}))},function(e,t){e.exports=function e(t){Object.freeze(t);var n="function"==typeof t,o=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(t).forEach(function(r){!o.call(t,r)||n&&("caller"===r||"callee"===r||"arguments"===r)||null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(153),t),o.__exportStar(n(154),t),o.__exportStar(n(155),t),o.__exportStar(n(156),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(123),t),o.__exportStar(n(124),t)},function(e,t,n){var o;!function(r){"use strict";var a="function"!=typeof Math.imul||-5!==Math.imul(4294967295,5)?function(e,t){var n=65535&e,o=65535&t;return n*o+((e>>>16&65535)*o+n*(t>>>16&65535)<<16>>>0)|0}:Math.imul,i="function"==typeof String.prototype.repeat&&"xxx"==="x".repeat(3)?function(e,t){return e.repeat(t)}:function(e,t){for(var n="";t>0;)1&t&&(n+=e),t>>=1,e+=e;return n};function s(e){if(!(this instanceof s))return new s(e);if(null==e)e=s.engines.nativeMath;else if("function"!=typeof e)throw new TypeError("Expected engine to be a function, got "+typeof e);this.engine=e}var u,c,l=s.prototype;function d(e){return function(){return e}}function _(e,t){return 0===t?e:function(n){return e(n)+t}}function m(e){var t=+e;return t<0?Math.ceil(t):Math.floor(t)}function h(e,t){return e<0?Math.max(e+t,0):Math.min(e,t)}function g(){}s.engines={nativeMath:function(){return 4294967296*Math.random()|0},mt19937:function(e){function t(e){for(var t=0,n=0;(0|t)<227;t=t+1|0)n=2147483648&e[t]|2147483647&e[t+1|0],e[t]=e[t+397|0]^n>>>1^(1&n?2567483615:0);for(;(0|t)<623;t=t+1|0)n=2147483648&e[t]|2147483647&e[t+1|0],e[t]=e[t-227|0]^n>>>1^(1&n?2567483615:0);n=2147483648&e[623]|2147483647&e[0],e[623]=e[396]^n>>>1^(1&n?2567483615:0)}return function(){var n=new e(624),o=0,r=0;function i(){(0|o)>=624&&(t(n),o=0);var e=n[o];return o=o+1|0,r+=1,0|function(e){return e^=e>>>11,e^=e<<7&2636928640,(e^=e<<15&4022730752)^e>>>18}(e)}return i.getUseCount=function(){return r},i.discard=function(e){for(r+=e,(0|o)>=624&&(t(n),o=0);e-o>624;)e-=624-o,t(n),o=0;return o=o+e|0,i},i.seed=function(e){var t=0;n[0]=t=0|e;for(var s=1;s<624;s=s+1|0)n[s]=t=a(t^t>>>30,1812433253)+s|0;return o=624,r=0,i},i.seedWithArray=function(e){return i.seed(19650218),function(e,t){for(var n=1,o=0,r=t.length,i=0|Math.max(r,624),s=0|e[0];(0|i)>0;--i)e[n]=s=(e[n]^a(s^s>>>30,1664525))+(0|t[o])+(0|o)|0,++o,(0|(n=n+1|0))>623&&(e[0]=e[623],n=1),o>=r&&(o=0);for(i=623;(0|i)>0;--i)e[n]=s=(e[n]^a(s^s>>>30,1566083941))-n|0,(0|(n=n+1|0))>623&&(e[0]=e[623],n=1);e[0]=2147483648}(n,e),i},i.autoSeed=function(){return i.seedWithArray(s.generateEntropyArray())},i}}("function"==typeof Int32Array?Int32Array:Array),browserCrypto:"undefined"==typeof crypto||"function"!=typeof crypto.getRandomValues||"function"!=typeof Int32Array&&"object"!=typeof Int32Array?"function"==typeof n(49).randomBytes?function(){return n(49).randomBytes(4).readInt32BE(0)}:null:(u=null,c=128,function(){return c>=128&&(null===u&&(u=new Int32Array(128)),crypto.getRandomValues(u),c=0),0|u[c++]})},s.generateEntropyArray=function(){for(var e=[],t=s.engines.nativeMath,n=0;n<16;++n)e[n]=0|t();return e.push(0|(new Date).getTime()),e},s.int32=function(e){return 0|e()},l.int32=function(){return s.int32(this.engine)},s.uint32=function(e){return e()>>>0},l.uint32=function(){return s.uint32(this.engine)},s.uint53=function(e){return 4294967296*(2097151&e())+(e()>>>0)},l.uint53=function(){return s.uint53(this.engine)},s.uint53Full=function(e){for(;;){var t=0|e();if(!(2097152&t))return 4294967296*(2097151&t)+(e()>>>0);if(2097152==(4194303&t)&&0==(0|e()))return 9007199254740992}},l.uint53Full=function(){return s.uint53Full(this.engine)},s.int53=function(e){var t=0|e();return 4294967296*(2097151&t)+(e()>>>0)+(2097152&t?-9007199254740992:0)},l.int53=function(){return s.int53(this.engine)},s.int53Full=function(e){for(;;){var t=0|e();if(!(4194304&t))return 4294967296*(2097151&t)+(e()>>>0)+(2097152&t?-9007199254740992:0);if(4194304==(8388607&t)&&0==(0|e()))return 9007199254740992}},l.int53Full=function(){return s.int53Full(this.engine)},s.integer=function(){function e(e){return 0==(e+1&e)}function t(t){return e(t)?(n=t,function(e){return e()&n}):function(e){var t=e+1,n=t*Math.floor(4294967296/t);return function(e){var o=0;do{o=e()>>>0}while(o>=n);return o%t}}(t);var n}function n(t){var n,o=t+1;if(0==(0|o)){var r=(o/4294967296|0)-1;if(e(r))return n=r,function(e){return 4294967296*(e()&n)+(e()>>>0)}}return function(e){var t=e*Math.floor(9007199254740992/e);return function(n){var o=0;do{o=4294967296*(2097151&n())+(n()>>>0)}while(o>=t);return o%e}}(o)}function o(e,t){return function(n){var o=0;do{var r=0|n();o=4294967296*(2097151&r)+(n()>>>0)+(2097152&r?-9007199254740992:0)}while(o<e||o>t);return o}}return function(e,r){if(e=Math.floor(e),r=Math.floor(r),e<-9007199254740992||!isFinite(e))throw new RangeError("Expected min to be at least -9007199254740992");if(r>9007199254740992||!isFinite(r))throw new RangeError("Expected max to be at most 9007199254740992");var a=r-e;return a<=0||!isFinite(a)?d(e):4294967295===a?0===e?s.uint32:_(s.int32,e+2147483648):a<4294967295?_(t(a),e):9007199254740991===a?_(s.uint53,e):a<9007199254740991?_(n(a),e):r-1-e==9007199254740991?_(s.uint53Full,e):-9007199254740992===e&&9007199254740992===r?s.int53Full:-9007199254740992===e&&9007199254740991===r?s.int53:-9007199254740991===e&&9007199254740992===r?_(s.int53,1):9007199254740992===r?_(o(e-1,r-1),1):o(e,r)}}(),l.integer=function(e,t){return s.integer(e,t)(this.engine)},s.realZeroToOneInclusive=function(e){return s.uint53Full(e)/9007199254740992},l.realZeroToOneInclusive=function(){return s.realZeroToOneInclusive(this.engine)},s.realZeroToOneExclusive=function(e){return s.uint53(e)/9007199254740992},l.realZeroToOneExclusive=function(){return s.realZeroToOneExclusive(this.engine)},s.real=function(){return function(e,t,n){if(!isFinite(e))throw new RangeError("Expected left to be a finite number");if(!isFinite(t))throw new RangeError("Expected right to be a finite number");return _((o=n?s.realZeroToOneInclusive:s.realZeroToOneExclusive,1===(r=t-e)?o:0===r?function(){return 0}:function(e){return o(e)*r}),e);var o,r}}(),l.real=function(e,t,n){return s.real(e,t,n)(this.engine)},s.bool=function(){function e(e){return 1==(1&e())}function t(e,t){return function(n){return e(n)<t}}return function(n,o){return null==o?null==n?e:function(e){if(e<=0)return d(!1);if(e>=1)return d(!0);var n=4294967296*e;return n%1==0?t(s.int32,n-2147483648|0):t(s.uint53,Math.round(9007199254740992*e))}(n):n<=0?d(!1):n>=o?d(!0):t(s.integer(0,o-1),n)}}(),l.bool=function(e,t){return s.bool(e,t)(this.engine)},s.pick=function(e,t,n,o){var r=t.length,a=null==n?0:h(m(n),r),i=void 0===o?r:h(m(o),r);if(!(a>=i))return t[s.integer(a,i-1)(e)]},l.pick=function(e,t,n){return s.pick(this.engine,e,t,n)};var p,f,y=Array.prototype.slice;s.picker=function(e,t,n){var o=y.call(e,t,n);if(!o.length)return g;var r=s.integer(0,o.length-1);return function(e){return o[r(e)]}},s.shuffle=function(e,t,n){var o=t.length;if(o){null==n&&(n=0);for(var r=o-1>>>0;r>n;--r){var a=s.integer(0,r)(e);if(r!==a){var i=t[r];t[r]=t[a],t[a]=i}}}return t},l.shuffle=function(e){return s.shuffle(this.engine,e)},s.sample=function(e,t,n){if(n<0||n>t.length||!isFinite(n))throw new RangeError("Expected sampleSize to be within 0 and the length of the population");if(0===n)return[];var o=y.call(t),r=o.length;if(r===n)return s.shuffle(e,o,0);var a=r-n;return s.shuffle(e,o,a-1).slice(a)},l.sample=function(e,t){return s.sample(this.engine,e,t)},s.die=function(e){return s.integer(1,e)},l.die=function(e){return s.die(e)(this.engine)},s.dice=function(e,t){var n=s.die(e);return function(e){var o=[];o.length=t;for(var r=0;r<t;++r)o[r]=n(e);return o}},l.dice=function(e,t){return s.dice(e,t)(this.engine)},s.uuid4=function(){function e(e,t){return i("0",t-e.length)+e}return function(t){var n=t()>>>0,o=0|t(),r=0|t(),a=t()>>>0;return e(n.toString(16),8)+"-"+e((65535&o).toString(16),4)+"-"+e((o>>4&4095|16384).toString(16),4)+"-"+e((16383&r|32768).toString(16),4)+"-"+e((r>>4&65535).toString(16),4)+e(a.toString(16),8)}}(),l.uuid4=function(){return s.uuid4(this.engine)},s.string=function(e){null==e&&(e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-");var t=e.length;if(!t)throw new Error("Expected pool not to be an empty string");var n=s.integer(0,t-1);return function(t,o){for(var r="",a=0;a<o;++a){var i=n(t);r+=e.charAt(i)}return r}},l.string=function(e,t){return s.string(t)(this.engine,e)},s.hex=(p=s.string("0123456789abcdef"),f=s.string("0123456789abcdef".toUpperCase()),function(e){return e?f:p}),l.hex=function(e,t){return s.hex(t)(this.engine,e)},s.date=function(e,t){if(!(e instanceof Date))throw new TypeError("Expected start to be a Date, got "+typeof e);if(!(t instanceof Date))throw new TypeError("Expected end to be a Date, got "+typeof t);var n=s.integer(e.getTime(),t.getTime());return function(e){return new Date(n(e))}},l.date=function(e,t){return s.date(e,t)(this.engine)},void 0===(o=function(){return{Random:s}}.call(t,n,t,e))||(e.exports=o)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(43),t),o.__exportStar(n(112),t),o.__exportStar(n(113),t),o.__exportStar(n(137),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(138),t),o.__exportStar(n(74),t),o.__exportStar(n(75),t),o.__exportStar(n(147),t),o.__exportStar(n(148),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(109);t.VERSION=o.VERSION;t.LIB="@tbrpg/state";t.SCHEMA_VERSION=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(64),t),o.__exportStar(n(130),t),o.__exportStar(n(22),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(68),t),o.__exportStar(n(27),t),o.__exportStar(n(28),t),o.__exportStar(n(69),t),o.__exportStar(n(141),t),o.__exportStar(n(142),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(51),t),o.__exportStar(n(164),t),o.__exportStar(n(165),t),o.__exportStar(n(166),t),o.__exportStar(n(167),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(71),t),o.__exportStar(n(29),t),o.__exportStar(n(30),t),o.__exportStar(n(72),t),o.__exportStar(n(145),t),o.__exportStar(n(146),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(158),t),o.__exportStar(n(159),t),o.__exportStar(n(161),t),o.__exportStar(n(162),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(53),t),o.__exportStar(n(173),t),o.__exportStar(n(174),t),o.__exportStar(n(175),t),o.__exportStar(n(176),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="soft-execution-context";t.INTERNAL_PROP="_SEC"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(57),t),o.__exportStar(n(197),t),o.__exportStar(n(198),t),o.__exportStar(n(199),t),o.__exportStar(n(200),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(89),t);var o=n(189);t.get_recap=o.get_recap;var r=n(196);t.get_engagement_message=r.get_engagement_message},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(5),a=n(1),i=n(11),s=n(13),u=n(36),c=n(7),l=n(23),d=o.__importStar(n(14)),_=o.__importStar(n(23)),m=o.__importStar(n(8)),h=o.__importStar(n(12)),g=n(17),p=n(39),f=n(38);function y(e,t){const n=u.appraise_power_normalized(e);return u.appraise_power_normalized(t)-n}function v(e,t){let{u_state:n}=e;const o=g.appraise_item_value(n,t);return Object.assign({},e,{u_state:Object.assign({},n,{inventory:m.remove_item_from_unslotted(n.inventory,t),wallet:_.add_amount(n.wallet,l.Currency.coin,o)})})}t._loose_all_energy=function(e){return Object.assign({},e,{t_state:Object.assign({},e.t_state,{energy:d.loose_all_energy([e.u_state.energy,e.t_state.energy])})})},t._update_to_now=function(e,t=r.get_UTC_timestamp_ms()){let{u_state:n,t_state:o}=e;const a=d.update_to_now([n.energy,o.energy],t);return a===o.energy?e:Object.assign({},e,{t_state:Object.assign({},o,{energy:a})})},t._receive_stat_increase=function(e,t,n=1){let{u_state:o}=e;return Object.assign({},e,{u_state:Object.assign({},o,{avatar:c.increase_stat(p.get_lib_SEC(),o.avatar,t,n)})})},t._receive_item=function(e,t){let{u_state:n}=e;return Object.assign({},e,{u_state:Object.assign({},n,{inventory:m.add_item(n.inventory,t)})})},t._sell_item=v,t._receive_coins=function(e,t){let{u_state:n}=e;return Object.assign({},e,{u_state:Object.assign({},n,{wallet:_.add_amount(n.wallet,l.Currency.coin,t)})})},t._receive_tokens=function(e,t){let{u_state:n}=e;return Object.assign({},e,{u_state:Object.assign({},n,{wallet:_.add_amount(n.wallet,l.Currency.token,t)})})},t._ack_all_engagements=function(e){let{u_state:t}=e;return t.engagement.queue.length?Object.assign({},e,{u_state:Object.assign({},t,{engagement:h.acknowledge_all_seen(t.engagement)})}):e},t._auto_make_room=function(e,t={}){const{DEBUG:n}=t;if(n&&console.log(`  - _auto_make_room()… (inventory holding ${e.u_state.inventory.unslotted.length} items)`),g.is_inventory_full(e.u_state)){n&&console.log(`    Inventory is full (${e.u_state.inventory.unslotted.length} items)`);let t=0;const o=e.u_state.inventory.unslotted;if(Array.from(o).filter(e=>{switch(e.slot){case a.InventorySlot.armor:if(s.matches(e,f.STARTING_ARMOR_SPEC))return!1;break;case a.InventorySlot.weapon:if(i.matches(e,f.STARTING_WEAPON_SPEC))return!1}return!0}).sort(y).reverse().forEach(n=>{switch(n.slot){case a.InventorySlot.armor:if(s.matches(n,f.STARTING_ARMOR_SPEC))return;break;case a.InventorySlot.weapon:if(i.matches(n,f.STARTING_WEAPON_SPEC))return}if(n.quality===a.ItemQuality.common||0===t)return e=v(e,n.uuid),void t++}),0===t)throw new Error("Internal error: _auto_make_room(): inventory is full and couldn’t free stuff!");n&&console.log(`    Freed ${t} items, inventory now holding ${e.u_state.inventory.unslotted.length} items.`)}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(9),t),o.__exportStar(n(110),t),o.__exportStar(n(111),t),o.__exportStar(n(17),t),o.__exportStar(n(201),t),o.__exportStar(n(18),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=0;t.create=function(e){return{sid:o++,parent:e||null,plugins:{},cache:{}}},t.activate_plugin=function(e,t){const n=e.parent?e.parent.plugins[t.id]:null;let o=t.state.create(n);return Object.assign({},e,{plugins:Object.assign({},e.plugins,{[t.id]:Object.assign({},o,{sid:e.sid})})})},t.reduce_plugin=function(e,t,n){const o=e.plugins[t],r=n(o);return r===o?e:Object.assign({},e,{plugins:Object.assign({},e.plugins,{[t]:r})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(16);function r(e){if(!e)return e;if(Array.isArray(e))return e;if("object"!=typeof e)return e;const t=Object.create(null);for(const n in e)t[n]=e[n];return t}t.flattenToOwn=r,t._getSECStatePath=function(e){if(!e[o.INTERNAL_PROP].cache.statePath){const t=[];let n=e[o.INTERNAL_PROP];for(;n;)t.unshift(n),n=n.parent;e[o.INTERNAL_PROP].cache.statePath=t}return e[o.INTERNAL_PROP].cache.statePath},t._flattenSEC=function(e){const t=Object.assign({},e[o.INTERNAL_PROP].plugins);return t.analytics.details=r(t.analytics.details),t.dependency_injection.context=r(t.dependency_injection.context),t.error_handling.details=r(t.error_handling.details),t.logical_stack.stack=r(t.logical_stack.stack),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(77),t),o.__exportStar(n(149),t),o.__exportStar(n(150),t),o.__exportStar(n(151),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(168),t),o.__exportStar(n(80),t),o.__exportStar(n(171),t),o.__exportStar(n(172),t),o.__exportStar(n(81),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(40),r=n(41);t.NodeType=r.NodeType;const a=n(191);const i={$type:"br"},s={$type:"hr"};function u(e,t,n={},{$parent_node:c,$id:l="root",depth:d=0}={}){const _=a.normalize_node(e),{$type:m,$classes:h,$sub:g}=_;Object.keys(t).every(e=>e.startsWith("on_"))||console.warn(`${o.LIB} Bad callbacks, check the API!`);let p=t;!c&&(p=Object.assign({},function(){function e({state:e}){return e}return{on_root_enter:function(){},on_root_exit:e,on_node_enter:()=>{throw new Error("Please define on_node_enter()!")},on_node_exit:e,on_concatenate_str:e,on_concatenate_sub_node:e,on_filter:e,on_filter_Capitalize:({state:e})=>{const t=e;if(t&&"string"==typeof t.str){const e=""+t.str;return Object.assign({},t,{str:e[0].toUpperCase()+e.slice(1)})}return e},on_class_before:e,on_class_after:e,on_type:e}}(),p)).on_root_enter(n);let f=p.on_node_enter({$node:_,$id:l,depth:d},n);if(f=h.reduce((e,t)=>p.on_class_before({$class:t,state:e,$node:_,depth:d},n),f),"ul"===m||"ol"===m){const e=Object.keys(g).sort();e.forEach(t=>{t===Number(t).toString()&&console.warn(`in sub-node '${l}', the ul/ol key '${t}' suspiciously looks like a number. Beware of auto sorting!`,{$node:_,sorted_keys:e})}),e.forEach(e=>{const t={$type:r.NodeType.li,$content:"{{content}}",$sub:{content:g[e]}};let o=u(t,p,n,{$parent_node:_,depth:d+1,$id:e});f=p.on_concatenate_sub_node({state:f,sub_state:o,$id:e,$node:a.normalize_node(t),$parent_node:_,depth:d},n)})}else f=function(e,t,n,r,c){const{$content:l,$sub:d}=e,_=l.split("{{"),m=_.shift();return m&&(n=t.on_concatenate_str({str:m,state:n,$node:e,depth:r},c)),n=_.reduce((n,_)=>{const m=_.split("}}");if(2!==m.length)throw new Error(`${o.LIB}: syntax error in content "${l}", unmatched {{}}!`);const[h,...g]=m.shift().split("|");let p=d[h];if(p||"br"!==h||(p=i),p||"hr"!==h||(p=s),!p)throw new Error(`${o.LIB}: syntax error in content "${l}", it's referring to an unknown sub-node "${h}"!`);let f=u(p,t,c,{$parent_node:e,$id:h,depth:r+1});return f=g.reduce((n,o)=>{const a=t[`on_filter_${o}`];return a&&(n=a({$filter:o,$filters:g,state:n,$node:e,depth:r},c)),t.on_filter({$filter:o,$filters:g,state:n,$node:e,depth:r},c)},f),n=t.on_concatenate_sub_node({sub_state:f,$id:h,$parent_node:e,state:n,$node:a.normalize_node(p),depth:r},c),m[0]&&(n=t.on_concatenate_str({str:m[0],state:n,$node:e,depth:r},c)),n},n)}(_,p,f,d,n);f=h.reduce((e,t)=>p.on_class_after({$class:t,state:e,$node:_,depth:d},n),f);const y=p[`on_type_${m}`];return y&&(f=y({$type:m,$parent_node:c,state:f,$node:_,depth:d},n)),f=p.on_type({$type:m,$parent_node:c,state:f,$node:_,depth:d},n),f=p.on_node_exit({$node:_,$id:l,state:f,depth:d},n),c||(f=p.on_root_exit({state:f,$node:_,depth:0},n)),f}t.walk=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(15),a=n(12),i=o.__importDefault(n(87)),s=n(18);t._refresh_achievements=function(e){let{u_state:t}=e,n=!1,o=Object.assign({},t.progress);return i.default.forEach(e=>{const{icon:i,name:u}=e,c=r.get_last_known_achievement_status(o,u);if(c===r.AchievementStatus.unlocked)return;const l=e.get_status(t);c!==l&&(n=!0,o=r.on_achieved(o,u,l),l===r.AchievementStatus.unlocked&&(t=Object.assign({},t,{engagement:a.enqueue(t.engagement,{type:a.EngagementType.aside,key:s.EngagementKey["achievement-unlocked"]},{semantic_level:"success",auto_dismiss_delay_ms:7e3,icon:i,name:u})})))}),n?Object.assign({},e,{u_state:Object.assign({},t,{progress:o})}):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/logic-weapons";t.SCHEMA_VERSION=2;t.MIN_ENHANCEMENT_LEVEL=0;t.MAX_ENHANCEMENT_LEVEL=8},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=n(1),a=n(27),i=.1,s=1+a.MAX_ENHANCEMENT_LEVEL*i,u={[r.ItemQuality.common]:[1,999],[r.ItemQuality.uncommon]:[1e3,2999],[r.ItemQuality.rare]:[3500,9999],[r.ItemQuality.epic]:[11e3,29999],[r.ItemQuality.legendary]:[35e3,99999],[r.ItemQuality.artifact]:[35e3,99999]};if(t.OVERALL_STRENGTH_INTERVAL_BY_QUALITY=u,Object.keys(u).length!==o.Enum.keys(r.ItemQuality).length)throw new Error(`${a.LIB} overall - outdated code!`);const c={[r.ItemQuality.common]:.1,[r.ItemQuality.uncommon]:.09,[r.ItemQuality.rare]:.08,[r.ItemQuality.epic]:.07,[r.ItemQuality.legendary]:.05,[r.ItemQuality.artifact]:.05};if(Object.keys(c).length!==o.Enum.keys(r.ItemQuality).length)throw new Error(`${a.LIB} spread - outdated code!`);const l={};Object.keys(u).forEach(e=>{const t=e,[n,o]=u[t];let r=c[t];const i=Math.floor(n/(1-r)/1),d=Math.ceil(o/(1+r)/s);if(i>=d)throw new Error(`${a.LIB}: range assertion failed for "${t}"!`);l[t]=[i,d]});const d=l;function _(e,t,n){const o=c[t],r=1+i*n,[a,s]=u[t];return[Math.max(a,Math.round(e*(1-o)*r)),Math.min(s,Math.round(e*(1+o)*r))]}function m(e){return _(e.base_strength,e.quality,e.enhancement_level)}t.BASE_STRENGTH_INTERVAL_BY_QUALITY=d,t.get_damage_interval=m,t.get_medium_damage=function(e){const t=m(e);return Math.round((t[0]+t[1])/2)},t.get_ultimate_medium_damage=function(e){const t=_(e.base_strength,e.quality,a.MAX_ENHANCEMENT_LEVEL);return Math.round((t[0]+t[1])/2)},t.matches=function(e,t){let n=!0;if(!e)throw new Error(`${a.LIB} matches: can't match nothing!`);if(t.slot&&t.slot!==r.InventorySlot.weapon)throw new Error(`${a.LIB} matches: can't match against a non-weapon slot "${t.slot}"!`);return e.slot===r.InventorySlot.weapon&&(Object.keys(t).forEach(o=>{if(!(o in e))throw new Error(`${a.LIB} matches: can't match on non-weapon key "${o}"!`);t[o]!==e[o]&&(n=!1)}),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/logic-armors";t.SCHEMA_VERSION=2;t.MIN_ENHANCEMENT_LEVEL=0;t.MAX_ENHANCEMENT_LEVEL=8},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=n(1),a=n(29);t.ATTACK_VS_DEFENSE_RATIO=1;const i=.1,s=1+a.MAX_ENHANCEMENT_LEVEL*i,u={[r.ItemQuality.common]:[1*t.ATTACK_VS_DEFENSE_RATIO,999*t.ATTACK_VS_DEFENSE_RATIO],[r.ItemQuality.uncommon]:[1e3*t.ATTACK_VS_DEFENSE_RATIO,2999*t.ATTACK_VS_DEFENSE_RATIO],[r.ItemQuality.rare]:[3500*t.ATTACK_VS_DEFENSE_RATIO,9999*t.ATTACK_VS_DEFENSE_RATIO],[r.ItemQuality.epic]:[11e3*t.ATTACK_VS_DEFENSE_RATIO,29999*t.ATTACK_VS_DEFENSE_RATIO],[r.ItemQuality.legendary]:[35e3*t.ATTACK_VS_DEFENSE_RATIO,99999*t.ATTACK_VS_DEFENSE_RATIO],[r.ItemQuality.artifact]:[35e3*t.ATTACK_VS_DEFENSE_RATIO,99999*t.ATTACK_VS_DEFENSE_RATIO]};if(t.OVERALL_STRENGTH_INTERVAL_BY_QUALITY=u,Object.keys(u).length!==o.Enum.keys(r.ItemQuality).length)throw new Error(`${a.LIB} overall - outdated code!`);const c={[r.ItemQuality.common]:.1,[r.ItemQuality.uncommon]:.09,[r.ItemQuality.rare]:.08,[r.ItemQuality.epic]:.07,[r.ItemQuality.legendary]:.05,[r.ItemQuality.artifact]:.05};if(Object.keys(c).length!==o.Enum.keys(r.ItemQuality).length)throw new Error(`${a.LIB} spread - outdated code!`);const l={};Object.keys(u).forEach(e=>{const t=e,[n,o]=u[t];let r=c[t];const i=Math.floor(n/(1-r)/1),d=Math.ceil(o/(1+r)/s);if(i>=d)throw new Error(`${a.LIB}: range assertion failed for "${t}"!`);l[t]=[i,d]});const d=l;function _(e,t,n){const o=c[t],r=1+i*n,[a,s]=u[t];return[Math.max(a,Math.round(e*(1-o)*r)),Math.min(s,Math.round(e*(1+o)*r))]}function m(e){return _(e.base_strength,e.quality,e.enhancement_level)}t.BASE_STRENGTH_INTERVAL_BY_QUALITY=d,t.get_damage_reduction_interval=m,t.get_medium_damage_reduction=function(e){const t=m(e);return Math.round((t[0]+t[1])/2)},t.get_ultimate_medium_damage_reduction=function(e){const t=_(e.base_strength,e.quality,a.MAX_ENHANCEMENT_LEVEL);return Math.round((t[0]+t[1])/2)},t.matches=function(e,t){let n=!0;if(!e)throw new Error(`${a.LIB} matches: can't match nothing!`);if(t.slot&&t.slot!==r.InventorySlot.armor)throw new Error(`${a.LIB} matches: can't match against a non-armor slot "${t.slot}"!`);return e.slot===r.InventorySlot.armor&&(Object.keys(t).forEach(o=>{if(!(o in e))throw new Error(`${a.LIB} matches: can't match on non-armor key "${o}"!`);t[o]!==e[o]&&(n=!1)}),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-inventory";t.SCHEMA_VERSION=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-prng";t.SCHEMA_VERSION=2;t.DEBUG=!0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-energy";t.SCHEMA_VERSION=2;t.TICK_MS=500},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-codes";t.SCHEMA_VERSION=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(177),t),o.__exportStar(n(178),t),o.__exportStar(n(179),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(185),t),o.__exportStar(n(186),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(88);t.CoinsGain=r.CoinsGain,t.AdventureType=r.AdventureType;const a=n(187);t.i18n_messages=a.i18n_messages;const i=a.ENTRIES.map(e=>{const t=e.outcome||{},n={level:!!t.level,agility:!!t.agility,health:!!t.health,luck:!!t.luck,mana:!!t.mana,strength:!!t.strength,charisma:!!t.charisma,wisdom:!!t.wisdom,random_attribute:!!t.random_attribute,lowest_attribute:!!t.lowest_attribute,class_primary_attribute:!!t.class_primary_attribute,class_secondary_attribute:!!t.class_secondary_attribute,coin:t.coin||r.CoinsGain.none,token:t.token||0,armor:!!t.armor,weapon:!!t.weapon,armor_or_weapon:!!t.armor_or_weapon,armor_improvement:!!t.armor_improvement,weapon_improvement:!!t.weapon_improvement,armor_or_weapon_improvement:!!t.armor_or_weapon_improvement};return{hid:e.hid,good:e.good,type:e.type,outcome:n}});t.ALL_ADVENTURE_ARCHETYPES=i;const s=i.filter(e=>!e.good);t.ALL_BAD_ADVENTURE_ARCHETYPES=s;const u=i.filter(e=>e.good);t.ALL_GOOD_ADVENTURE_ARCHETYPES=u;const c={story:u.filter(e=>e.type===r.AdventureType.story),fight:u.filter(e=>e.type===r.AdventureType.fight)};t.GOOD_ADVENTURE_ARCHETYPES_BY_TYPE=c;const l=1.1,d={none:[0,0],small:[1,20],medium:[50,100],big:[500,700],huge:[900,2e3]};!function(){if(i.length<100)throw console.error(i),new Error("Data sanity failure: ALL_ADVENTURE_ARCHETYPES");if(s.length<6)throw new Error("Data sanity failure: ALL_BAD_ADVENTURE_ARCHETYPES");if(u.length<100)throw new Error("Data sanity failure: ALL_GOOD_ADVENTURE_ARCHETYPES");if(6!==c.fight.length)throw console.error(c.fight),new Error("Data sanity failure: GOOD_ADVENTURE_ARCHETYPES_BY_TYPE.fight");if(c.story.length<100)throw new Error("Data sanity failure: GOOD_ADVENTURE_ARCHETYPES_BY_TYPE.story")}(),t.get_archetype=function(e){const t=i.find(t=>t.hid===e);if(!t)throw new Error(`logic-adventures, get_archetype(): couldn't find archetype "${e}" !`);return t};const _=.33;t.pick_random_good_archetype=function(e){return o.Random.bool(_)(e)?o.Random.pick(e,c.fight):o.Random.pick(e,c.story)},t.pick_random_bad_archetype=function(e){return o.Random.pick(e,s)},t.generate_random_coin_gain=function(e,t,n){if(t===r.CoinsGain.none)return 0;const a=n*l,i=d[t];return o.Random.integer(i[0]*a,i[1]*a)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(5),a=n(48),i=n(1),s=o.__importStar(n(7)),u=o.__importStar(n(23)),c=o.__importStar(n(8)),l=o.__importStar(n(14)),d=o.__importStar(n(12)),_=o.__importStar(n(4)),m=o.__importStar(n(24)),h=o.__importStar(n(15)),g=o.__importStar(n(35)),p=n(4),f=n(11),y=n(13),v=n(9),b=n(39),w=n(18),E=n(19),S=n(59),A=n(26),O={base_hid:"spoon",qualifier1_hid:"used",qualifier2_hid:"noob",quality:i.ItemQuality.common,base_strength:1};t.STARTING_WEAPON_SPEC=O;const k={base_hid:"socks",qualifier1_hid:"used",qualifier2_hid:"noob",quality:i.ItemQuality.common,base_strength:1};t.STARTING_ARMOR_SPEC=k,t.create=function(e){return b.get_lib_SEC(e).xTry("create",({enforce_immutability:t})=>{let[n,o]=l.create(),i={schema_version:v.SCHEMA_VERSION,u_state:{revision:0,uuid:a.generate_uuid(),creation_date:r.get_human_readable_UTC_timestamp_minutes(),avatar:s.create(e),inventory:c.create(e),wallet:u.create(),prng:_.create(),energy:n,engagement:d.create(e),codes:m.create(e),progress:h.create(e),meta:g.create(),last_adventure:null},t_state:{energy:o}},b=p.get_prng(i.u_state.prng);const T=f.create(b,O);i=E._receive_item(i,T),i=S.equip_item(i,T.uuid);const I=y.create(b,k);return i=E._receive_item(i,I),i=S.equip_item(i,I.uuid),i=A._refresh_achievements(i),i=E._ack_all_engagements(i),i=Object.assign({},i,{u_state:Object.assign({},i.u_state,{engagement:d.enqueue(i.u_state.engagement,{type:d.EngagementType.flow,key:w.EngagementKey["tip--first_play"]})})}),i=Object.assign({},i,{u_state:Object.assign({},i.u_state,{revision:0})}),t(i=E._update_to_now(i))})},t.reseed=function(e,t){return t=t||p.generate_random_seed(),e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{prng:_.set_seed(e.u_state.prng,t)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(9);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:a.LIB}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@offirmo/rich-text-format";t.SCHEMA_VERSION=1;t.NODE_TYPE_TO_DISPLAY_MODE={inline_fragment:"inline",strong:"inline",weak:"inline",em:"inline",block_fragment:"block",heading:"block",hr:"block",ol:"block",ul:"block",br:"inline",li:"block"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("inline_fragment","strong","weak","em","block_fragment","heading","hr","ol","ul","br","li");t.NodeType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(2),a=n(96);t.get_action_types=function(){return r.Enum.keys(a.ActionType)},o.__exportStar(n(96),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=o.Enum("agility","health","level","luck","mana","strength","charisma","wisdom");t.CharacterAttribute=r;const a=o.Enum("novice","barbarian","druid","warrior","paladin","rogue","sorcerer","warlock","wizard","darkness hunter","hunter","priest","death knight","mage","engineer","thief","assassin","illusionist","knight","pirate","ninja","corsair","necromancer","sculptor","summoner");t.CharacterClass=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-character";t.SCHEMA_VERSION=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(16),a=o.__importStar(n(21)),i=o.__importStar(n(119)),s=n(22),u="dependency_injection";t.PLUGIN_ID=u;const c={id:u,state:i,augment:e=>{e.injectDependencies=function(e){let t=this[r.INTERNAL_PROP];return t=a.reduce_plugin(t,u,t=>(Object.entries(e).forEach(([e,n])=>{t=i.injectDependencies(t,e,n)}),t)),this[r.INTERNAL_PROP]=t,this},e.getInjectedDependencies=function(){const e=this[r.INTERNAL_PROP].plugins[u];return s.flattenToOwn(e.context)}}};t.PLUGIN=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=o.Enum("item","achievement_snapshot","location","lore");t.ElementType=r;const a=o.Enum("common","uncommon","rare","epic","legendary","artifact");t.ItemQuality=a;const i=o.Enum("weapon","armor","none");t.InventorySlot=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=n(46);t.PRODUCT="@oh-my-rpg";const a=o.Enum.keys(r.ItemQuality);t.ITEM_QUALITIES=a;const i={[r.ItemQuality.common]:6,[r.ItemQuality.uncommon]:5,[r.ItemQuality.rare]:4,[r.ItemQuality.epic]:3,[r.ItemQuality.legendary]:2,[r.ItemQuality.artifact]:1};t.ITEM_QUALITIES_TO_INT=i;const s=o.Enum.keys(r.InventorySlot).filter(e=>e!==r.InventorySlot.none);t.ITEM_SLOTS=s;const u={[r.InventorySlot.weapon]:1,[r.InventorySlot.armor]:2};if(t.ITEM_SLOTS_TO_INT=u,Object.keys(u).length!==s.length)throw new Error("Static data ITEM_SLOTS_TO_INT is outdated!");t.MIN_LEVEL=1;t.MAX_LEVEL=9999},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(131),t)},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-wallet";t.SCHEMA_VERSION=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("flow","aside","warning");t.EngagementType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-engagement";t.SCHEMA_VERSION=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("secret","hidden","revealed","unlocked");t.AchievementStatus=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-progress";t.SCHEMA_VERSION=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIB="@oh-my-rpg/state-meta";t.SCHEMA_VERSION=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("common","elite","boss");t.MonsterRank=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(1),a=n(15),i=o.__importDefault(n(87));function s(e,t){const{session_uuid:n,name:o,icon:i,description:s,lore:u,get_completion_rate:c}=t,l=a.get_last_known_achievement_status(e.progress,o);return{uuid:n,element_type:r.ElementType.achievement_snapshot,name:o,icon:i,description:s,lore:u,status:l,completion_rate:c?c(e):void 0}}function u(e){return i.default.map(t=>s(e,t)).filter(e=>e.status!==a.AchievementStatus.secret)}t.get_achievement_snapshot=s,t.get_achievement_snapshot_by_uuid=function(e,t){const n=i.default.find(e=>e.session_uuid===t);if(!n)throw new Error(`No achievement definition found for uuid "${t}"!`);return s(e,n)},t.get_achievements_snapshot=u,t.get_achievements_completion=function(e){const t=u(e);return[t.filter(e=>e.status===a.AchievementStatus.unlocked).length,t.length]}},function(e,t,n){"use strict";function o(e){return"ul"===e.$type||"ol"===e.$type}Object.defineProperty(t,"__esModule",{value:!0}),t.is_list=o,t.is_link=function(e){return!!e.$hints.href},t.is_KVP_list=function(e){return!!o(e)&&Object.values(e.$sub).every(e=>"{{key}}: {{value}}"===e.$content)},t.is_uuid_list=function(e){return!!o(e)&&Object.values(e.$sub).every(e=>!!(e.$hints||{}).uuid)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(7),a=o.__importStar(n(8)),i=o.__importStar(n(12)),s=o.__importStar(n(35)),u=n(9),c=n(39),l=n(17),d=n(26),_=n(19);t.on_start_session=function(e,t){return e=_._update_to_now(e),e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{meta:s.on_start_session(e.u_state.meta,t)})}),d._refresh_achievements(e)},t.update_to_now=function(e){return _._update_to_now(e)},t.equip_item=function(e,t){return e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{inventory:a.equip_item(e.u_state.inventory,t),revision:e.u_state.revision+1})}),d._refresh_achievements(e)},t.sell_item=function(e,t){return e=_._sell_item(e,t),d._refresh_achievements(Object.assign({},e,{u_state:Object.assign({},e.u_state,{revision:e.u_state.revision+1})}))},t.rename_avatar=function(e,t){return e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{avatar:r.rename(c.get_lib_SEC(),e.u_state.avatar,t),revision:e.u_state.revision+1})}),d._refresh_achievements(e)},t.change_avatar_class=function(e,t){if(!l.get_available_classes(e.u_state).includes(t))throw new Error(`${u.LIB}: switch class: invalid class "${t}"!`);return e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{avatar:r.switch_class(c.get_lib_SEC(),e.u_state.avatar,t),revision:e.u_state.revision+1})}),d._refresh_achievements(e)},t.acknowledge_engagement_msg_seen=function(e,t){return Object.assign({},e,{u_state:Object.assign({},e.u_state,{engagement:i.acknowledge_seen(e.u_state.engagement,t),revision:e.u_state.revision+1})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(61);t.create_error=function(e,t={}){const n=new Error(e);return Object.keys(t).forEach(e=>{o.COMMON_ERROR_FIELDS.has(e)&&"name"!==e&&"message"!==e&&"stack"!==e?n[e]=t[e]:(n.details=n.details||{},n.details[e]=t[e])}),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(103),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(104),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(44);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-character"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(16);t.LIB=r.LIB;const a=n(114),i=o.__importStar(n(21)),s=n(115),u=n(129);function c(e){return e&&e[r.INTERNAL_PROP]}function l(e={}){if(e.parent&&!c(e.parent))throw new Error(`${r.LIB}›createSEC() argument error: parent must be a valid SEC!`);let t=Object.keys(e),n=Object.create(a.ROOT_PROTOTYPE),o=e.parent?e.parent[r.INTERNAL_PROP]:void 0,l=i.create(o);if(t=t.filter(e=>"parent"!==e),s.PLUGINS.forEach(t=>{l=i.activate_plugin(l,t,e)}),n[r.INTERNAL_PROP]=l,e.parent||(n.injectDependencies({logger:console}),u.decorateWithDetectedEnv(n)),n.injectDependencies({SEC:n}),t.length)throw new Error(`${r.LIB}›createSEC() argument error: unknown args: [${t.join(",")}]!`);return n}a.ROOT_PROTOTYPE.createChild=function(e){return l(Object.assign({},e,{parent:this}))},s.PLUGINS.forEach(e=>{e.augment(a.ROOT_PROTOTYPE)}),t.isSEC=c,t.createSEC=l},function(e,t,n){"use strict";const o=new WeakMap,r=new WeakMap,a=Promise.resolve();function i(e){if("string"!=typeof e)throw new TypeError("eventName must be a string")}function s(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function u(e,t){const n=r.get(e);return n.has(t)||n.set(t,new Set),n.get(t)}class c{constructor(){o.set(this,new Set),r.set(this,new Map)}on(e,t){return i(e),s(t),u(this,e).add(t),this.off.bind(this,e,t)}off(e,t){i(e),s(t),u(this,e).delete(t)}once(e){return new Promise(t=>{i(e);const n=this.on(e,e=>{n(),t(e)})})}async emit(e,t){i(e);const n=u(this,e),r=o.get(this),s=[...n],c=[...r];return await a,Promise.all([...s.map(async e=>{if(n.has(e))return e(t)}),...c.map(async n=>{if(r.has(n))return n(e,t)})])}async emitSerial(e,t){i(e);const n=u(this,e),r=o.get(this),s=[...n],c=[...r];await a;for(const e of s)n.has(e)&&await e(t);for(const n of c)r.has(n)&&await n(e,t)}onAny(e){return s(e),o.get(this).add(e),this.offAny.bind(this,e)}offAny(e){s(e),o.get(this).delete(e)}clearListeners(e){if("string"==typeof e)u(this,e).clear();else{o.get(this).clear();for(const e of r.get(this).values())e.clear()}}listenerCount(e){if("string"==typeof e)return o.get(this).size+u(this,e).size;void 0!==e&&i(e);let t=o.get(this).size;for(const e of r.get(this).values())t+=e.size;return t}}c.Typed=class extends c{},Object.defineProperty(c.Typed,"Typed",{enumerable:!1,value:void 0}),e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(48);t.create_element_base=function(e,t={}){return{element_type:e,uuid:t.uuid||o.generate_uuid()}},t.xxx_test_unrandomize_element=function(e,t){return Object.assign({},e,{uuid:t||"uu1~test~test~test~test~"})}},function(e,t){e.exports="ModuleSymbhasOwnPr-0123456789ABCDEFGHIJKLNQRTUVWXYZ_cfgijkpqtvxz"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("base","qualifier1","qualifier2");t.WeaponPartType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(6),a=n(70);t.i18n_messages=a.i18n_messages;const i=n(27),s=n(28);function u(e){return r.Random.pick(e,a.WEAPON_BASES).hid}function c(e){return r.Random.pick(e,a.WEAPON_QUALIFIERS1).hid}function l(e){return r.Random.pick(e,a.WEAPON_QUALIFIERS2).hid}function d(e,t){return r.Random.integer(...s.BASE_STRENGTH_INTERVAL_BY_QUALITY[t])(e)}t.create=function(e,t={}){const n=o.create_item_base(o.InventorySlot.weapon,t.quality||function(e){let t=r.Random.integer(1,1e3)(e);return t<=300?o.ItemQuality.common:(t-=300)<=300?o.ItemQuality.uncommon:(t-=300)<=250?o.ItemQuality.rare:(t-=250)<=120?o.ItemQuality.epic:o.ItemQuality.legendary}(e)),a=Object.assign({},n,{base_hid:t.base_hid||u(e),qualifier1_hid:t.qualifier1_hid||c(e),qualifier2_hid:t.qualifier2_hid||l(e),base_strength:t.base_strength||d(e,n.quality),enhancement_level:t.enhancement_level||i.MIN_ENHANCEMENT_LEVEL});if(a.base_strength<s.BASE_STRENGTH_INTERVAL_BY_QUALITY[a.quality][0])throw new Error(`${i.LIB}: create(): base_strength too low for this quality!`);if(a.base_strength>s.BASE_STRENGTH_INTERVAL_BY_QUALITY[a.quality][1])throw new Error(`${i.LIB}: create(): base_strength too high for this quality!`);return a},t.enhance=function(e){if(e.enhancement_level>=i.MAX_ENHANCEMENT_LEVEL)throw new Error("can’t enhance a weapon above the maximal enhancement level!");return e.enhancement_level++,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(68),a=o.__importDefault(n(139)),i=n(140),s={en:a.default};t.i18n_messages=s;const u=i.ENTRIES.filter(e=>e.type===r.WeaponPartType.base);t.WEAPON_BASES=u;const c=i.ENTRIES.filter(e=>e.type===r.WeaponPartType.qualifier1);t.WEAPON_QUALIFIERS1=c;const l=i.ENTRIES.filter(e=>e.type===r.WeaponPartType.qualifier2);t.WEAPON_QUALIFIERS2=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("base","qualifier1","qualifier2");t.ArmorPartType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(6),a=n(73);t.i18n_messages=a.i18n_messages;const i=n(29),s=n(30);function u(e){return r.Random.pick(e,a.ARMOR_BASES).hid}function c(e){return r.Random.pick(e,a.ARMOR_QUALIFIERS1).hid}function l(e){return r.Random.pick(e,a.ARMOR_QUALIFIERS2).hid}function d(e,t){return r.Random.integer(...s.BASE_STRENGTH_INTERVAL_BY_QUALITY[t])(e)}t.create=function(e,t={}){const n=o.create_item_base(o.InventorySlot.armor,t.quality||function(e){let t=r.Random.integer(1,1e3)(e);return t<=300?o.ItemQuality.common:(t-=300)<=300?o.ItemQuality.uncommon:(t-=300)<=250?o.ItemQuality.rare:(t-=250)<=120?o.ItemQuality.epic:o.ItemQuality.legendary}(e)),a=Object.assign({},n,{base_hid:t.base_hid||u(e),qualifier1_hid:t.qualifier1_hid||c(e),qualifier2_hid:t.qualifier2_hid||l(e),base_strength:t.base_strength||d(e,n.quality),enhancement_level:t.enhancement_level||i.MIN_ENHANCEMENT_LEVEL});if(a.base_strength<s.BASE_STRENGTH_INTERVAL_BY_QUALITY[a.quality][0])throw new Error(`${i.LIB}: create(): base_strength too low for this quality!`);if(a.base_strength>s.BASE_STRENGTH_INTERVAL_BY_QUALITY[a.quality][1])throw new Error(`${i.LIB}: create(): base_strength too high for this quality!`);return a},t.enhance=function(e){if(e.enhancement_level>=i.MAX_ENHANCEMENT_LEVEL)throw new Error("can’t enhance a armor above the maximal enhancement level!");return e.enhancement_level++,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(71),a=o.__importDefault(n(143)),i=n(144),s={en:a.default};t.i18n_messages=s;const u=i.ENTRIES.filter(e=>e.type===r.ArmorPartType.base);t.ARMOR_BASES=u;const c=i.ENTRIES.filter(e=>e.type===r.ArmorPartType.qualifier1);t.ARMOR_QUALIFIERS1=c;const l=i.ENTRIES.filter(e=>e.type===r.ArmorPartType.qualifier2);t.ARMOR_QUALIFIERS2=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(13),a=n(11),i=n(31);t.compare_items_by_slot_then_strength=function(e,t){if(e.slot!==t.slot)return o.compare_items_by_slot(e,t);switch(e.slot){case o.InventorySlot.armor:{const n=r.compare_armors_by_potential(e,t);if(!Number.isInteger(n))throw new Error(`${i.LIB}: compare():  error sorting armors!`);return n}case o.InventorySlot.weapon:{const n=a.compare_weapons_by_potential(e,t);if(!Number.isInteger(n))throw new Error(`${i.LIB}: compare():  error sorting weapons!`);return n}default:throw new Error(`${i.LIB}: compare(): unhandled item slot "${e.slot}"!`)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1);function r(e){return Object.keys(e.slotted).length}function a(e){return e.unslotted.length}function i(e,t){let n=e.unslotted.find(e=>e.uuid===t);return n||null}t.is_full=function(e){return e.unslotted.length>=e.unslotted_capacity},t.get_equipped_item_count=r,t.get_unequipped_item_count=a,t.get_item_count=function(e){return r(e)+a(e)},t.get_unslotted_item=i,t.get_item=function(e,t){let n=i(e,t);return(n=n||Object.values(e.slotted).find(e=>!!e&&e.uuid===t))||null},t.get_item_in_slot=function(e,t){return e.slotted[t]||null},t.get_slotted_armor=function(e){return e.slotted[o.InventorySlot.armor]||null},t.get_slotted_weapon=function(e){return e.slotted[o.InventorySlot.weapon]||null},t.iterables_unslotted=function*(e){yield*e.unslotted}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(31);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-inventory"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("coin","token");t.Currency=o},function(e,t,n){var o;
/**
 * @license Fraction.js v4.0.12 09/09/2015
 * http://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/**
 * @license Fraction.js v4.0.12 09/09/2015
 * http://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(n){"use strict";var r=2e3,a={s:1,n:0,d:1};function i(e){function t(){var t=Error.apply(this,arguments);t.name=this.name=e,this.stack=t.stack,this.message=t.message}function n(){}return n.prototype=Error.prototype,t.prototype=new n,t}var s=m.DivisionByZero=i("DivisionByZero"),u=m.InvalidParameter=i("InvalidParameter");function c(e,t){return isNaN(e=parseInt(e,10))&&l(),e*t}function l(){throw new u}var d=function(e,t){var n,o=0,r=1,i=1,u=0,d=0,_=0,m=1,h=1,g=0,p=1,f=1,y=1,v=1e7;if(null==e);else if(void 0!==t)i=(o=e)*(r=t);else switch(typeof e){case"object":"d"in e&&"n"in e?(o=e.n,r=e.d,"s"in e&&(o*=e.s)):0 in e?(o=e[0],1 in e&&(r=e[1])):l(),i=o*r;break;case"number":if(e<0&&(i=e,e=-e),e%1==0)o=e;else if(e>0){for(e>=1&&(e/=h=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)));p<=v&&y<=v;){if(e===(n=(g+f)/(p+y))){p+y<=v?(o=g+f,r=p+y):y>p?(o=f,r=y):(o=g,r=p);break}e>n?(g+=f,p+=y):(f+=g,y+=p),p>v?(o=f,r=y):(o=g,r=p)}o*=h}else(isNaN(e)||isNaN(t))&&(r=o=NaN);break;case"string":if(null===(p=e.match(/\d+|./g))&&l(),"-"===p[g]?(i=-1,g++):"+"===p[g]&&g++,p.length===g+1?d=c(p[g++],i):"."===p[g+1]||"."===p[g]?("."!==p[g]&&(u=c(p[g++],i)),(++g+1===p.length||"("===p[g+1]&&")"===p[g+3]||"'"===p[g+1]&&"'"===p[g+3])&&(d=c(p[g],i),m=Math.pow(10,p[g].length),g++),("("===p[g]&&")"===p[g+2]||"'"===p[g]&&"'"===p[g+2])&&(_=c(p[g+1],i),h=Math.pow(10,p[g+1].length)-1,g+=3)):"/"===p[g+1]||":"===p[g+1]?(d=c(p[g],i),m=c(p[g+2],1),g+=3):"/"===p[g+3]&&" "===p[g+1]&&(u=c(p[g],i),d=c(p[g+2],i),m=c(p[g+4],1),g+=5),p.length<=g){i=o=_+(r=m*h)*u+h*d;break}default:l()}if(0===r)throw new s;a.s=i<0?-1:1,a.n=Math.abs(o),a.d=Math.abs(r)};function _(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function m(e,t){if(!(this instanceof m))return new m(e,t);d(e,t),e=m.REDUCE?_(a.d,a.n):1,this.s=a.s,this.n=a.n/e,this.d=a.d/e}m.REDUCE=1,m.prototype={s:1,n:0,d:1,abs:function(){return new m(this.n,this.d)},neg:function(){return new m(-this.s*this.n,this.d)},add:function(e,t){return d(e,t),new m(this.s*this.n*a.d+a.s*this.d*a.n,this.d*a.d)},sub:function(e,t){return d(e,t),new m(this.s*this.n*a.d-a.s*this.d*a.n,this.d*a.d)},mul:function(e,t){return d(e,t),new m(this.s*a.s*this.n*a.n,this.d*a.d)},div:function(e,t){return d(e,t),new m(this.s*a.s*this.n*a.d,this.d*a.n)},clone:function(){return new m(this)},mod:function(e,t){return isNaN(this.n)||isNaN(this.d)?new m(NaN):void 0===e?new m(this.s*this.n%this.d,1):(d(e,t),0===a.n&&0===this.d&&m(0,0),new m(this.s*(a.d*this.n)%(a.n*this.d),a.d*this.d))},gcd:function(e,t){return d(e,t),new m(_(a.n,this.n)*_(a.d,this.d),a.d*this.d)},lcm:function(e,t){return d(e,t),0===a.n&&0===this.n?new m:new m(a.n*this.n,_(a.n,this.n)*_(a.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new m(NaN):new m(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new m(NaN):new m(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new m(NaN):new m(Math.round(e*this.s*this.n/this.d),e)},inverse:function(){return new m(this.s*this.d,this.n)},pow:function(e){return e<0?new m(Math.pow(this.s*this.d,-e),Math.pow(this.n,-e)):new m(Math.pow(this.s*this.n,e),Math.pow(this.d,e))},equals:function(e,t){return d(e,t),this.s*this.n*a.d==a.s*a.n*this.d},compare:function(e,t){d(e,t);var n=this.s*this.n*a.d-a.s*a.n*this.d;return(0<n)-(n<0)},simplify:function(e){if(isNaN(this.n)||isNaN(this.d))return this;var t=this.abs().toContinued();function n(e){return 1===e.length?new m(e[0]):n(e.slice(1)).inverse().add(e[0])}e=e||.001;for(var o=0;o<t.length;o++){var r=n(t.slice(0,o+1));if(r.sub(this.abs()).abs().valueOf()<e)return r.mul(this.s)}return this},divisible:function(e,t){return d(e,t),!(!(a.n*this.d)||this.n*a.d%(a.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,n="",o=this.n,r=this.d;return this.s<0&&(n+="-"),1===r?n+=o:(e&&(t=Math.floor(o/r))>0&&(n+=t,n+=" ",o%=r),n+=o,n+="/",n+=r),n},toLatex:function(e){var t,n="",o=this.n,r=this.d;return this.s<0&&(n+="-"),1===r?n+=o:(e&&(t=Math.floor(o/r))>0&&(n+=t,o%=r),n+="\\frac{",n+=o,n+="}{",n+=r,n+="}"),n},toContinued:function(){var e,t=this.n,n=this.d,o=[];if(isNaN(this.n)||isNaN(this.d))return o;do{o.push(Math.floor(t/n)),e=t%n,t=n,n=e}while(1!==t);return o},toString:function(e){var t,n=this.n,o=this.d;if(isNaN(n)||isNaN(o))return"NaN";m.REDUCE||(n/=t=_(n,o),o/=t),e=e||15;var a=function(e,t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var n=10%t,o=1;1!==n;o++)if(n=10*n%t,o>r)return 0;return o}(0,o),i=function(e,t,n){for(var o=1,r=function(e,t,n){for(var o=1;t>0;e=e*e%n,t>>=1)1&t&&(o=o*e%n);return o}(10,n,t),a=0;a<300;a++){if(o===r)return a;o=10*o%t,r=10*r%t}return 0}(0,o,a),s=-1===this.s?"-":"";if(s+=n/o|0,n%=o,(n*=10)&&(s+="."),a){for(var u=i;u--;)s+=n/o|0,n%=o,n*=10;s+="(";for(u=a;u--;)s+=n/o|0,n%=o,n*=10;s+=")"}else for(u=e;n&&u--;)s+=n/o|0,n%=o,n*=10;return s}},void 0===(o=function(){return m}.apply(t,[]))||(e.exports=o)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(52);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-engagement"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(34),a=o.__importDefault(n(81));t.normalize_code=a.default,t.is_code=function(e){return"string"==typeof e&&!!(e=a.default(e))},t.is_code_redeemable=function(e,t,n){if(!t)throw new Error(`${r.LIB}: is_code_redeemable() invalid invocation!`);const o=a.default(t.code);if(t.code!==o)throw new Error(`Invalid code spec for "${t.code}", should be "${o}"!`);const i=e.redeemed_codes[o];if(i&&t.redeem_limit){const e=t.redeem_limit;if(i.redeem_count>=e)return!1}return!!t.is_redeemable(n,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(169);t.default=function(e){return o.NORMALIZERS.coerce_to_redeemable_code(e)}},function(e,t,n){"use strict";function o(...e){return t=>e.reduce((e,t)=>{return t(e)},t)}Object.defineProperty(t,"__esModule",{value:!0}),t.combine_normalizers=o,t.normalize=function(e,...t){return o(...t)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(34);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-codes"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(54);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-progress"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(56),t),o.__exportStar(n(86),t),o.__exportStar(n(184),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(1),a=n(56),i=n(181);function s(e){return o.Random.bool(.7)(e)?a.MonsterRank.common:o.Random.bool(2/3)(e)?a.MonsterRank.elite:a.MonsterRank.boss}const u=.1;t.create=function(e,t={}){const n=t.name?i.ENTRIES.find(e=>e.name===t.name):o.Random.pick(e,i.ENTRIES);if(!n)throw new Error(`OMR Monster create: can't find a monster corresponding to hint "${t.name}"!`);let a=-1;if(t.level){const n=t.level,i=Math.round(Math.max(1,n*u));a=Math.max(1,Math.min(r.MAX_LEVEL,n+o.Random.integer(-i,i)(e)))}else a=o.Random.integer(1,r.MAX_LEVEL)(e);return{name:n.name,level:a,rank:t.rank||s(e),possible_emoji:t.possible_emoji||n.emoji}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(36),a=n(15),i=n(7),s=n(8),u=n(11),c=n(13),l=n(37),d=n(38);function _(e,t){return o.ITEM_SLOTS.every(n=>{const r=s.get_item_in_slot(e.inventory,n);return!!r&&o.ITEM_QUALITIES_TO_INT[r.quality]<=o.ITEM_QUALITIES_TO_INT[t]})}function m(e){return o.ITEM_SLOTS.reduce((t,n)=>{const o=s.get_item_in_slot(e.inventory,n);return t+(o?r.appraise_power(o):0)},0)}function h(e,t){const n=e.inventory.slotted[o.InventorySlot.armor];return!!n&&c.matches(n,t)}function g(e,t){const n=e.inventory.slotted[o.InventorySlot.weapon];return!!n&&u.matches(n,t)}function p(e){return Object.keys(e.progress.statistics.encountered_adventures).length}function f(e){return e.progress.statistics.fight_won_count+e.progress.statistics.fight_lost_count}function y(e){return Object.keys(e.progress.statistics.encountered_adventures).filter(e=>e.endsWith("_mushroom")).length}function v(e){return Object.keys(e.progress.statistics.encountered_adventures).filter(e=>e.endsWith("_potion")).length}function b(e){return Object.keys(e.progress.statistics.encountered_adventures).filter(e=>e.startsWith("village_")).length}function w(e){return Object.keys(e.progress.statistics.encountered_adventures).filter(e=>e.startsWith("famous_stone_")).length}const E=[1,7,12,20,50,100,150],S=[1,3,10,50,100,500],A=[1,7,11,77,500,1e3,1e4],O=[0,1,2,10,50,500],k=[1,2,3,7,30,120,365],T=[0,5e3,2e4,6e4,12e4,18e4],I=[1,10,33,66,100],j=[{icon:"✨",name:"Summoned",description:"You began your adventures in another world.",lore:"Thanks for visiting!",get_status:()=>a.AchievementStatus.unlocked},...[{icon:"🥉",name:"I am bored",description:"Having played for the first time.",lore:"I am looking for someone to share in an adventure…",get_status:e=>e.progress.statistics.good_play_count?a.AchievementStatus.unlocked:a.AchievementStatus.revealed},{icon:"🥈",name:"I am very bored",description:`Having played ${A[1]} times.`,lore:"If I take one more step, I’ll be the farthest away from home I’ve ever been…",get_status:e=>e.progress.statistics.good_play_count>=A[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.progress.statistics.good_play_count,A[1]]},{icon:"🥇",name:"Turn it up to eleven",description:`Having played ${A[2]} times.`,lore:"You step onto the road, and there’s no telling where you might be swept off to…",get_status:e=>e.progress.statistics.good_play_count>=A[2]?a.AchievementStatus.unlocked:e.progress.statistics.good_play_count>=A[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.good_play_count,A[2]]},{icon:"🏅",name:"I am dead bored",description:`Having played ${A[3]} times.`,lore:"Not all those who wander are lost.",get_status:e=>e.progress.statistics.good_play_count>=A[3]?a.AchievementStatus.unlocked:e.progress.statistics.good_play_count>=A[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.good_play_count,A[3]]},{icon:"🎖",name:"did I mention I was bored?",description:`Having played ${A[4]} times.`,get_status:e=>e.progress.statistics.good_play_count>=A[4]?a.AchievementStatus.unlocked:e.progress.statistics.good_play_count>=A[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.good_play_count,A[4]]},{icon:"👑",name:"king of boredom",description:`Having played ${A[5]} times.`,get_status:e=>e.progress.statistics.good_play_count>=A[5]?a.AchievementStatus.unlocked:e.progress.statistics.good_play_count>=A[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.good_play_count,A[5]]},{icon:"🏆",name:"No-life except for boredom",description:`Having played ${A[6]} times.`,get_status:e=>e.progress.statistics.good_play_count>=A[6]?a.AchievementStatus.unlocked:e.progress.statistics.good_play_count>=A[5]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.good_play_count,A[6]]}],...[{icon:"🎫",name:"What’s in a name?",description:"Having set one’s name.",get_status:e=>e.avatar.name!==i.DEFAULT_AVATAR_NAME?a.AchievementStatus.unlocked:a.AchievementStatus.revealed},{icon:"🎓",name:"Graduated",description:"Having selected a class.",get_status:e=>e.avatar.klass!==i.CharacterClass.novice?a.AchievementStatus.unlocked:a.AchievementStatus.revealed},{icon:"🆔",name:"Registered",description:"Having signed up."}],...[{icon:"🥉",name:"Aspiring Explorer",description:`Having experienced ${E[1]} different adventures`,get_status:e=>p(e)>=E[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed},{icon:"🥈",name:"Rookie Explorer",description:`Having experienced ${E[2]} different adventures`,get_status:e=>p(e)>=E[2]?a.AchievementStatus.unlocked:p(e)>=E[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[p(e),E[2]]},{icon:"🥇",name:"Young Explorer",description:`Having experienced ${E[3]} different adventures`,get_status:e=>p(e)>=E[3]?a.AchievementStatus.unlocked:p(e)>=E[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[p(e),E[3]]},{icon:"🏅",name:"Master Explorer",description:`Having experienced ${E[4]} different adventures`,get_status:e=>p(e)>=E[4]?a.AchievementStatus.unlocked:p(e)>=E[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[p(e),E[4]]},{icon:"🎖",name:"Senior Explorer",description:`Having experienced ${E[5]} different adventures`,get_status:e=>p(e)>=E[5]?a.AchievementStatus.unlocked:p(e)>=E[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[p(e),E[5]]},{icon:"🏆",name:"Grandmaster Explorer",description:`Having experienced ${E[6]} different adventures`,get_status:e=>p(e)>=E[6]?a.AchievementStatus.unlocked:p(e)>=E[5]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[p(e),E[6]]},{icon:"👑",name:"Absolute Explorer",description:"Having experienced ALL the adventures",get_status:e=>p(e)>=l.ALL_GOOD_ADVENTURE_ARCHETYPES.length?a.AchievementStatus.unlocked:p(e)>=E[6]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[p(e),l.ALL_GOOD_ADVENTURE_ARCHETYPES.length]}],...[{icon:"🍄",name:"Mushrooms Lover",description:"Having eaten 3 different mushrooms.",get_status:e=>y(e)>=3?a.AchievementStatus.unlocked:y(e)>=1?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[y(e),3]},{icon:"🍡",name:"Mushrooms Gourmet",description:"Having eaten all the different mushrooms.",get_status:e=>y(e)>=8?a.AchievementStatus.unlocked:y(e)>=3?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[y(e),8]},{icon:"🥤",name:"Potions Taster",description:"Having drunk 3 different potions.",get_status:e=>v(e)>=3?a.AchievementStatus.unlocked:v(e)>=1?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[v(e),3]},{icon:"🍹",name:"Potions Sommelier",description:"Having drunk all the different potions.",get_status:e=>v(e)>=6?a.AchievementStatus.unlocked:v(e)>=3?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[v(e),6]},{icon:"👩‍🌾",name:"Folk Hero",description:"Having completed all the village quests.",get_status:e=>b(e)>=6?a.AchievementStatus.unlocked:b(e)>=1?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[b(e),6]},{icon:"💎",name:"Famous Gems Collector",description:"Having collected all the famous gems.",get_status:e=>w(e)>=4?a.AchievementStatus.unlocked:w(e)>=1?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[w(e),4]}],...[{icon:"🌱",name:"I’ll Be Back",description:`Having been playing for ${k[1]} days.`,get_status:e=>e.progress.statistics.active_day_count>=k[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.progress.statistics.active_day_count,k[1]]},{icon:"🌿",name:"I Am Back",description:`Having been playing for ${k[2]} days.`,get_status:e=>e.progress.statistics.active_day_count>=k[2]?a.AchievementStatus.unlocked:e.progress.statistics.active_day_count>=k[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.active_day_count,k[2]]},{icon:"🌲",name:"Regular",description:`Having been playing for ${k[3]} days.`,get_status:e=>e.progress.statistics.active_day_count>=k[3]?a.AchievementStatus.unlocked:e.progress.statistics.active_day_count>=k[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.active_day_count,k[3]]},{icon:"🌳",name:"Faithful",description:`Having been playing for ${k[4]} days.`,get_status:e=>e.progress.statistics.active_day_count>=k[4]?a.AchievementStatus.unlocked:e.progress.statistics.active_day_count>=k[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.active_day_count,k[4]]},{icon:"💉",name:"Hooked",description:`Having been playing for ${k[5]} days.`,get_status:e=>e.progress.statistics.active_day_count>=k[5]?a.AchievementStatus.unlocked:e.progress.statistics.active_day_count>=k[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.active_day_count,k[5]]},{icon:"🎂",name:"Addicted",description:`Having been playing for ${k[6]} days.`,get_status:e=>e.progress.statistics.active_day_count>=k[6]?a.AchievementStatus.unlocked:e.progress.statistics.active_day_count>=k[5]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.active_day_count,k[6]]}],...[{icon:"🥄",name:"First Blood",description:"Having experienced your first random fight encounter.",get_status:e=>f(e)>=1?a.AchievementStatus.unlocked:a.AchievementStatus.revealed},{icon:"🔨",name:"Into The Wild",description:`Having experienced ${S[1]} random fight encounters.`,get_status:e=>f(e)>=S[1]?a.AchievementStatus.unlocked:f(e)>=1?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[f(e),S[1]]},{icon:"⛏",name:"Born To Be Wild",description:`Having experienced ${S[2]} random fight encounters.`,get_status:e=>f(e)>=S[2]?a.AchievementStatus.unlocked:f(e)>=S[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[f(e),S[2]]},{icon:"🔪",name:"Wild Like The Wind",description:`Having experienced ${S[3]} random fight encounters.`,get_status:e=>f(e)>=S[3]?a.AchievementStatus.unlocked:f(e)>=S[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[f(e),S[3]]},{icon:"🗡",name:"The Wild One",description:`Having experienced ${S[4]} random fight encounters.`,get_status:e=>f(e)>=S[4]?a.AchievementStatus.unlocked:f(e)>=S[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[f(e),S[4]]},{icon:"⚔",name:"Alpha Of The Wilderness",description:`Having experienced ${S[5]} random fight encounters.`,get_status:e=>f(e)>=S[5]?a.AchievementStatus.unlocked:f(e)>=S[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[f(e),S[5]]}],...[{icon:"😱",name:"Sorry my hand slipped",description:"Having played too soon for the 1st time.",lore:"each mistake teaches us something…",get_status:e=>e.progress.statistics.bad_play_count?a.AchievementStatus.unlocked:a.AchievementStatus.hidden},{icon:"🙀",name:"Oops!... I Did It Again",description:"Having played too soon for the 2nd time.",lore:"Anyone who has never made a mistake has never tried anything new.",get_status:e=>e.progress.statistics.bad_play_count>=O[2]?a.AchievementStatus.unlocked:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.bad_play_count,O[2]]},{icon:"😼",name:"I’m not that innocent",description:`Having played too soon ${O[3]} times.`,lore:"There is no such thing as accident; it is fate misnamed.",get_status:e=>e.progress.statistics.bad_play_count>=O[3]?a.AchievementStatus.unlocked:e.progress.statistics.bad_play_count>=O[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.bad_play_count,O[3]]},{icon:"😈",name:"It’s good to be bad",description:`Having played too soon ${O[4]} times.`,lore:"Never retreat, never retract… never admit a mistake…",get_status:e=>e.progress.statistics.bad_play_count>=O[4]?a.AchievementStatus.unlocked:e.progress.statistics.bad_play_count>=O[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.bad_play_count,O[4]]},{icon:"👻",name:"Hello darkness my old friend",description:`Having played too soon ${O[5]} times.`,lore:"Give yourself to the dark side…",get_status:e=>e.progress.statistics.bad_play_count>=O[5]?a.AchievementStatus.unlocked:e.progress.statistics.bad_play_count>=O[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.progress.statistics.bad_play_count,O[5]]}],...[{icon:"🥄",name:"There Is No Spoon",description:'Having replaced your starting "spoon of the noob" weapon.',lore:"A weapon isn’t good or bad, depends on the person who uses it.",get_status:e=>!e.inventory.slotted[o.InventorySlot.weapon]||g(e,d.STARTING_WEAPON_SPEC)?a.AchievementStatus.revealed:a.AchievementStatus.unlocked},{icon:"🧦",name:"They Weren’t Matched Anyway",description:'Having replaced your starting "socks of the noob" armor.',lore:"I’ll tell you one thing you can’t do: you can’t put your shoes on, then your socks on.",get_status:e=>!e.inventory.slotted[o.InventorySlot.armor]||h(e,d.STARTING_ARMOR_SPEC)?a.AchievementStatus.revealed:a.AchievementStatus.unlocked},{icon:"🎒",name:"I Was Born Ready",description:'Having replaced all your starting "spoon+socks" equipment.',get_status:e=>h(e,d.STARTING_ARMOR_SPEC)||g(e,d.STARTING_WEAPON_SPEC)?a.AchievementStatus.revealed:a.AchievementStatus.unlocked,get_completion_rate:e=>[(h(e,d.STARTING_ARMOR_SPEC)?0:1)+(g(e,d.STARTING_WEAPON_SPEC)?0:1),2]},{icon:"🛍",name:"U Got The Look",description:"All equipped items of quality uncommon or higher. 💚 ",lore:"If there are cracks in your armor, your opponent is going to find them...",get_status:e=>_(e,o.ItemQuality.uncommon)?a.AchievementStatus.unlocked:a.AchievementStatus.revealed},{icon:"💅",name:"Rare Sight",description:"All equipped items of quality rare or higher. 💙 ",get_status:e=>_(e,o.ItemQuality.rare)?a.AchievementStatus.unlocked:_(e,o.ItemQuality.uncommon)?a.AchievementStatus.revealed:a.AchievementStatus.hidden},{icon:"🎩",name:"Epic Smile",description:"All equipped items of quality epic or higher. 💜 ",get_status:e=>_(e,o.ItemQuality.epic)?a.AchievementStatus.unlocked:_(e,o.ItemQuality.rare)?a.AchievementStatus.revealed:a.AchievementStatus.hidden},{icon:"👑",name:"I Am A Legend",description:"All equipped items of quality legendary or higher. 🧡 ",get_status:e=>_(e,o.ItemQuality.legendary)?a.AchievementStatus.unlocked:_(e,o.ItemQuality.epic)?a.AchievementStatus.revealed:a.AchievementStatus.hidden},{icon:"🌞",name:"Twinkle Twinkle Little Star",description:"All equipped items of quality artifact or higher. 💛 ",get_status:e=>_(e,o.ItemQuality.artifact)?a.AchievementStatus.unlocked:a.AchievementStatus.hidden},{icon:"🐸",name:"Frog In A Well",description:`Having a combined equipment’s power of ${T[1]} or higher.`,get_status:e=>m(e)>=T[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[m(e),T[1]]},{icon:"👙",name:"Looking Like something",description:`Having a combined equipment’s power of ${T[2]} or higher.`,get_status:e=>m(e)>=T[2]?a.AchievementStatus.unlocked:m(e)>=T[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[m(e),T[2]]},{icon:"🎁",name:"Formal Adventurer",description:`Having a combined equipment’s power of ${T[3]} or higher.`,get_status:e=>m(e)>=T[3]?a.AchievementStatus.unlocked:m(e)>=T[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[m(e),T[3]]},{icon:"🔱",name:"King-looking Adventurer",description:`Having a combined equipment’s power of ${T[4]} or higher.`,get_status:e=>m(e)>=T[4]?a.AchievementStatus.unlocked:m(e)>=T[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[m(e),T[4]]},{icon:"⚜",name:"Emperor-Looking Adventurer",description:`Having a combined equipment’s power of ${T[5]} or higher.`,get_status:e=>m(e)>=T[5]?a.AchievementStatus.unlocked:m(e)>=T[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[m(e),T[5]]}],...[{icon:"👶",name:"Tiny Adventurer",description:"Having a level of 3 or higher.",lore:"You realize that all your life you have been coasting along as if you were in a dream. Suddenly, facing the trials of the last few days, you have come alive.",get_status:e=>e.avatar.attributes.level>=3?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.level,3]},{icon:"🧒",name:"Reasonable Adventurer",description:"Having a level of 7 or higher.",lore:"Today you wake up, full of energy and ideas, and you know, somehow, that overnight everything has changed. What a difference a day makes.",get_status:e=>e.avatar.attributes.level>=7?a.AchievementStatus.unlocked:e.avatar.attributes.level>=3?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,7]},{icon:"👩‍🎤",name:"Teenage Adventurer",description:"Having a level of 12 or higher.",lore:"You’ve done things the hard way. But without taking risks, taking responsibility for failure... how could you have understood?",get_status:e=>e.avatar.attributes.level>=12?a.AchievementStatus.unlocked:e.avatar.attributes.level>=7?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,12]},{icon:"🧑",name:"Newbie Adventurer",description:"Having a level of 20 or higher.",lore:"Being smart doesn’t hurt. And a little luck now and then is nice. But the key is patience and hard work.",get_status:e=>e.avatar.attributes.level>=20?a.AchievementStatus.unlocked:e.avatar.attributes.level>=12?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,20]},{icon:"🧑",name:"Seasoned Adventurer",description:`Having a level of ${I[2]} or higher.`,lore:"You resolve to continue pushing yourself. Perhaps there’s more to you than you thought.",get_status:e=>e.avatar.attributes.level>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.level>=20?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,I[2]]},{icon:"🧓",name:"Grey Haired Adventurer",description:`Having a level of ${I[3]} or higher.`,lore:"With the life you’ve been living, the punishment your body has taken... there are limits, and maybe you’ve reached them. Is this what it’s like to grow old?",get_status:e=>e.avatar.attributes.level>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.level>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,I[3]]},{icon:"🐢",name:"Spirit Of The Tortoise",description:`Having a level of ${I[4]} or higher.`,lore:"So that’s how it works. You plod along, putting one foot before the other, look up, and suddenly, there you are. Right where you wanted to be all along.",get_status:e=>e.avatar.attributes.level>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.level>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,I[4]]},{icon:"🧝",name:"Long Lived Adventurer",description:"Having a level of 300 or higher.",lore:"The results of hard work and dedication always look like luck. But you know you’ve earned every ounce of your success.",get_status:e=>e.avatar.attributes.level>=300?a.AchievementStatus.unlocked:e.avatar.attributes.level>=I[4]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.level,300]},{icon:"💪",name:"Light Punishment",description:`Having a health of ${I[1]} or higher.`,lore:"That’s just a scratch...",get_status:e=>e.avatar.attributes.health>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.health,I[1]]},{icon:"😤",name:"Bring It On",description:`Having a health of ${I[2]} or higher.`,lore:"Not even hurt!",get_status:e=>e.avatar.attributes.health>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.health>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.health,I[2]]},{icon:"🏋",name:"I Can Handle It",description:`Having a health of ${I[3]} or higher.`,lore:"Is that all you’ve got?",get_status:e=>e.avatar.attributes.health>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.health>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.health,I[3]]},{icon:"🐘",name:"Spirit Of The Elephant",description:`Having a health of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.health>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.health>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.health,I[4]]},{icon:"🍼",name:"Awoken",description:`Having a mana of ${I[1]} or higher.`,get_status:e=>e.avatar.attributes.mana>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.mana,I[1]]},{icon:"🥛",name:"The Power Of The Mind",description:`Having a mana of ${I[2]} or higher.`,get_status:e=>e.avatar.attributes.mana>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.mana>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.mana,I[2]]},{icon:"☕",name:"Vast Consciousness",description:`Having a mana of ${I[3]} or higher.`,get_status:e=>e.avatar.attributes.mana>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.mana>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.mana,I[3]]},{icon:"🧙",name:"Spirit Of The Human",description:`Having a mana of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.mana>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.mana>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.mana,I[4]]},{icon:"💪",name:"Well Built",description:`Having a strength of ${I[1]} or higher.`,get_status:e=>e.avatar.attributes.strength>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.strength,I[1]]},{icon:"😤",name:"Local Strongperson",description:`Having a strength of ${I[2]} or higher.`,get_status:e=>e.avatar.attributes.strength>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.strength>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.strength,I[2]]},{icon:"🏋",name:"Titan",description:`Having a strength of ${I[3]} or higher.`,get_status:e=>e.avatar.attributes.strength>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.strength>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.strength,I[3]]},{icon:"🦍",name:"Spirit Of The Gorilla",description:`Having a strength of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.strength>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.strength>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.strength,I[4]]},{icon:"🐥",name:"Small One",description:`Having a agility of ${I[1]} or higher.`,get_status:e=>e.avatar.attributes.agility>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.agility,I[1]]},{icon:"🤹",name:"Swift One",description:`Having a agility of ${I[2]} or higher.`,get_status:e=>e.avatar.attributes.agility>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.agility>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.agility,I[2]]},{icon:"🤸",name:"Untouchable",description:`Having a agility of ${I[3]} or higher.`,get_status:e=>e.avatar.attributes.agility>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.agility>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.agility,I[3]]},{icon:"🐒",name:"Spirit Of The Monkey",description:`Having a agility of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.agility>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.agility>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.agility,I[4]]},{icon:"💖",name:"Sharp tongue",description:`Having a charisma of ${I[1]} or higher.`,get_status:e=>e.avatar.attributes.charisma>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.charisma,I[1]]},{icon:"💓",name:"Silver tongue",description:`Having a charisma of ${I[2]} or higher.`,get_status:e=>e.avatar.attributes.charisma>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.charisma>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.charisma,I[2]]},{icon:"💋",name:"Golden tongue",description:`Having a charisma of ${I[3]} or higher.`,get_status:e=>e.avatar.attributes.charisma>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.charisma>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.charisma,I[3]]},{icon:"🐈",name:"Spirit Of The Cat",description:`Having a charisma of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.charisma>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.charisma>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.charisma,I[4]]},{icon:"🤓",name:"Bright",description:`Having a wisdom of ${I[1]} or higher.`,get_status:e=>e.avatar.attributes.wisdom>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.wisdom,I[1]]},{icon:"🧐",name:"Smart",description:`Having a wisdom of ${I[2]} or higher.`,get_status:e=>e.avatar.attributes.wisdom>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.wisdom>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.wisdom,I[2]]},{icon:"🧓",name:"Sage",description:`Having a wisdom of ${I[3]} or higher.`,get_status:e=>e.avatar.attributes.wisdom>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.wisdom>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.wisdom,I[3]]},{icon:"🦉",name:"Spirit Of The Owl",description:`Having a wisdom of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.wisdom>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.wisdom>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.wisdom,I[4]]},{icon:"☘",name:"Sprinkled",description:`Having a luck of ${I[1]} or higher.`,lore:"Luck is great, but most of life is hard work.",get_status:e=>e.avatar.attributes.luck>=I[1]?a.AchievementStatus.unlocked:a.AchievementStatus.revealed,get_completion_rate:e=>[e.avatar.attributes.luck,I[1]]},{icon:"🍀",name:"Blessed",description:`Having a luck of ${I[2]} or higher.`,lore:"The amount of good luck coming your way depends on your willingness to act.",get_status:e=>e.avatar.attributes.luck>=I[2]?a.AchievementStatus.unlocked:e.avatar.attributes.luck>=I[1]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.luck,I[2]]},{icon:"👼",name:"Divinely Touched",description:`Having a luck of ${I[3]} or higher.`,get_status:e=>e.avatar.attributes.luck>=I[3]?a.AchievementStatus.unlocked:e.avatar.attributes.luck>=I[2]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.luck,I[3]]},{icon:"🐇",name:"Spirit Of The Rabbit",description:`Having a luck of ${I[4]} or higher.`,get_status:e=>e.avatar.attributes.luck>=I[4]?a.AchievementStatus.unlocked:e.avatar.attributes.luck>=I[3]?a.AchievementStatus.revealed:a.AchievementStatus.hidden,get_completion_rate:e=>[e.avatar.attributes.luck,I[4]]}],...[{icon:"⚔",name:"I Like Swords!",description:"Having equipped a sword once.",lore:"Still sharp...",get_status:e=>g(e,{base_hid:"sword"})||g(e,{base_hid:"longsword"})?a.AchievementStatus.unlocked:a.AchievementStatus.revealed}],...[{icon:"🐺",name:"Alpha player",description:"You started playing during the alpha or earlier.",lore:"Let me tell you of a time of great adventure…",get_status:()=>a.AchievementStatus.unlocked},{icon:"🦍",name:"Beta player",description:"You played during the beta. (no beta yet, though)",lore:"Those were the days my friend…",get_status:()=>a.AchievementStatus.revealed}],...[{icon:"👑",name:"Usurper",description:'Having set the name "Offirmo".',lore:"I see you…",get_status:e=>"Offirmo"===e.avatar.name?a.AchievementStatus.unlocked:a.AchievementStatus.secret},{icon:"💣",name:"Blown Away",description:"Having encountered a crash..."},{icon:"🍀",name:"Just plain lucky",description:"You have 1/1000 chance to gain this on each activity.",lore:"The amount of good luck coming your way depends on your willingness to act.",get_status:()=>123===Math.floor(1e3*Math.random())?a.AchievementStatus.unlocked:a.AchievementStatus.secret},{icon:"🏴‍☠️",name:"Hacker",description:"You manipulated the threads of reality to obtain this achievement. (can’t be obtained by normal means)",lore:"Just a different way of looking at problems that no one’s thought of ;)",get_status:e=>a.AchievementStatus.secret}],...[{icon:"🍪",name:"TEST",description:"This secret achievement can only be obtained through debug commands, to test the achievements system.",lore:"…and a piece of lore should appear here",get_status:e=>void 0===e.progress.achievements.TEST||e.progress.achievements.TEST===a.AchievementStatus.secret?a.AchievementStatus.secret:a.AchievementStatus.unlocked},{icon:"🧒",name:"Reborn!",description:'This secret achievement can only be obtained if you got "reborn" = your savegame was reinitialised with an autoplay due to a new format being introduced. This can only happen during the alpha.',lore:"I won’t waste this new chance! I’ll live my life to the fullest!",get_status:e=>e.progress.achievements["Reborn!"]===a.AchievementStatus.unlocked?a.AchievementStatus.unlocked:a.AchievementStatus.secret}]],C=new Set,N=j.filter(e=>e.name&&e.description&&e.get_status).map(({name:e,icon:t,description:n,lore:o,get_status:r,get_completion_rate:a},i)=>{if(C.has(e))throw new Error(`Achievements: duplicate definition for "${e}"!`);return C.add(e),{session_uuid:[`${i}`.padStart(4,"0"),e].join(" "),icon:t||"🏆",name:e,description:n,lore:o,get_status:r,get_completion_rate:a}});t.default=N},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=o.Enum("none","loss","small","medium","big","huge");t.CoinsGain=r;const a=o.Enum("story","fight");t.AdventureType=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("just-some-text","hello_world--flow","hello_world--aside","hello_world--warning","tip--first_play","code_redemption--failed","code_redemption--succeeded","achievement-unlocked","reborn");t.EngagementKey=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);var r=n(190);t.to_debug=r.to_debug;var a=n(192);t.to_actions=a.to_actions;var i=n(193);t.to_text_callbacks=i.callbacks,t.to_text=i.to_text;var s=n(194);t.to_html=s.to_html,o.__exportStar(n(41),t),o.__exportStar(n(25),t),o.__exportStar(n(58),t),o.__exportStar(n(195),t);var u=n(2);t.Enum=u.Enum},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(59),t),o.__exportStar(n(38),t),o.__exportStar(n(92),t),o.__exportStar(n(204),t),o.__exportStar(n(206),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importStar(n(14)),a=o.__importStar(n(15)),i=n(17),s=n(19),u=n(202),c=n(203),l=n(26);t.play=function(e,t){e=s._update_to_now(e);let{u_state:n,t_state:o}=e;const d=i.get_available_energy_float(o)>=1;return e=Object.assign({},e,{t_state:Object.assign({},o,{energy:d?r.use_energy([n.energy,o.energy]):r.loose_all_energy([n.energy,o.energy])})}),n=(e=d?u.play_good(e,t):c.play_bad(e,t)).u_state,e=Object.assign({},e,{u_state:Object.assign({},n,{progress:a.on_played(n.progress,{good:d,adventure_key:n.last_adventure.hid,encountered_monster_key:n.last_adventure.encounter?n.last_adventure.encounter.name:null,active_class:n.avatar.klass,coins_gained:n.last_adventure.gains.coin,tokens_gained:n.last_adventure.gains.token,items_gained:(n.last_adventure.gains.armor?1:0)+(n.last_adventure.gains.weapon?1:0)}),revision:e.u_state.revision+1})}),l._refresh_achievements(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(2),a=n(48),i=n(6),s=n(1),u=n(7),c=o.__importStar(n(8)),l=o.__importStar(n(4)),d=n(4),_=n(11),m=n(13),h=n(85),g=n(37),p=n(9),f=n(19),y=["health","mana","strength","agility","charisma","wisdom","luck"],v=["strength"],b=["agility"],w=["mana"],E=["strength","mana"],S={[u.CharacterClass.novice]:y,[u.CharacterClass.barbarian]:v,[u.CharacterClass.druid]:["wisdom","mana"],[u.CharacterClass.warrior]:v,[u.CharacterClass.paladin]:E,[u.CharacterClass.rogue]:b,[u.CharacterClass.sorcerer]:w,[u.CharacterClass.warlock]:w,[u.CharacterClass.wizard]:w,[u.CharacterClass["darkness hunter"]]:E,[u.CharacterClass.hunter]:["agility"],[u.CharacterClass.priest]:["charisma","mana"],[u.CharacterClass["death knight"]]:E,[u.CharacterClass.mage]:w,[u.CharacterClass.engineer]:["wisdom"],[u.CharacterClass.thief]:b,[u.CharacterClass.assassin]:b,[u.CharacterClass.illusionist]:["charisma","agility"],[u.CharacterClass.knight]:v,[u.CharacterClass.pirate]:["luck"],[u.CharacterClass.ninja]:b,[u.CharacterClass.corsair]:b,[u.CharacterClass.necromancer]:w,[u.CharacterClass.sculptor]:["agility"],[u.CharacterClass.summoner]:w};if(Object.keys(S).length!==r.Enum.keys(u.CharacterClass).length)throw new Error(`${p.LIB}: PRIMARY_STATS_BY_CLASS is out of date!`);const A=["health"],O=["luck"],k=["wisdom"],T=["health"],I={[u.CharacterClass.novice]:y,[u.CharacterClass.barbarian]:A,[u.CharacterClass.druid]:["strength","agility"],[u.CharacterClass.warrior]:A,[u.CharacterClass.paladin]:T,[u.CharacterClass.rogue]:O,[u.CharacterClass.sorcerer]:k,[u.CharacterClass.warlock]:k,[u.CharacterClass.wizard]:k,[u.CharacterClass["darkness hunter"]]:T,[u.CharacterClass.hunter]:["strength"],[u.CharacterClass.priest]:["wisdom"],[u.CharacterClass["death knight"]]:T,[u.CharacterClass.mage]:k,[u.CharacterClass.engineer]:["agility","luck"],[u.CharacterClass.thief]:O,[u.CharacterClass.assassin]:O,[u.CharacterClass.illusionist]:["luck"],[u.CharacterClass.knight]:A,[u.CharacterClass.pirate]:["charisma","agility"],[u.CharacterClass.ninja]:O,[u.CharacterClass.corsair]:["charisma","luck"],[u.CharacterClass.necromancer]:k,[u.CharacterClass.sculptor]:["wisdom","charisma"],[u.CharacterClass.summoner]:k};if(Object.keys(I).length!==r.Enum.keys(u.CharacterClass).length)throw new Error(`${p.LIB}: SECONDARY_STATS_BY_CLASS is out of date!`);t.play_adventure=function(e,t){const n=d.get_prng(e.u_state.prng),o=function(e,t,n,o){let{hid:r,good:s,type:u,outcome:c}=t,l=Object.assign({},c);l.random_attribute&&(l[i.Random.pick(e,y)]=!0),l.lowest_attribute&&(l[y.reduce((e,t)=>n.attributes[e]<n.attributes[t]?e:t,"health")]=!0),l.class_primary_attribute&&(l[i.Random.pick(e,S[n.klass])]=!0),l.class_secondary_attribute&&(l[i.Random.pick(e,I[n.klass])]=!0),l.armor_or_weapon&&(i.Random.bool()(e)?l.armor=!0:l.weapon=!0),l.armor_or_weapon_improvement&&(i.Random.bool()(e)?l.armor_improvement=!0:l.weapon_improvement=!0);const d=n.attributes.level+(l.level?1:0);return{uuid:a.generate_uuid(),hid:r,good:s,encounter:u===g.AdventureType.fight?h.create(e,{level:n.attributes.level}):void 0,gains:{level:l.level?1:0,health:l.health?1:0,mana:l.mana?1:0,strength:l.strength?1:0,agility:l.agility?1:0,charisma:l.charisma?1:0,wisdom:l.wisdom?1:0,luck:l.luck?1:0,coin:g.generate_random_coin_gain(e,l.coin,d),token:l.token?1:0,armor:l.armor?m.create(e):null,weapon:l.weapon?_.create(e):null,armor_improvement:l.armor_improvement,weapon_improvement:l.weapon_improvement}}}(n,t,e.u_state.avatar,e.u_state.inventory),{gains:r}=o;let v=0,b=0;if(r.level&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.level)),r.health&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.health,r.health)),r.mana&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.mana,r.mana)),r.strength&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.strength,r.strength)),r.agility&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.agility,r.agility)),r.charisma&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.charisma,r.charisma)),r.wisdom&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.wisdom,r.wisdom)),r.luck&&(v++,e=f._receive_stat_increase(e,u.CharacterAttribute.luck,r.luck)),r.coin&&(v++,e=f._receive_coins(e,r.coin)),r.token&&(v++,e=f._receive_tokens(e,r.token)),r.weapon&&(v++,b++,e=f._receive_item(e,r.weapon)),r.armor&&(v++,b++,e=f._receive_item(e,r.armor)),r.weapon_improvement){v++;let t=c.get_item_in_slot(e.u_state.inventory,s.InventorySlot.weapon);t&&t.enhancement_level<_.MAX_ENHANCEMENT_LEVEL&&_.enhance(t)}if(r.armor_improvement){v++;const t=c.get_item_in_slot(e.u_state.inventory,s.InventorySlot.armor);t&&t.enhancement_level<m.MAX_ENHANCEMENT_LEVEL&&m.enhance(t)}if(t.good&&!v)throw new Error(`${p.LIB}: play_adventure() for "good click" hid "${t.hid}" unexpectedly resulted in NO gains!`);if(b>1)throw new Error(`${p.LIB}: play_adventure() for hid "${t.hid}" unexpectedly resulted in ${b} item gains!`);return e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{last_adventure:o,prng:l.update_use_count(e.u_state.prng,n,{I_swear_I_really_cant_know_whether_the_rng_was_used:!0})})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(2),a=n(4),i=n(7),s=o.__importStar(n(12)),u=n(9),c=n(91),l=n(18),d=(...e)=>t=>e.map(e=>t=(t||{})[e])&&t;function _(e){let t=Number(e);return Number.isNaN(t)?0:t}const m=d("avatar","name"),h=d("u_state","avatar","name"),g=e=>h(e)||m(e),p=d("avatar","klass"),f=d("u_state","avatar","klass"),y=e=>f(e)||p(e),v=d("prng","seed"),b=d("u_state","prng","seed"),w=e=>b(e)||v(e),E=d("good_click_count"),S=d("progress","statistics","good_play_count"),A=d("u_state","progress","statistics","good_play_count"),O=e=>_(A(e)||S(e)||E(e)),k=d("click_count"),T=d("progress","statistics","bad_play_count"),I=d("u_state","progress","statistics","bad_play_count"),j=e=>_(I(e)||T(e)||(e=>_(k(e))-_(E(e)))(e));t.reset_and_salvage=function(e){console.info(`${u.LIB}: salvaging some data from a v${e&&e.schema_version} legacy savegame.`),a.xxx_internal_reset_prng_cache();let t=c.create();const n=w(e);Number.isInteger(n)?t=c.reseed(t,n):(console.warn(`${u.LIB}: salvaging: may need to update the seed salvaging!`),t=c.reseed(t));const o=g(e);"string"!=typeof o?console.warn(`${u.LIB}: salvaging: may need to update the avatar name salvaging!`):t=c.rename_avatar(t,o);const d=y(e);"string"==typeof d&&r.Enum.isType(i.CharacterClass,d)?t=c.change_avatar_class(t,d):console.warn(`${u.LIB}: salvaging: may need to update the avatar class salvaging!`);const _=O(e);0===_&&console.warn(`${u.LIB}: salvaging: may need to update the good play count salvaging!`);const m=j(e);return t=c.autoplay(t,{target_good_play_count:_,target_bad_play_count:m}),t=Object.assign({},t,{u_state:Object.assign({},t.u_state,{engagement:s.enqueue(t.u_state.engagement,{type:s.EngagementType.warning,key:l.EngagementKey.reborn})})}),console.info(`${u.LIB}: salvaged some data from a v${e&&e.schema_version} legacy savegame.`),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(208);t.VERSION=o.VERSION;t.LIB="@tbrpg/flux"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("start_game","on_start_session","play","equip_item","sell_item","rename_avatar","change_avatar_class","redeem_code","acknowledge_engagement_msg_seen","update_to_now","hack");t.ActionType=o},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=n(102),a=n(60),i=n(62),s=n(105);t.handler=(async(e,t)=>{console.log("\n*******\n* handling a tbrpg-rpc…");let n=500,u={jsonrpc:"2.0",id:"???",error:r.DEFAULT_JSONRPC_ERROR_PAYLOAD,result:void 0};try{u.error.code=r.JSONRPC_CODE.invalid_request,n=400,function(e){const{httpMethod:t,body:n,isBase64Encoded:o}=e;if("PUT"!==t)throw a.create_error("Wrong HTTP method!",{statusCode:405});if(o)throw a.create_error("Base 64 unexpected!",{statusCode:422});if(!n||n.length>3e4)throw a.create_error("Bad body!",{statusCode:413})}(e);const t=function(e,t){let n;try{n=JSON.parse(t.body)}catch(t){throw console.error(t),e.error.code=r.JSONRPC_CODE.parse_error,a.create_error("JSON.Parse error!",{statusCode:400})}if(Array.isArray(n))throw e.error.code=r.JSONRPC_CODE.parse_error,a.create_error("Batch RPC not implemented!",{statusCode:501});if("id,jsonrpc,method,params"!==Object.keys(n).sort().join(",")||"2.0"!==n.jsonrpc||!Number.isInteger(n.id)&&"string"!=typeof n.id)throw e.error.code=r.JSONRPC_CODE.invalid_request,a.create_error("Bad JSON-RPC structure!",{statusCode:400});if(e.id=n.id,e.error.data.method=n.method,Object.keys(n.params).length<1)throw e.error.code=r.JSONRPC_CODE.invalid_params,a.create_error("Invalid params!",{statusCode:400});if(!o.Enum.isType(i.Method,n.method))throw e.error.code=r.JSONRPC_CODE.method_not_found,a.create_error("Invalid RPC method!",{statusCode:400});return n}(u,e);if(u.error.code=r.JSONRPC_CODE.internal_error,u.error.message="internal error while processing the request!",n=500,(u=s.process_rpc(t,u)).error&&u.result)throw new Error("Internal error: unclear result after handling!");u.result&&(n=200)}catch(e){n=e.statusCode||n,u.error=e.jsonrpc_response?e.jsonrpc_response:u.error?u.error:r.DEFAULT_JSONRPC_ERROR_PAYLOAD,u.error.message=e.message,delete u.result}return{statusCode:n,body:JSON.stringify(u)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o={parse_error:-32700,invalid_request:-32600,method_not_found:-32601,invalid_params:-32602,internal_error:-32603};t.JSONRPC_CODE=o;const r={code:o.internal_error,message:"Internal error!",data:{}};t.DEFAULT_JSONRPC_ERROR_PAYLOAD=r},function(e,t,n){"use strict";function o(){return new Set(["name","message","stack","statusCode","shouldRedirect","framesToPop","details","SEC","_temp"])}Object.defineProperty(t,"__esModule",{value:!0}),t.create=o;const r=o();t.COMMON_ERROR_FIELDS=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("echo","sync","play");t.Method=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(60),a=n(62),i=o.__importDefault(n(106)),s=o.__importDefault(n(107)),u=o.__importDefault(n(217));t.process_rpc=function(e,t){switch(e.method){case a.Method.echo:return i.default(e,t);case a.Method.sync:return s.default(e,t);case a.Method.play:return u.default(e,t);default:throw r.create_error("RPC method not implemented!",{statusCode:501})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const{method:n,params:o}=e;return t.result={method:n,params:o},delete t.error,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(108);t.default=function(e,t){return t.result={v:o.VERSION},delete t.error,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);var r=n(20);t.SCHEMA_VERSION=r.SCHEMA_VERSION;var a=n(95);t.VERSION=a.VERSION,o.__exportStar(n(209),t),o.__exportStar(n(42),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="0.58.3",t.BUILD_DATE="20190306_23h29"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2).Enum("level","health","mana","strength","agility","charisma","wisdom","luck","coin","token","weapon","armor","weapon_improvement","armor_improvement");t.GainType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importDefault(n(3)),a=o.__importStar(n(7)),i=o.__importStar(n(8)),s=o.__importStar(n(23)),u=o.__importStar(n(4)),c=o.__importStar(n(14)),l=o.__importStar(n(12)),d=o.__importStar(n(24)),_=o.__importStar(n(15)),m=o.__importStar(n(35)),h=n(11),g=n(85),p=n(9),f=r.default({hid:"fight_lost_any",uuid:"uu1de1~EVAdXlW5_p23Ro4OH",good:!0,encounter:g.DEMO_MONSTER_01,gains:{level:0,health:0,mana:0,strength:0,agility:0,charisma:0,wisdom:0,luck:1,coin:0,token:0,armor:null,weapon:null,armor_improvement:!1,weapon_improvement:!1}});t.DEMO_ADVENTURE_01=f;const y=r.default({hid:"dying_man",uuid:"uu1de2~p23Ro4OH_EVAdXlW5",good:!0,gains:{level:0,health:0,mana:0,strength:0,agility:0,charisma:0,wisdom:0,luck:0,coin:1234,token:0,weapon:null,armor:null,weapon_improvement:!1,armor_improvement:!1}});t.DEMO_ADVENTURE_02=y;const v=r.default({hid:"rare_goods_seller",uuid:"uu1de2~p23Ro4OH_EVAdXlW5",good:!0,gains:{level:0,health:0,mana:0,strength:0,agility:0,charisma:0,wisdom:0,luck:0,coin:0,token:0,weapon:h.DEMO_WEAPON_1,armor:null,weapon_improvement:!1,armor_improvement:!1}});t.DEMO_ADVENTURE_03=v;const b=r.default({hid:"princess",uuid:"uu1de2~p23Ro4OH_EVAdXlW5",good:!0,gains:{level:0,health:0,mana:0,strength:0,agility:0,charisma:0,wisdom:0,luck:0,coin:123,token:0,weapon:null,armor:null,weapon_improvement:!1,armor_improvement:!0}});t.DEMO_ADVENTURE_04=b;const w=r.default({schema_version:p.SCHEMA_VERSION,u_state:{revision:203,uuid:"uu1EO9VgTjPlR1YPj0yfdWjG",creation_date:"20180813_00h33",avatar:a.DEMO_STATE,inventory:i.DEMO_STATE,wallet:s.DEMO_STATE,prng:u.DEMO_STATE,energy:c.DEMO_U_STATE,engagement:l.DEMO_STATE,codes:d.DEMO_STATE,progress:_.DEMO_STATE,meta:m.DEMO_STATE,last_adventure:f},t_state:{energy:c.DEMO_T_STATE}});t.DEMO_STATE=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(43),a=o.default({schema_version:2,revision:42,name:"Perte",klass:r.CharacterClass.paladin,attributes:{level:13,health:12,mana:23,strength:4,agility:5,charisma:6,wisdom:7,luck:8}});t.DEMO_STATE=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),r=n(44),a=n(43);t.CharacterAttribute=a.CharacterAttribute,t.CharacterClass=a.CharacterClass;const i=n(63),s="[anonymous]";t.DEFAULT_AVATAR_NAME=s;const u=o.Enum.keys(a.CharacterAttribute);t.CHARACTER_ATTRIBUTES=u;const c=["level","health","mana","strength","agility","charisma","wisdom","luck"];t.CHARACTER_ATTRIBUTES_SORTED=c,i.get_lib_SEC().xTry("boot checks",()=>{if(u.length!==c.length)throw new Error(`${r.LIB}: CHARACTER_ATTRIBUTES to update!`)});const l=o.Enum.keys(a.CharacterClass);t.CHARACTER_CLASSES=l,t.create=function(e){return i.get_lib_SEC(e).xTry("create",({enforce_immutability:e})=>e({schema_version:r.SCHEMA_VERSION,revision:0,name:s,klass:a.CharacterClass.novice,attributes:{level:1,health:1,mana:0,strength:1,agility:1,charisma:1,wisdom:1,luck:1}}))},t.rename=function(e,t,n){return i.get_lib_SEC(e).xTry("rename",({enforce_immutability:e})=>{if(!n)throw new Error(`${r.LIB}: Error while renaming to "${n}: invalid target value!`);return n===t.name?t:e(Object.assign({},t,{name:n,revision:t.revision+1}))})},t.switch_class=function(e,t,n){return i.get_lib_SEC(e).xTry("switch_class",({enforce_immutability:e})=>{if(n===t.klass)return t;if(!o.Enum.isType(a.CharacterClass,n))throw new Error(`${r.LIB}: "${n}" is not a valid class!`);return e(Object.assign({},t,{klass:n,revision:t.revision+1}))})},t.increase_stat=function(e,t,n,o=1){return i.get_lib_SEC(e).xTry("increase_stat",({enforce_immutability:e})=>{if(o<=0)throw new Error(`${r.LIB}: Error while increasing stat "${n}": invalid amount!`);return e(Object.assign({},t,{attributes:Object.assign({},t.attributes,{[n]:t.attributes[n]+o}),revision:t.revision+1}))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(65)),r=Object.create(null);t.ROOT_PROTOTYPE=r,r.emitter=new o.default,r.setAnalyticsAndErrorDetails=function(e={}){return this.setAnalyticsDetails(e).setErrorReportDetails(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(116),r=n(45),a=n(120),i=n(127),s={[i.PLUGIN]:i.PLUGIN,[o.PLUGIN.id]:o.PLUGIN,[r.PLUGIN.id]:r.PLUGIN,[a.PLUGIN.id]:a.PLUGIN};t.PLUGINS_BY_ID=s;const u=Object.values(s);t.PLUGINS=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(16),a=o.__importStar(n(21)),i=n(117),s=o.__importStar(n(118)),u=n(22),c="logical_stack",l={sid:-1,plugins:{[c]:{stack:{operation:i.LOGICAL_STACK_SEPARATOR_NON_ADJACENT}}}};function d(e){let t=null;return e.reduce((e,n)=>{const{module:o,operation:r}=n.plugins[c].stack;return o&&o!==t&&(e=e+(e.length?i.LOGICAL_STACK_SEPARATOR:"")+o,t=o),r&&(e=e+i.LOGICAL_STACK_SEPARATOR+r+i.LOGICAL_STACK_OPERATION_MARKER),e},"")+i.LOGICAL_STACK_END_MARKER}const _={id:c,state:s,augment:e=>{e.setLogicalStack=function({module:e,operation:t}){let n=this[r.INTERNAL_PROP];return n=a.reduce_plugin(n,c,n=>(e&&(n=s.set_module(n,e)),t&&(n=s.set_operation(n,t)),n)),this[r.INTERNAL_PROP]=n,this},e.getLogicalStack=function(){return d(u._getSECStatePath(this))},e.getShortLogicalStack=function(){const{stack:e}=this[r.INTERNAL_PROP].plugins[c];return i.LOGICAL_STACK_BEGIN_MARKER+e.module+i.LOGICAL_STACK_SEPARATOR+e.operation+i.LOGICAL_STACK_OPERATION_MARKER+i.LOGICAL_STACK_END_MARKER},e._decorateErrorWithLogicalStack=function(e){const t=this;e._temp=e._temp||{};const n={full:t.getLogicalStack()},o={};if(e._temp.SEC)if(e.details.logicalStack.includes(n.full));else{const n=e._temp.statePath,r=u._getSECStatePath(t);let a=0;for(let e=1;e<r.length&&n[e]===r[e];++e)a=e;let i=[].concat(r);i.push(l),i=i.concat(n.slice(a+1)),e._temp.statePath=i,o.logicalStack=d(i)}else e._temp.SEC=t,e._temp.statePath=u._getSECStatePath(t),n.short=t.getShortLogicalStack(),e.message.startsWith(n.short)?console.warn("UNEXPECTED SEC non-decorated error already prefixed??"):e.message=n.short+": "+e.message,o.logicalStack=n.full;return e.details=Object.assign({},e.details||{},o),e}}};t.PLUGIN=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOGICAL_STACK_BEGIN_MARKER="";t.LOGICAL_STACK_END_MARKER="";t.LOGICAL_STACK_SEPARATOR="›";t.LOGICAL_STACK_MODULE_MARKER="";t.LOGICAL_STACK_OPERATION_MARKER="";t.LOGICAL_STACK_SEPARATOR_NON_ADJACENT="…"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e){const t=e?Object.create(e.stack):(()=>{const e=Object.create(null);return e.module=void 0,e})();return t.operation=void 0,{stack:t}},t.set_module=function(e,t){const{stack:n}=e;return n.module===t?e:(n.module=t,Object.assign({},e,{stack:n}))},t.set_operation=function(e,t){const{stack:n}=e;return n.operation===t?e:(n.operation=t,Object.assign({},e,{stack:n}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e){return{context:e?Object.create(e.context):Object.create(null)}},t.injectDependencies=function(e,t,n){const{context:o}=e;return o[t]=n,Object.assign({},e,{context:o})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importDefault(n(121)),a=n(122),i=n(5),s=n(16),u=n(22),c=o.__importStar(n(125)),l=n(126),d=n(45),_=o.__importStar(n(21));function m(e){return delete e._temp,e}const h={id:"error_handling",state:c,augment:e=>{e._handleError=function({SEC:e,debugId:t="?",shouldRethrow:n=!0},o){l.createCatcher({debugId:t,decorators:[r.default,t=>e._decorateErrorWithLogicalStack(t),t=>e._decorateErrorWithDetails(t)],onError:n?null:t=>e.emitter.emit("final-error",{SEC:e,err:m(t)})})(o)},e.throwNewError=function(e,t){new Error(e).details=t,this._handleError({SEC:this,shouldRethrow:!0})},e._decorateErrorWithDetails=function(e){const t=this[s.INTERNAL_PROP],n=i.get_UTC_timestamp_ms(),o={ENV:t.plugins[d.PLUGIN_ID].context.ENV,TIME:n,SESSION_DURATION_MS:n-t.plugins[d.PLUGIN_ID].context.SESSION_START_TIME},r=u.flattenToOwn(t.plugins.error_handling.details);return e.details=Object.assign({},o,r,e.details||{}),e},e.setErrorReportDetails=function(e){let t=this[s.INTERNAL_PROP];return t=_.reduce_plugin(t,"error_handling",t=>(Object.entries(e).forEach(([e,n])=>{t=c.addDetail(t,e,n)}),t)),this[s.INTERNAL_PROP]=t,this},e.xTry=function(e,t){const n=this.createChild().setLogicalStack({operation:e}),o=n[s.INTERNAL_PROP].plugins[d.PLUGIN_ID].context;try{return t(o)}catch(e){n._handleError({SEC:n,debugId:"xTry",shouldRethrow:!0},e)}},e.xTryCatch=function(e,t){const n=this.createChild().setLogicalStack({operation:e}),o=n[s.INTERNAL_PROP].plugins[d.PLUGIN_ID].context;try{return t(o)}catch(e){n._handleError({SEC:n,debugId:"xTryCatch",shouldRethrow:!1},e)}},e.xPromiseCatch=function(e,t){const n=this.createChild().setLogicalStack({operation:e});return t.catch(e=>{n._handleError({SEC:n,debugId:"xPromiseCatch",shouldRethrow:!1},e)})},e.xPromiseTry=function(e,t){const n=this.createChild().setLogicalStack({operation:e}),o=n[s.INTERNAL_PROP].plugins[d.PLUGIN_ID].context;return a.promiseTry(()=>t(o)).catch(e=>{n._handleError({SEC:n,debugId:"xPromiseTry",shouldRethrow:!0},e)})},e.xPromiseTryCatch=function(e,t){const n=this.createChild().setLogicalStack({operation:e}),o=n[s.INTERNAL_PROP].plugins[d.PLUGIN_ID].context;return a.promiseTry(()=>t(o)).catch(e=>{n._handleError({SEC:n,debugId:"xPromiseTryCatch",shouldRethrow:!1},e)})}}};t.PLUGIN=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(61);t.default=function(e={}){const t=new Error(e.message||`(non-error caught: "${e}")`);return o.COMMON_ERROR_FIELDS.forEach(n=>{e[n]&&(t[n]=e[n])}),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseTry=function(e){return Promise.resolve().then(e)}},function(e,t,n){"use strict";function o(e=new Date){return`${e.getUTCFullYear()}${("0"+(e.getUTCMonth()+1)).slice(-2)}${("0"+e.getUTCDate()).slice(-2)}`}function r(e=new Date){const t=("0"+e.getUTCHours()).slice(-2),n=("0"+e.getUTCMinutes()).slice(-2);return o(e)+`_${t}h${n}`}function a(e=new Date){const t=("0"+e.getUTCSeconds()).slice(-2),n=("00"+e.getUTCMilliseconds()).slice(-3);return r(e)+`:${t}.${n}`}Object.defineProperty(t,"__esModule",{value:!0}),t.get_UTC_timestamp_ms=function(e=new Date){return+e},t.get_human_readable_UTC_timestamp_days=o,t.get_human_readable_UTC_timestamp_minutes=r,t.get_human_readable_UTC_timestamp_ms_v1=a,t.get_human_readable_UTC_timestamp_ms=function(e=new Date){return"ts1_"+a(e)}},function(e,t,n){"use strict";function o(e){if(21!==e.length)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [wrong length]");const[t,n]=e.split("_");if(8!==t.length)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [wrong date length]");const o=t.slice(0,4),r=t.slice(4,6),a=t.slice(6,8),i=Number(o);if(i<1970)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [YYYY]");const s=Number(r)-1;if(s>11)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [MM]");const u=Number(a);if(u>31)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [DD]");if(12!==n.length)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [wrong time length]");const c=n.slice(0,2),l=n.slice(3,5),d=n.slice(6,8),_=n.slice(9,12),m=Number(c);if(m>23)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [hh]");const h=Number(l);if(h>59)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [mm]");const g=Number(d);if(g>59)throw new Error("Human-readable timestamp UTC/ms: can’t parse! [ss]");const p=Number(_);return new Date(Date.UTC(i,s,u,m,h,g,p))}Object.defineProperty(t,"__esModule",{value:!0}),t.parse_human_readable_UTC_timestamp_ms_v1=o,t.parse_human_readable_UTC_timestamp_ms=function(e){if(e.startsWith("ts1_"))return o(e.slice(4));throw new Error("wrong timestamp, can’t parse!")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e){return{details:e?Object.create(e.details):Object.create(null)}},t.addDetail=function(e,t,n){const{details:o}=e;return o[t]=n,Object.assign({},e,{details:o})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCatcher=function({decorators:e=[],onError:t,debugId:n="?"}={}){return o=>{if(o=e.reduce((e,t)=>{try{if(!(e=t(e)).message)throw new Error}catch(o){console.error(`catchFactory exec from ${n}: bad decorator!`,{err:e,decoratorErr:o,"decorator.name":t.name})}return e},o),t)return t(o);throw o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(5),a=n(16),i=o.__importStar(n(21)),s=n(22),u=o.__importStar(n(128)),c=n(45);t.PLUGIN_ID="analytics";const l={id:"analytics",state:u,augment:e=>{e.setAnalyticsDetails=function(e){let t=this[a.INTERNAL_PROP];return t=i.reduce_plugin(t,"analytics",t=>(Object.entries(e).forEach(([e,n])=>{t=u.addDetail(t,e,n)}),t)),this[a.INTERNAL_PROP]=t,this},e.fireAnalyticsEvent=function(e,t={}){const n=r.get_UTC_timestamp_ms();let o=this[a.INTERNAL_PROP];if(!e)throw new Error("Incorrect eventId!");const{ENV:i}=this.getInjectedDependencies(),s={ENV:i,TIME:n,SESSION_DURATION_MS:n-o.plugins[c.PLUGIN_ID].context.SESSION_START_TIME},u=this.getAnalyticsDetails();return t=Object.assign({},s,u,t),this.emitter.emit("analytics",{SEC:this,eventId:e,details:t}),this},e.getAnalyticsDetails=function(){const e=this[a.INTERNAL_PROP].plugins.analytics;return s.flattenToOwn(e.details)}}};t.PLUGIN=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e){return{details:e?Object.create(e.details):Object.create(null)}},t.addDetail=function(e,t,n){const{details:o}=e;return o[t]=n,Object.assign({},e,{details:o})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5);t.decorateWithDetectedEnv=function(e){let t=(()=>{try{if("string"==typeof NODE_ENV)return NODE_ENV;if("undefined"!=typeof process)return"production"}catch(e){}return"development"})();const n=o.get_UTC_timestamp_ms();e.injectDependencies({ENV:t,NODE_ENV:t,IS_DEV_MODE:!1,IS_VERBOSE:!1,CHANNEL:"unknown",SESSION_START_TIME:n}),e.setAnalyticsAndErrorDetails({ENV:t,CHANNEL:"unknown"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(64),r="__global_root sec";let a=null;"undefined"!=typeof window&&(window.hasOwnProperty(r)||Object.defineProperty(window,r,{enumerable:!0,set:function(){throw new Error(`You can’t assign window.${r}!`)},get:function(){return a||(a=o.createSEC()),a}})),"undefined"!=typeof global&&(global.hasOwnProperty(r)||Object.defineProperty(global,r,{enumerable:!0,set:function(){throw new Error(`You can’t assign global.${r}!`)},get:function(){return a||(a=o.createSEC()),a}})),t.getRootSEC=function(){return"undefined"!=typeof window?window[r]:"undefined"!=typeof global?global[r]:(a||(console.info("Creating root SEC… [XXX unknown env path]"),a=o.createSEC()),a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importDefault(n(132)),a=o.__importDefault(n(134)),i=o.__importDefault(n(67)),s=n(6),u="uu1",c=21,l=u.length+c;t.UUID_LENGTH=l,t.generate_uuid=function({length:e=c,rng:t}={}){return u+(t?a.default(e=>{let n=[];const o=s.Random.integer(0,255);for(let r=0;r<e;r++)n.push(o(t));return n},i.default,e):r.default(e))}},function(e,t,n){var o=n(133),r=n(67);e.exports=function(e){for(var t=o(e=e||21),n="";0<e--;)n+=r[63&t[e]];return n}},function(e,t,n){var o=n(49);if(o.randomFillSync){var r={};e.exports=function(e){var t=r[e];return t||(t=Buffer.allocUnsafe(e),e<=255&&(r[e]=t)),o.randomFillSync(t)}}else e.exports=o.randomBytes},function(e,t){e.exports=function(e,t,n){for(var o=(2<<Math.log(t.length-1)/Math.LN2)-1,r=Math.ceil(1.6*o*n/t.length),a="";;)for(var i=e(r),s=0;s<r;s++){var u=i[s]&o;if(t[u]&&(a+=t[u]).length===n)return a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(46),r=n(47),a=n(66);t.create_item_base=function(e,t=o.ItemQuality.common){return Object.assign({},a.create_element_base(o.ElementType.item),{slot:e,quality:t})},t.compare_items_by_slot=function(e,t){const n=r.ITEM_SLOTS_TO_INT[e.slot];if(!Number.isInteger(n))throw new Error("compare items by slots: unhandled slot! (A)");const o=r.ITEM_SLOTS_TO_INT[t.slot];if(!Number.isInteger(o))throw new Error("compare items by slots: unhandled slot! (B)");return n-o},t.compare_items_by_quality=function(e,t){const n=r.ITEM_QUALITIES_TO_INT[e.quality];if(!Number.isInteger(n))throw new Error("compare items by quality: unhandled quality! (A)");const o=r.ITEM_QUALITIES_TO_INT[t.quality];if(!Number.isInteger(o))throw new Error("compare items by quality: unhandled quality! (B)");return n-o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(47),r=e=>e;t.decorate_SEC=function(e){return e.injectDependencies({enforce_immutability:r}),e.setAnalyticsAndErrorDetails({product:o.PRODUCT}),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(44),a=n(63),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(1),a=n(11),i=n(13),s=o.default({schema_version:1,revision:42,unslotted_capacity:20,slotted:{[r.InventorySlot.armor]:i.DEMO_ARMOR_2,[r.InventorySlot.weapon]:a.DEMO_WEAPON_1},unslotted:[a.DEMO_WEAPON_2,i.DEMO_ARMOR_1]});t.DEMO_STATE=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={weapon:{base:{axe:"axe",bow:"bow",claw:"claw",dagger:"dagger",grimoire:"grimoire",harp:"harp",knife:"knife",longbow:"long bow",longsword:"long sword",luth:"luth",mace:"scythe",scythe:"spear",spear:"spear",spoon:"spoon",staff:"staff",sword:"sword",wand:"wand"},qualifier1:{admirable:"admirable",arcanic:"arcanic",bestial:"bestial",bone:"bone",brass:"brass",cardboard:"cardboard",complex:"complex",composite:"composite",consecrated:"consecrated",crafted:"crafted",cruel:"cruel",cunning:"cunning",cursed:"cursed",emerald:"emerald",engraved:"engraved",forbidden:"forbidden",forgotten:"forgotten",ghost:"ghost",golden:"golden",heavy:"heavy",heroic:"heroic",holy:"holy",inflexible:"inflexible",invincible:"invincible",iron:"iron",jade:"jade",light:"light",living:"living",lost:"lost",mechanical:"mechanical",mysterious:"mysterious",old:"old",onyx:"onyx",overrated:"overrated",powerful:"powerful",practical:"practical",proven:"proven",raging:"raging",robust:"robust",sapphire:"sapphire",savage:"savage",silver:"silver",simple:"simple",sinister:"sinister",skeleton:"skeleton",solid:"solid",steel:"steel",strange:"strange",subtile:"subtle",swift:"swift",unwavering:"unwavering",used:"used",whirling:"whirling",wooden:"wooden"},qualifier2:{adjudicator:"adjudicator’s",ambassador:"ambassador’s",ancients:"of the ancients",apprentice:"apprentice’s",assaulting:"assaulting",beginner:"beginner’s",brave:"of the brave",conqueror:"conqueror’s",cruel_tyrant:"cruel tyrant’s",defender:"defender’s",destructor:"destructor’s",dwarven:"dwarven",elite:"elite",elven:"elven",executioner:"executioner’s",expert:"expert",explorer:"explorer’s",gladiator:"gladiator’s",goddess:"of the goddess",guard:"guard’s",hunter:"hunter’s",judgement:"of judgement",king:"king’s",mediator:"mediator’s",mercenary:"mercenary’s",militia:"militia’s",nightmare:"nightmare’s",noble:"noble’s",noob:"of the noob",pilgrim:"pilgrim’s",pioneer:"pioneer’s",pirate:"pirate’s",profane:"profane’s",ranger:"ranger’s",sorcerer:"sorcerer’s",tormentor:"tormentor’s",training:"training",traveler:"traveler’s",twink:"of the twink",tyrant:"tyrant’s",upholder:"upholder’s",warfield:"warfield’s",warfield_king:"warfield king’s",warrior:"warrior’s",wise:"of the wise",woodsman:"woodsman’s"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ENTRIES=[{type:"base",hid:"axe"},{type:"base",hid:"bow"},{type:"base",hid:"claw"},{type:"base",hid:"dagger"},{type:"base",hid:"grimoire"},{type:"base",hid:"harp"},{type:"base",hid:"knife"},{type:"base",hid:"longbow"},{type:"base",hid:"longsword"},{type:"base",hid:"luth"},{type:"base",hid:"mace"},{type:"base",hid:"scythe"},{type:"base",hid:"spear"},{type:"base",hid:"spoon"},{type:"base",hid:"staff"},{type:"base",hid:"sword"},{type:"base",hid:"wand"},{type:"qualifier1",hid:"admirable"},{type:"qualifier1",hid:"arcanic"},{type:"qualifier1",hid:"bestial"},{type:"qualifier1",hid:"bone"},{type:"qualifier1",hid:"brass"},{type:"qualifier1",hid:"cardboard"},{type:"qualifier1",hid:"complex"},{type:"qualifier1",hid:"composite"},{type:"qualifier1",hid:"consecrated"},{type:"qualifier1",hid:"crafted"},{type:"qualifier1",hid:"cruel"},{type:"qualifier1",hid:"cunning"},{type:"qualifier1",hid:"cursed"},{type:"qualifier1",hid:"emerald"},{type:"qualifier1",hid:"engraved"},{type:"qualifier1",hid:"forbidden"},{type:"qualifier1",hid:"forgotten"},{type:"qualifier1",hid:"ghost"},{type:"qualifier1",hid:"golden"},{type:"qualifier1",hid:"heavy"},{type:"qualifier1",hid:"heroic"},{type:"qualifier1",hid:"holy"},{type:"qualifier1",hid:"inflexible"},{type:"qualifier1",hid:"invincible"},{type:"qualifier1",hid:"iron"},{type:"qualifier1",hid:"jade"},{type:"qualifier1",hid:"light"},{type:"qualifier1",hid:"living"},{type:"qualifier1",hid:"lost"},{type:"qualifier1",hid:"mechanical"},{type:"qualifier1",hid:"mysterious"},{type:"qualifier1",hid:"old"},{type:"qualifier1",hid:"onyx"},{type:"qualifier1",hid:"overrated"},{type:"qualifier1",hid:"powerful"},{type:"qualifier1",hid:"practical"},{type:"qualifier1",hid:"proven"},{type:"qualifier1",hid:"raging"},{type:"qualifier1",hid:"robust"},{type:"qualifier1",hid:"sapphire"},{type:"qualifier1",hid:"savage"},{type:"qualifier1",hid:"silver"},{type:"qualifier1",hid:"simple"},{type:"qualifier1",hid:"sinister"},{type:"qualifier1",hid:"skeleton"},{type:"qualifier1",hid:"solid"},{type:"qualifier1",hid:"steel"},{type:"qualifier1",hid:"strange"},{type:"qualifier1",hid:"subtile"},{type:"qualifier1",hid:"swift"},{type:"qualifier1",hid:"unwavering"},{type:"qualifier1",hid:"used"},{type:"qualifier1",hid:"whirling"},{type:"qualifier1",hid:"wooden"},{type:"qualifier2",hid:"adjudicator"},{type:"qualifier2",hid:"ambassador"},{type:"qualifier2",hid:"ancients"},{type:"qualifier2",hid:"apprentice"},{type:"qualifier2",hid:"assaulting"},{type:"qualifier2",hid:"beginner"},{type:"qualifier2",hid:"brave"},{type:"qualifier2",hid:"conqueror"},{type:"qualifier2",hid:"cruel_tyrant"},{type:"qualifier2",hid:"defender"},{type:"qualifier2",hid:"destructor"},{type:"qualifier2",hid:"dwarven"},{type:"qualifier2",hid:"elite"},{type:"qualifier2",hid:"elven"},{type:"qualifier2",hid:"executioner"},{type:"qualifier2",hid:"expert"},{type:"qualifier2",hid:"explorer"},{type:"qualifier2",hid:"gladiator"},{type:"qualifier2",hid:"goddess"},{type:"qualifier2",hid:"guard"},{type:"qualifier2",hid:"hunter"},{type:"qualifier2",hid:"judgement"},{type:"qualifier2",hid:"king"},{type:"qualifier2",hid:"mediator"},{type:"qualifier2",hid:"mercenary"},{type:"qualifier2",hid:"militia"},{type:"qualifier2",hid:"nightmare"},{type:"qualifier2",hid:"noble"},{type:"qualifier2",hid:"noob"},{type:"qualifier2",hid:"pilgrim"},{type:"qualifier2",hid:"pioneer"},{type:"qualifier2",hid:"pirate"},{type:"qualifier2",hid:"profane"},{type:"qualifier2",hid:"ranger"},{type:"qualifier2",hid:"sorcerer"},{type:"qualifier2",hid:"tormentor"},{type:"qualifier2",hid:"training"},{type:"qualifier2",hid:"traveler"},{type:"qualifier2",hid:"twink"},{type:"qualifier2",hid:"tyrant"},{type:"qualifier2",hid:"upholder"},{type:"qualifier2",hid:"warfield_king"},{type:"qualifier2",hid:"warfield"},{type:"qualifier2",hid:"warrior"},{type:"qualifier2",hid:"wise"},{type:"qualifier2",hid:"woodsman"}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(1),a=n(27),i=n(70),s=n(28),u=n(69),c={uuid:"uu1~test~demo~weapon~001",element_type:r.ElementType.item,slot:r.InventorySlot.weapon,base_hid:i.WEAPON_BASES[0].hid,qualifier1_hid:i.WEAPON_QUALIFIERS1[0].hid,qualifier2_hid:i.WEAPON_QUALIFIERS2[0].hid,quality:r.ItemQuality.uncommon,base_strength:s.BASE_STRENGTH_INTERVAL_BY_QUALITY[r.ItemQuality.uncommon][0]+1,enhancement_level:a.MIN_ENHANCEMENT_LEVEL};t.DEMO_WEAPON_1=c;const l={uuid:"uu1~test~demo~weapon~002",element_type:r.ElementType.item,slot:r.InventorySlot.weapon,base_hid:i.WEAPON_BASES[1].hid,qualifier1_hid:i.WEAPON_QUALIFIERS1[1].hid,qualifier2_hid:i.WEAPON_QUALIFIERS2[1].hid,quality:r.ItemQuality.legendary,base_strength:s.BASE_STRENGTH_INTERVAL_BY_QUALITY[r.ItemQuality.legendary][1]-1,enhancement_level:a.MAX_ENHANCEMENT_LEVEL};t.DEMO_WEAPON_2=l,t.generate_random_demo_weapon=function(e){return e=e||o.Random.engines.mt19937().autoSeed(),u.create(e,{enhancement_level:o.Random.integer(a.MIN_ENHANCEMENT_LEVEL,a.MAX_ENHANCEMENT_LEVEL)(e)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(28);t.compare_weapons_by_potential=function(e,t){const n=r.get_ultimate_medium_damage(e),a=r.get_ultimate_medium_damage(t);return n!==a?a-n:o.compare_items_by_quality(e,t)||e.uuid.localeCompare(t.uuid)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={armor:{base:{armguards:"armguards",belt:"belt",boots:"boots",bracers:"bracers",breastplate:"breastplate",cape:"cape",cloak:"cloak",crown:"crown",gauntlets:"gauntlets",gloves:"gloves",greaves:"greaves",hat:"hat",helmet:"helmet",leggings:"leggings",mantle:"mantle",pants:"pants",robe:"robe",shield:"shield",shoes:"shoes",shoulders:"shoulders",socks:"socks"},qualifier1:{admirable:"admirable",arcanic:"arcanic",bestial:"bestial",bone:"bone",brass:"brass",cardboard:"cardboard",complex:"complex",composite:"composite",consecrated:"consecrated",crafted:"crafted",cruel:"cruel",cunning:"cunning",cursed:"cursed",embroidered:"embroidered",emerald:"emerald",engraved:"engraved",forbidden:"forbidden",forgotten:"forgotten",ghost:"ghost",golden:"golden",heavy:"heavy",heroic:"heroic",holy:"holy",inflexible:"inflexible",invincible:"invincible",iron:"iron",jade:"jade",light:"light",living:"living",lost:"lost",mechanical:"mechanical",mysterious:"mysterious",old:"old",onyx:"onyx",overrated:"overrated",powerful:"powerful",practical:"practical",proven:"proven",raging:"raging",robust:"robust",sapphire:"sapphire",savage:"savage",scale:"scale",silver:"silver",simple:"simple",sinister:"sinister",skeleton:"skeleton",solid:"solid",steel:"steel",strange:"strange",subtile:"subtle",swift:"swift",unwavering:"unwavering",used:"used",whirling:"whirling",wooden:"wooden",adjudicator:"adjudicator’s"},qualifier2:{ambassador:"ambassador’s",ancients:"of the ancients",apprentice:"apprentice’s",assaulting:"assaulting",beginner:"beginner’s",brave:"of the brave",conqueror:"conqueror’s",cruel_tyrant:"cruel tyrant’s",defender:"defender’s",destructor:"destructor’s",dwarven:"dwarven",elite:"elite",elven:"elven",executioner:"executioner’s",expert:"expert",explorer:"explorer’s",gladiator:"gladiator’s",goddess:"of the goddess",guard:"guard’s",hunter:"hunter’s",judgement:"of judgement",king:"king’s",mediator:"mediator’s",mercenary:"mercenary’s",militia:"militia’s",nightmare:"nightmare’s",noble:"noble’s",noob:"of the noob",pilgrim:"pilgrim’s",pioneer:"pioneer’s",pirate:"pirate’s",profane:"profane’s",ranger:"ranger’s",sorcerer:"sorcerer’s",tormentor:"tormentor’s",training:"training",traveler:"traveler’s",twink:"of the twink",tyrant:"tyrant’s",upholder:"upholder’s",warfield_king:"warfield king’s",warfield:"warfield’s",warrior:"warrior’s",wise:"of the wise",woodsman:"woodsman’s"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ENTRIES=[{type:"base",hid:"armguards"},{type:"base",hid:"belt"},{type:"base",hid:"boots"},{type:"base",hid:"bracers"},{type:"base",hid:"breastplate"},{type:"base",hid:"cloak"},{type:"base",hid:"crown"},{type:"base",hid:"gauntlets"},{type:"base",hid:"gloves"},{type:"base",hid:"greaves"},{type:"base",hid:"hat"},{type:"base",hid:"helmet"},{type:"base",hid:"leggings"},{type:"base",hid:"mantle"},{type:"base",hid:"pants"},{type:"base",hid:"robe"},{type:"base",hid:"shield"},{type:"base",hid:"shoes"},{type:"base",hid:"shoulders"},{type:"base",hid:"socks"},{type:"qualifier1",hid:"bone"},{type:"qualifier1",hid:"brass"},{type:"qualifier1",hid:"embroidered"},{type:"qualifier1",hid:"cardboard"},{type:"qualifier1",hid:"composite"},{type:"qualifier1",hid:"consecrated"},{type:"qualifier1",hid:"crafted"},{type:"qualifier1",hid:"cursed"},{type:"qualifier1",hid:"emerald"},{type:"qualifier1",hid:"engraved"},{type:"qualifier1",hid:"golden"},{type:"qualifier1",hid:"heavy"},{type:"qualifier1",hid:"holy"},{type:"qualifier1",hid:"invincible"},{type:"qualifier1",hid:"iron"},{type:"qualifier1",hid:"jade"},{type:"qualifier1",hid:"light"},{type:"qualifier1",hid:"mechanical"},{type:"qualifier1",hid:"mysterious"},{type:"qualifier1",hid:"old"},{type:"qualifier1",hid:"onyx"},{type:"qualifier1",hid:"powerful"},{type:"qualifier1",hid:"practical"},{type:"qualifier1",hid:"proven"},{type:"qualifier1",hid:"robust"},{type:"qualifier1",hid:"sapphire"},{type:"qualifier1",hid:"scale"},{type:"qualifier1",hid:"silver"},{type:"qualifier1",hid:"simple"},{type:"qualifier1",hid:"skeleton"},{type:"qualifier1",hid:"solid"},{type:"qualifier1",hid:"steel"},{type:"qualifier1",hid:"strange"},{type:"qualifier1",hid:"subtile"},{type:"qualifier1",hid:"swift"},{type:"qualifier1",hid:"unwavering"},{type:"qualifier1",hid:"used"},{type:"qualifier1",hid:"wooden"},{type:"qualifier2",hid:"ancients"},{type:"qualifier2",hid:"apprentice"},{type:"qualifier2",hid:"beginner"},{type:"qualifier2",hid:"brave"},{type:"qualifier2",hid:"conqueror"},{type:"qualifier2",hid:"cruel_tyrant"},{type:"qualifier2",hid:"defender"},{type:"qualifier2",hid:"destructor"},{type:"qualifier2",hid:"dwarven"},{type:"qualifier2",hid:"elite"},{type:"qualifier2",hid:"elven"},{type:"qualifier2",hid:"expert"},{type:"qualifier2",hid:"explorer"},{type:"qualifier2",hid:"gladiator"},{type:"qualifier2",hid:"goddess"},{type:"qualifier2",hid:"guard"},{type:"qualifier2",hid:"judgement"},{type:"qualifier2",hid:"king"},{type:"qualifier2",hid:"mediator"},{type:"qualifier2",hid:"mercenary"},{type:"qualifier2",hid:"militia"},{type:"qualifier2",hid:"nightmare"},{type:"qualifier2",hid:"noble"},{type:"qualifier2",hid:"noob"},{type:"qualifier2",hid:"pilgrim"},{type:"qualifier2",hid:"pioneer"},{type:"qualifier2",hid:"profane"},{type:"qualifier2",hid:"sorcerer"},{type:"qualifier2",hid:"tormentor"},{type:"qualifier2",hid:"training"},{type:"qualifier2",hid:"twink"},{type:"qualifier2",hid:"tyrant"},{type:"qualifier2",hid:"upholder"},{type:"qualifier2",hid:"warfield_king"},{type:"qualifier2",hid:"warfield"},{type:"qualifier2",hid:"warrior"},{type:"qualifier2",hid:"wise"}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(1),a=n(29),i=n(73),s=n(30),u=n(72),c={uuid:"uu1~test~demo~armor~0001",element_type:r.ElementType.item,slot:r.InventorySlot.armor,base_hid:i.ARMOR_BASES[0].hid,qualifier1_hid:i.ARMOR_QUALIFIERS1[0].hid,qualifier2_hid:i.ARMOR_QUALIFIERS2[0].hid,quality:r.ItemQuality.uncommon,base_strength:s.BASE_STRENGTH_INTERVAL_BY_QUALITY[r.ItemQuality.uncommon][0]+1,enhancement_level:a.MIN_ENHANCEMENT_LEVEL};t.DEMO_ARMOR_1=c;const l={uuid:"uu1~test~demo~armor~0002",element_type:r.ElementType.item,slot:r.InventorySlot.armor,base_hid:i.ARMOR_BASES[1].hid,qualifier1_hid:i.ARMOR_QUALIFIERS1[1].hid,qualifier2_hid:i.ARMOR_QUALIFIERS2[1].hid,quality:r.ItemQuality.legendary,base_strength:s.BASE_STRENGTH_INTERVAL_BY_QUALITY[r.ItemQuality.legendary][1]-1,enhancement_level:a.MAX_ENHANCEMENT_LEVEL};t.DEMO_ARMOR_2=l,t.generate_random_demo_armor=function(e){return e=e||o.Random.engines.mt19937().autoSeed(),u.create(e,{enhancement_level:o.Random.integer(a.MIN_ENHANCEMENT_LEVEL,a.MAX_ENHANCEMENT_LEVEL)(e)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(30);t.compare_armors_by_potential=function(e,t){const n=r.get_ultimate_medium_damage_reduction(e),a=r.get_ultimate_medium_damage_reduction(t);return n!==a?a-n:o.compare_items_by_quality(e,t)||e.uuid.localeCompare(t.uuid)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1);t.InventorySlot=o.InventorySlot;const r=n(31),a=n(74),i=n(75),s=n(76);function u(e){return e.unslotted.sort(a.compare_items_by_slot_then_strength),e}function c(e,t){const n=e.unslotted.filter(e=>e.uuid!==t);if(n.length===e.unslotted.length)throw new Error(`state-inventory: can’t remove item #${t}, not found!`);return e.unslotted=n,e}t.create=function(e){return s.get_lib_SEC(e).xTry("rename",({enforce_immutability:e})=>e({schema_version:r.SCHEMA_VERSION,revision:0,unslotted_capacity:20,slotted:{},unslotted:[]}))},t.add_item=function(e,t){if(i.is_full(e))throw new Error("state-inventory: can’t add item, inventory is full!");return u(Object.assign({},e,{unslotted:[...e.unslotted,t],revision:e.revision+1}))},t.remove_item_from_unslotted=function(e,t){return c(Object.assign({},e,{revision:e.revision+1}),t)},t.equip_item=function(e,t){const n=e.unslotted.find(e=>e.uuid===t);if(!n)throw new Error(`state-inventory: can’t equip item #${t}, not found!`);const o=n.slot,r=i.get_item_in_slot(e,o);let a=Object.assign({},e,{slotted:Object.assign({},e.slotted,{[o]:n}),revision:e.revision+1});return a=c(a,n.uuid),r&&a.unslotted.push(r),u(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(31),a=n(76),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(50),r=n(77),a=[r.Currency.coin,r.Currency.token];function i(e){switch(e){case r.Currency.coin:case r.Currency.token:return`${e}_count`;default:throw new Error(`state-wallet: unrecognized currency: "${e}`)}}function s(e,t,n){let o=i(t);return Object.assign({},e,{[o]:e[o]+n,revision:e.revision+1})}function u(e,t){return e[i(t)]}t.ALL_CURRENCIES=a,t.create=function(){return{schema_version:o.SCHEMA_VERSION,revision:0,coin_count:0,token_count:0}},t.add_amount=function(e,t,n){if(n<=0)throw new Error("state-wallet: can’t add a <= 0 amount");return s(e,t,n)},t.remove_amount=function(e,t,n){if(n<=0)throw new Error("state-wallet: can’t remove a <= 0 amount");if(n>u(e,t))throw new Error("state-wallet: can’t remove more than available, no credit !");return s(e,t,-n)},t.get_currency_amount=u,t.iterables_currency=function*(e){yield*a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)).default({schema_version:1,revision:42,coin_count:23456,token_count:89});t.DEMO_STATE=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(50),a=n(152),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(50);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-wallet"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)).default({schema_version:2,revision:108,seed:1234,use_count:107,recently_encountered_by_id:{item:["axe","sword"],adventures:["dragon","king"],mistery:[]}});t.DEMO_STATE=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(32),a=987;t.DEFAULT_SEED=a,t.create=function(){return{schema_version:r.SCHEMA_VERSION,revision:0,seed:a,use_count:0,recently_encountered_by_id:{}}},t.set_seed=function(e,t){return Object.assign({},e,{seed:t,use_count:0,revision:e.revision+1})},t.update_use_count=function(e,t,n={}){const o=t.getUseCount();if(o<e.use_count)throw new Error(`${r.LIB}: update PRNG state: count is lower than previous count, this is unexpected! Check your code!`);if(!n.I_swear_I_really_cant_know_whether_the_rng_was_used&&o===e.use_count){const e=new Error(`[Warning] ${r.LIB}: update PRNG state: count hasn't changed = no random was generated! This is most likely a bug, check your code!`).stack;console.warn(e)}if(t!==i)throw new Error(`${r.LIB}: update PRNG state: internal error: passed prng is not the cached-singleton one!`);return Object.assign({},e,{use_count:o,revision:e.revision+1})},t.register_recently_used=function(e,t,n,o){if(0===o)return e;let r=e.recently_encountered_by_id[t]||[];return r=r.concat(n).slice(-o),Object.assign({},e,{recently_encountered_by_id:Object.assign({},e.recently_encountered_by_id,{[t]:r}),revision:e.revision+1})};let i=null,s=!1;function u(){(i=o.Random.engines.mt19937().seed(a))._seed=a,s=!1}t.xxx_internal_reset_prng_cache=u,u(),t.get_prng=function(e){let t=!1;if(i._seed!==e.seed&&(i.seed(e.seed),i._seed=e.seed,t=!0),i.getUseCount()!==e.use_count){if(0!==i.getUseCount())throw new Error(`${r.LIB}: get_prng(): unexpected case: cached implementation need to be fast forwarded!`);i.discard(e.use_count),t=!0}if(t){if(s)throw new Error(`${r.LIB}: get_prng(): unexpected case: need to update again the prng!`);s=!0}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(32);t.generate_random_seed=function(){const e=o.Random.engines.mt19937().autoSeed();return o.Random.integer(-2147483646,2147483647)(e)},t.regenerate_until_not_recently_encountered=function({id:e,generate:t,state:n,max_tries:o}){const a=n.recently_encountered_by_id[e]||[];o=o||Math.max(10,10*a.length);let i=t(),s=1;for(;a.includes(i)&&s<o;)i=t(),s++;if(s>=o)throw console.error(n),new Error(`${r.LIB}: regenerate_until_not_recently_encountered(): failed after maximum tries!`);return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(32),a=n(157),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(32);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-prng"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=o.default({schema_version:2,revision:0,max_energy:7,energy_refilling_rate_per_ms:{n:7,d:864e5}});t.DEMO_U_STATE=r;const a=o.default({schema_version:2,timestamp_ms:1545016005762,available_energy:{n:7,d:2}});t.DEMO_T_STATE=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(78)),r=n(5),a=n(33),i=n(160);t.get_available_energy_float=function(e){return e.timestamp_ms+a.TICK_MS<r.get_UTC_timestamp_ms()&&console.warn(`${a.LIB}.get_available_energy_float called on outdated state!`),new o.default(e.available_energy).floor(2).valueOf()},t.get_human_time_to_next=function(e,t){if(t.timestamp_ms+a.TICK_MS<r.get_UTC_timestamp_ms()&&console.warn(`${a.LIB}.get_available_energy_float called on outdated state!`),new o.default(t.available_energy).compare(e.max_energy)>=0)return"";const n=function(e){return new o.default(e.energy_refilling_rate_per_ms).mul(1e3)}(e),s=new o.default(t.available_energy).mod(1),u=new o.default(1).sub(s).div(n);return i.time_to_human(Math.ceil(u.valueOf()))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.time_to_human=function(e){let t=[];const n=e%60,o=(e-=n)/60%60,r=(e-=60*o)/3600;return r&&t.push(`${r}h`),o&&t.push(`${o}m`),n&&t.push(`${n}s`),t.join(" ")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(78)),r=n(5),a=n(33);function i([e,t],n=r.get_UTC_timestamp_ms()){const i=n-t.timestamp_ms;if(i<0)return console.warn("E.update_to_now: Time went backward. Daylight saving?"),t;if(i<a.TICK_MS)return t;let s=new o.default(t.available_energy);const u=new o.default(e.energy_refilling_rate_per_ms).mul(i);return(s=s.add(u)).compare(e.max_energy)>0&&(s=new o.default(e.max_energy)),Object.assign({},t,{timestamp_ms:t.timestamp_ms+i,available_energy:{n:s.n,d:s.d}})}t.create=function(){const e={schema_version:a.SCHEMA_VERSION,revision:0,max_energy:7,energy_refilling_rate_per_ms:{n:7,d:864e5}};return[e,{schema_version:a.SCHEMA_VERSION,timestamp_ms:r.get_UTC_timestamp_ms(new Date(0)),available_energy:{n:e.max_energy,d:1}}]},t.update_to_now=i,t.use_energy=function([e,t],n=1,s=r.get_UTC_timestamp_ms()){if(s<t.timestamp_ms)throw new Error(`${a.LIB}: time went backward! (cheating attempt?)`);t=i([e,t],s);const u=new o.default(t.available_energy).sub(n);if(u.s<0)throw new Error(`${a.LIB}: not enough energy left!`);return t=Object.assign({},t,{available_energy:{n:u.n,d:u.d}})},t.loose_all_energy=function([e,t],n=1,o=r.get_UTC_timestamp_ms()){return t=Object.assign({},t,{timestamp_ms:o,available_energy:{n:0,d:1}})},t.restore_energy=function([e,t],n=1,a=r.get_UTC_timestamp_ms()){t=i([e,t],a);let s=new o.default(t.available_energy).add(n);return s.compare(e.max_energy)>0&&(s=new o.default(e.max_energy)),t=Object.assign({},t,{available_energy:{n:s.n,d:s.d}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(33),a=n(163),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,[t,n],o={}){const i=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:i,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:a})=>{if(i>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let s=t,u=n;if(i<r.SCHEMA_VERSION){a.warn(`${r.LIB}: attempting to migrate schema from v${i} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{[s,u]=function(e,[t,n],o={}){throw new Error("Schema is too old (pre-beta), can’t migrate!")}(0,[t,n],o)}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}a.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return[s,u]})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(33);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-energy"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(51),a=o.default({schema_version:1,revision:42,queue:[{uid:42,engagement:{key:"hello_world--flow",type:r.EngagementType.flow},queue_time_root_revision:0,params:{}}]});t.DEMO_STATE=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(51);t.get_oldest_queued_flow=function(e){return e.queue.find(e=>e.engagement.type===o.EngagementType.flow)},t.get_oldest_queued_non_flow=function(e){return e.queue.find(e=>e.engagement.type!==o.EngagementType.flow)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(52),r=n(79);t.create=function(e){return r.get_lib_SEC(e).xTry("create",({enforce_immutability:e})=>e({schema_version:o.SCHEMA_VERSION,revision:0,queue:[]}))},t.enqueue=function(e,t,n={}){const o={uid:e.revision+1,engagement:t,params:n};return Object.assign({},e,{queue:[...e.queue,o],revision:e.revision+1})},t.acknowledge_seen=function(e,t){if(!e.queue.some(e=>e.uid===t))throw new Error(`Engagement: acknowledging a non-queued engagement "${t}"!`);return Object.assign({},e,{queue:e.queue.filter(e=>e.uid!==t),revision:e.revision+1})},t.acknowledge_all_seen=function(e){return e.queue.length?Object.assign({},e,{queue:[],revision:e.revision+1}):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(52),a=n(79),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)).default({schema_version:1,revision:3,redeemed_codes:{BORED:{redeem_count:1,last_redeem_date_minutes:"20181030_21h23"}}});t.DEMO_STATE=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(82),t),o.__exportStar(n(170),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(82),r=e=>0===e.length?e:e[0].toUpperCase()+e.slice(1),a=e=>e.toLowerCase(),i=e=>e.toUpperCase(),s=e=>e.trim(),u=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),c=/\s+/g,l=e=>e.replace(c," "),d=new RegExp("[-+()*/:? _]","g"),_=e=>e.replace(d," "),m=e=>e.split(" ").map(r).join(""),h=o.combine_normalizers(s,u,a,_,l,m),g=o.combine_normalizers(s,u,i,_,m),p={capitalize:r,to_lower_case:a,to_upper_case:i,trim:s,coerce_to_ascii:u,normalize_unicode:e=>e.normalize(),coerce_blanks_to_single_spaces:l,coerce_delimiters_to_space:_,convert_spaces_to_camel_case:m,coerce_to_safe_nickname:h,coerce_to_redeemable_code:g};t.NORMALIZERS=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5),r=n(34),a=n(80),i=n(83);t.create=function(e){return i.get_lib_SEC(e).xTry("create",({enforce_immutability:e})=>e({schema_version:r.SCHEMA_VERSION,revision:0,redeemed_codes:{}}))},t.attempt_to_redeem_code=function(e,t,n){return i.get_lib_SEC().xTry("redeem_code",({enforce_immutability:r})=>{if(!a.is_code_redeemable(e,t,n))throw new Error("This code is either non-existing or non redeemable at the moment!");const i=t.code,s=e.redeemed_codes[i]||{redeem_count:0,last_redeem_date_minutes:""};return r(Object.assign({},e,{redeemed_codes:Object.assign({},e.redeemed_codes,{[i]:Object.assign({},s,{redeem_count:s.redeem_count+1,last_redeem_date_minutes:o.get_human_readable_UTC_timestamp_minutes()})}),revision:e.revision+1}))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(34),a=n(83),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(53),a=o.default({schema_version:2,revision:42,wiki:null,flags:null,achievements:{TEST:r.AchievementStatus.unlocked,Summoned:r.AchievementStatus.unlocked,"Alpha player":r.AchievementStatus.unlocked,"Beta player":r.AchievementStatus.revealed,"I am bored":r.AchievementStatus.unlocked,"Turn it up to eleven":r.AchievementStatus.unlocked,"I am dead bored":r.AchievementStatus.revealed,"did I mention I was bored?":r.AchievementStatus.hidden,"king of boredom":r.AchievementStatus.hidden,"No-life except for boredom":r.AchievementStatus.hidden,"Hello darkness my old friend":r.AchievementStatus.hidden,"What’s in a name?":r.AchievementStatus.unlocked,Graduated:r.AchievementStatus.unlocked,"I am very bored":r.AchievementStatus.unlocked,"Sorry my hand slipped":r.AchievementStatus.unlocked,"Oops!... I Did It Again":r.AchievementStatus.unlocked,"I’m not that innocent":r.AchievementStatus.revealed,"It’s good to be bad":r.AchievementStatus.hidden},statistics:{last_visited_timestamp:"20180813",active_day_count:12,good_play_count:12,bad_play_count:3,encountered_adventures:{caravan_success:!0,dying_man:!0,ate_bacon:!0,ate_zombie:!0,refreshing_nap:!0,older:!0},encountered_monsters:{wolf:!0,"spreading adder":!0,"fur-bearing truit":!0},good_play_count_by_active_class:{novice:7,warrior:5},bad_play_count_by_active_class:{novice:2,warrior:1},fight_won_count:6,fight_lost_count:4,coins_gained:1234,tokens_gained:2,items_gained:3,has_account:!0,is_registered_alpha_player:!1}});t.DEMO_STATE=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(53);t.get_last_known_achievement_status=function(e,t){return e.achievements[t]},t.is_achievement_already_unlocked=function(e,t){return!!e.achievements.hasOwnProperty(t)&&e.achievements[t]===o.AchievementStatus.unlocked}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5),r=n(54),a=n(84);function i(e,t){const n=Object.assign({},e,{statistics:Object.assign({},e.statistics,{last_visited_timestamp:o.get_human_readable_UTC_timestamp_days()}),revision:t+1});return e.statistics.last_visited_timestamp!==n.statistics.last_visited_timestamp?(n.statistics.active_day_count=(n.statistics.active_day_count||0)+1,n):e}t.create=function(e){return a.get_lib_SEC(e).xTry("create",({enforce_immutability:e})=>e({schema_version:r.SCHEMA_VERSION,revision:0,wiki:null,flags:null,achievements:{},statistics:{last_visited_timestamp:o.get_human_readable_UTC_timestamp_days(),active_day_count:1,good_play_count:0,bad_play_count:0,encountered_adventures:{},encountered_monsters:{},good_play_count_by_active_class:{},bad_play_count_by_active_class:{},fight_won_count:0,fight_lost_count:0,coins_gained:0,tokens_gained:0,items_gained:0,has_account:!1,is_registered_alpha_player:!1}}))},t.on_played=function(e,t){const{good:n,adventure_key:o,encountered_monster_key:r,active_class:a,coins_gained:s,tokens_gained:u,items_gained:c}=t,l=Object.assign({},e,{statistics:Object.assign({},e.statistics),revision:e.revision+1});let d=l.statistics;return d.encountered_adventures[o]||(d.encountered_adventures=Object.assign({},d.encountered_adventures,{[o]:!0})),n?(d.good_play_count++,d.good_play_count_by_active_class=Object.assign({[a]:0},d.good_play_count_by_active_class),d.good_play_count_by_active_class[a]++,o.startsWith("fight_won_")?d.fight_won_count++:o.startsWith("fight_lost_")&&d.fight_lost_count++):(d.bad_play_count++,d.bad_play_count_by_active_class=Object.assign({[a]:0},d.bad_play_count_by_active_class),d.bad_play_count_by_active_class[a]++),r&&!d.encountered_monsters[r]&&(d.encountered_monsters=Object.assign({},d.encountered_monsters,{[r]:!0})),d.coins_gained+=s,d.tokens_gained+=u,d.items_gained+=c,i(l,e.revision)},t.on_achieved=function(e,t,n){return i(Object.assign({},e,{achievements:Object.assign({},e.achievements,{[t]:n}),revision:e.revision+1}),e.revision)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(54),a=n(84),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){return Object.assign({},t,{schema_version:2,achievements:t.achievements||{}})}(0,t)}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)).default({schema_version:2,revision:5,is_web_diversity_supporter:!0,is_logged_in:!0,roles:["tbrpg:alpha"]});t.DEMO_STATE=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(55);t.create=function(){return{schema_version:o.SCHEMA_VERSION,revision:0,is_web_diversity_supporter:!1,is_logged_in:!1,roles:[]}},t.on_start_session=function(e,t){return e.is_web_diversity_supporter===t?e:Object.assign({},e,{is_web_diversity_supporter:t,revision:e.revision+1})},t.on_logged_in_refresh=function(e,t,n=[]){return Object.assign({},e,{is_logged_in:t,roles:n,revision:e.revision+1})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importDefault(n(3)),r=n(55),a=n(180),i=o.default({});t.MIGRATION_HINTS_FOR_TESTS=i,t.migrate_to_latest=function(e,t,n={}){const o=t&&t.schema_version||0;return(e=a.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:r.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:n})=>{if(o>r.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let a=t;if(o<r.SCHEMA_VERSION){n.warn(`${r.LIB}: attempting to migrate schema from v${o} to v${r.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{a=function(e,t,n){throw new Error("Schema is too old (pre-beta), can’t migrate!")}()}catch(t){throw e.fireAnalyticsEvent("schema_migration.failed"),t}n.info(`${r.LIB}: schema migration successful.`),e.fireAnalyticsEvent("schema_migration.ended")}return a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(10),r=n(1),a=n(55);t.get_lib_SEC=function(e){return r.decorate_SEC((e||o.getRootSEC()).createChild().setLogicalStack({module:a.LIB}).setAnalyticsAndErrorDetails({sub_product:"state-meta"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(182),r=Object.keys(o.UNICODE_CHARS).map(e=>o.UNICODE_CHARS[e]).filter(e=>e.taxonomy.includes("monster")).map(e=>({name:e.properties.description,emoji:e.char})),a=[].concat(...r,{name:"drop bear",emoji:"🐨"},{name:"dahu",emoji:"🐐"},{name:"hoop snake",emoji:"🐍"},{name:"joint snake",emoji:"🐍"},{name:"spreading adder",emoji:"🐍"},{name:"fur-bearing truit",emoji:"🐡"},{name:"splintercat",emoji:"🐡"});t.ENTRIES=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(183);t.UNICODE_CHARS=o.CHARACTERS},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CHARACTERS={"01f400":{code_point:128e3,char:"🐀",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"rat"}},"01f401":{code_point:128001,char:"🐁",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"mouse"}},"01f402":{code_point:128002,char:"🐂",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"ox"}},"01f403":{code_point:128003,char:"🐃",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"water buffalo"}},"01f404":{code_point:128004,char:"🐄",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"cow"}},"01f405":{code_point:128005,char:"🐅",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"tiger"}},"01f406":{code_point:128006,char:"🐆",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"leopard"}},"01f407":{code_point:128007,char:"🐇",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"rabbit"}},"01f408":{code_point:128008,char:"🐈",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"cat"}},"01f409":{code_point:128009,char:"🐉",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"dragon"}},"01f40a":{code_point:128010,char:"🐊",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"crocodile"}},"01f40b":{code_point:128011,char:"🐋",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"whale"}},"01f40c":{code_point:128012,char:"🐌",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"snail"}},"01f40d":{code_point:128013,char:"🐍",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"snake"}},"01f40e":{code_point:128014,char:"🐎",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"horse"}},"01f40f":{code_point:128015,char:"🐏",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"ram"}},"01f410":{code_point:128016,char:"🐐",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"goat"}},"01f411":{code_point:128017,char:"🐑",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"ewe"}},"01f412":{code_point:128018,char:"🐒",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"monkey"}},"01f413":{code_point:128019,char:"🐓",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"chicken"}},"01f414":{code_point:128020,char:"🐔",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"chicken head"}},"01f415":{code_point:128021,char:"🐕",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"dog"}},"01f416":{code_point:128022,char:"🐖",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"pig"}},"01f417":{code_point:128023,char:"🐗",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"boar"}},"01f418":{code_point:128024,char:"🐘",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"elephant"}},"01f419":{code_point:128025,char:"🐙",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"octopus"}},"01f41a":{code_point:128026,char:"🐚",taxonomy:["animal","living"],tags:["emoji","full"],properties:{description:"spiral shell"}},"01f41b":{code_point:128027,char:"🐛",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"caterpillar"}},"01f41c":{code_point:128028,char:"🐜",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"ant"}},"01f41d":{code_point:128029,char:"🐝",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"bee"}},"01f41e":{code_point:128030,char:"🐞",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"lady beetle"}},"01f41f":{code_point:128031,char:"🐟",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"fish"}},"01f420":{code_point:128032,char:"🐠",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"tropical fish"}},"01f421":{code_point:128033,char:"🐡",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"blowfish"}},"01f422":{code_point:128034,char:"🐢",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"turtle"}},"01f423":{code_point:128035,char:"🐣",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"hatching chick"}},"01f424":{code_point:128036,char:"🐤",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"baby chick"}},"01f425":{code_point:128037,char:"🐥",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"baby chick"}},"01f426":{code_point:128038,char:"🐦",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"pigeon"}},"01f427":{code_point:128039,char:"🐧",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"penguin"}},"01f428":{code_point:128040,char:"🐨",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"koala"}},"01f429":{code_point:128041,char:"🐩",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"poodle"}},"01f42a":{code_point:128042,char:"🐪",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"dromedary"}},"01f42b":{code_point:128043,char:"🐫",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"camel"}},"01f42c":{code_point:128044,char:"🐬",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"dolphin"}},"01f42d":{code_point:128045,char:"🐭",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"mouse"}},"01f42e":{code_point:128046,char:"🐮",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"cow"}},"01f42f":{code_point:128047,char:"🐯",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"tiger"}},"01f430":{code_point:128048,char:"🐰",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"rabbit"}},"01f431":{code_point:128049,char:"🐱",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"cat"}},"01f432":{code_point:128050,char:"🐲",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"dragon"}},"01f433":{code_point:128051,char:"🐳",taxonomy:["animal","living"],tags:["emoji","full"],properties:{description:"spouting whale"}},"01f434":{code_point:128052,char:"🐴",taxonomy:["animal","living"],tags:["emoji"],properties:{description:"horse"}},"01f435":{code_point:128053,char:"🐵",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"monkey"}},"01f436":{code_point:128054,char:"🐶",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"dog"}},"01f437":{code_point:128055,char:"🐷",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"pig"}},"01f438":{code_point:128056,char:"🐸",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"frog"}},"01f439":{code_point:128057,char:"🐹",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"hamster"}},"01f43a":{code_point:128058,char:"🐺",taxonomy:["animal","living","monster"],tags:["emoji"],properties:{description:"wolf"}},"01f43b":{code_point:128059,char:"🐻",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"bear"}},"01f43c":{code_point:128060,char:"🐼",taxonomy:["animal","living","monster","face"],tags:["emoji","face"],properties:{description:"panda"}},"01f43d":{code_point:128061,char:"🐽",taxonomy:[],tags:["emoji"],properties:{description:"???"}},"01f43e":{code_point:128062,char:"🐾",taxonomy:[],tags:["emoji"],properties:{description:"???"}},"01f43f":{code_point:128063,char:"🐿",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"chipmunk"}},"01f5ff":{code_point:128511,char:"🗿",taxonomy:["monster"],tags:["emoji"],properties:{description:"golem"}},"01f47b":{code_point:128123,char:"👻",taxonomy:["monster"],tags:["emoji"],properties:{description:"ghost"}},"01f54a":{code_point:128330,char:"🕊",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"dove"}},"01f577":{code_point:128375,char:"🕷",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"spider"}},"01f980":{code_point:129408,char:"🦀",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"crab"}},"01f981":{code_point:129409,char:"🦁",taxonomy:["animal","living"],tags:["emoji","face"],properties:{description:"lion"}},"01f982":{code_point:129410,char:"🦂",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"scorpion"}},"01f983":{code_point:129411,char:"🦃",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"turkey"}},"01f984":{code_point:129412,char:"🦄",taxonomy:["animal","living","monster"],tags:["emoji"],properties:{description:"unicorn"}},"01f985":{code_point:129413,char:"🦅",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"eagle"}},"01f986":{code_point:129414,char:"🦆",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"duck"}},"01f987":{code_point:129415,char:"🦇",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"bat"}},"01f988":{code_point:129416,char:"🦈",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"shark"}},"01f989":{code_point:129417,char:"🦉",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"owl"}},"01f98a":{code_point:129418,char:"🦊",taxonomy:["animal","living","monster"],tags:["emoji","face"],properties:{description:"fox"}},"01f98b":{code_point:129419,char:"🦋",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"butterfly"}},"01f98c":{code_point:129420,char:"🦌",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"deer"}},"01f98d":{code_point:129421,char:"🦍",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"gorilla"}},"01f98e":{code_point:129422,char:"🦎",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"lizard"}},"01f98f":{code_point:129423,char:"🦏",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"rhinoceros"}},"01f990":{code_point:129424,char:"🦐",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"shrimp"}},"01f991":{code_point:129425,char:"🦑",taxonomy:["animal","living","monster"],tags:["emoji","full"],properties:{description:"squid"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),r=n(86),a={name:"chicken",level:7,rank:n(56).MonsterRank.elite,possible_emoji:"🐓"};t.DEMO_MONSTER_01=a,t.generate_random_demo_monster=function(){const e=o.Random.engines.mt19937().autoSeed();return r.create(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(13),a=n(11),i=1;function s(e,t){return Math.round(r.get_ultimate_medium_damage_reduction(e)*i)}const u=1;function c(e,t){return Math.round(a.get_ultimate_medium_damage(e)*u)}t.appraise_power=function(e,t=!0){switch(e.slot){case o.InventorySlot.armor:return s(e);case o.InventorySlot.weapon:return c(e);default:throw new Error(`appraise_power(): no appraisal scheme for slot "${e.slot}" !`)}},t.appraise_power_normalized=function(e,t=!0){switch(e.slot){case o.InventorySlot.armor:return s(e)/r.ATTACK_VS_DEFENSE_RATIO;case o.InventorySlot.weapon:return c(e);default:throw new Error(`appraise_power_normalized(): no appraisal scheme for slot "${e.slot}" !`)}};const l=1;const d=1.5;const _=.25;t.appraise_sell_value=function(e){switch(e.slot){case o.InventorySlot.armor:return Math.max(1,Math.round((n=e,r.get_ultimate_medium_damage_reduction(n)*l*_)));case o.InventorySlot.weapon:return Math.max(1,Math.round((t=e,a.get_ultimate_medium_damage(t)*d*_)));default:throw new Error(`appraise_value(): no appraisal scheme for slot "${e.slot}" !`)}var t,n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(6);function r(e){}t.create=r,t.generate_random_demo_shop=function(){o.Random.engines.mt19937().autoSeed()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(188),r=n(88),a=r.AdventureType.story,i=r.AdventureType.fight,s=[{good:!1,type:a,hid:"bad_1",outcome:{}},{good:!1,type:a,hid:"bad_2",outcome:{}},{good:!1,type:a,hid:"bad_3",outcome:{}},{good:!1,type:a,hid:"bad_4",outcome:{}},{good:!1,type:a,hid:"bad_5",outcome:{}},{good:!1,type:a,hid:"bad_6",outcome:{}},{good:!0,type:i,hid:"fight_won_coins",outcome:{coin:"small"}},{good:!0,type:i,hid:"fight_won_loot",outcome:{armor_or_weapon:!0}},{good:!0,type:i,hid:"fight_won_any",outcome:{random_attribute:!0}},{good:!0,type:i,hid:"fight_observe",outcome:{class_secondary_attribute:!0}},{good:!0,type:i,hid:"fight_lost_any",outcome:{random_attribute:!0}},{good:!0,type:i,hid:"fight_lost_shortcoming",outcome:{lowest_attribute:!0}},{good:!0,type:a,hid:"bored_log",outcome:{strength:!0}},{good:!0,type:a,hid:"caravan_success",outcome:{coin:"small"}},{good:!0,type:a,hid:"dying_man",outcome:{coin:"medium"}},{good:!0,type:a,hid:"ate_bacon",outcome:{level:!0}},{good:!0,type:a,hid:"ate_zombie",outcome:{mana:!0}},{good:!0,type:a,hid:"refreshing_nap",outcome:{health:!0}},{good:!0,type:a,hid:"older",outcome:{level:!0}},{good:!0,type:a,hid:"stare_cup",outcome:{mana:!0}},{good:!0,type:a,hid:"nuclear_fusion_paper",outcome:{wisdom:!0}},{good:!0,type:a,hid:"found_green_mushroom",outcome:{level:!0}},{good:!0,type:a,hid:"found_red_mushroom",outcome:{health:!0}},{good:!0,type:a,hid:"found_blue_mushroom",outcome:{mana:!0}},{good:!0,type:a,hid:"found_white_mushroom",outcome:{strength:!0}},{good:!0,type:a,hid:"found_yellow_mushroom",outcome:{agility:!0}},{good:!0,type:a,hid:"found_orange_mushroom",outcome:{charisma:!0}},{good:!0,type:a,hid:"found_black_mushroom",outcome:{wisdom:!0}},{good:!0,type:a,hid:"found_rainbow_mushroom",outcome:{luck:!0}},{good:!0,type:a,hid:"meet_old_wizard",outcome:{wisdom:!0}},{good:!0,type:a,hid:"good_necromancer",outcome:{agility:!0}},{good:!0,type:a,hid:"talk_to_all_villagers",outcome:{charisma:!0}},{good:!0,type:a,hid:"always_keep_potions",outcome:{health:!0}},{good:!0,type:a,hid:"lost",outcome:{health:!0}},{good:!0,type:a,hid:"fate_sword",outcome:{coin:"small"}},{good:!0,type:a,hid:"grinding",outcome:{level:!0}},{good:!0,type:a,hid:"so_many_potions",outcome:{strength:!0}},{good:!0,type:a,hid:"rematch",outcome:{level:!0}},{good:!0,type:a,hid:"useless",outcome:{wisdom:!0}},{good:!0,type:a,hid:"escort",outcome:{health:!0}},{good:!0,type:a,hid:"rare_goods_seller",outcome:{armor_or_weapon:!0}},{good:!0,type:a,hid:"progress_loop",outcome:{armor_or_weapon:!0}},{good:!0,type:a,hid:"idiot_bandits",outcome:{coin:"medium"}},{good:!0,type:a,hid:"princess",outcome:{coin:"medium",armor_or_weapon_improvement:!0}},{good:!0,type:a,hid:"bad_village",outcome:{mana:!0}},{good:!0,type:a,hid:"mana_mana",outcome:{mana:!0}},{good:!0,type:a,hid:"treasure_in_pots",outcome:{coin:"small"}},{good:!0,type:a,hid:"chicken_slayer",outcome:{strength:!0}},{good:!0,type:a,hid:"sentients_killing",outcome:{coin:"small",class_primary_attribute:!0}},{good:!0,type:a,hid:"keep_watch",outcome:{coin:"small"}},{good:!0,type:a,hid:"critters",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"class_grimoire",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"village_farmwork",outcome:{coin:"small",strength:!0}},{good:!0,type:a,hid:"village_lost_kid",outcome:{armor_or_weapon:!0}},{good:!0,type:a,hid:"village_lost_father",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"village_nice_daughter",outcome:{charisma:!0}},{good:!0,type:a,hid:"capital_castle",outcome:{wisdom:!0}},{good:!0,type:a,hid:"capital_royal_road",outcome:{armor_or_weapon_improvement:!0}},{good:!0,type:a,hid:"capital_royal_amusement_park",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"famous_stone_ruby",outcome:{token:1,charisma:!0}},{good:!0,type:a,hid:"famous_stone_diamond",outcome:{token:1,wisdom:!0}},{good:!0,type:a,hid:"famous_stone_sapphire",outcome:{token:1,mana:!0}},{good:!0,type:a,hid:"famous_stone_emerald",outcome:{token:1,agility:!0}},{good:!0,type:a,hid:"class_master_primary_attr_1",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"class_master_primary_attr_2",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"class_master_second_attr",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"class_master_sharpest_weapon",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"class_master_forbidden_knowledge",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"class_master_dark_holocron",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"class_master_coolidge",outcome:{level:!0}},{good:!0,type:a,hid:"class_master_half_battle",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"church_book",outcome:{mana:!0}},{good:!0,type:a,hid:"arrow_in_the_knee",outcome:{wisdom:!0}},{good:!0,type:a,hid:"square_eggs",outcome:{luck:!0}},{good:!0,type:a,hid:"colossal_cave",outcome:{armor_or_weapon:!0,class_primary_attribute:!0}},{good:!0,type:a,hid:"huge_tower",outcome:{armor_or_weapon:!0,class_primary_attribute:!0}},{good:!0,type:a,hid:"make_friends",outcome:{mana:!0}},{good:!0,type:a,hid:"wise_wisewood_tree",outcome:{wisdom:!0}},{good:!0,type:a,hid:"lost_mine",outcome:{token:1}},{good:!0,type:a,hid:"gehennom",outcome:{coin:"medium",armor_or_weapon:!0}},{good:!0,type:a,hid:"vampire_castle",outcome:{coin:"medium",armor_or_weapon:!0}},{good:!0,type:a,hid:"foodie_friend",outcome:{health:!0}},{good:!0,type:a,hid:"erika",outcome:{mana:!0}},{good:!0,type:a,hid:"rachel",outcome:{strength:!0}},{good:!0,type:a,hid:"walk_in_mordor",outcome:{agility:!0}},{good:!0,type:a,hid:"jig",outcome:{agility:!0}},{good:!0,type:a,hid:"good_end",outcome:{wisdom:!0}},{good:!0,type:a,hid:"waterfall",outcome:{health:!0}},{good:!0,type:a,hid:"meteor",outcome:{luck:!0}},{good:!0,type:a,hid:"weird_duck",outcome:{coin:"huge"}},{good:!0,type:a,hid:"last_quest",outcome:{level:!0}},{good:!0,type:a,hid:"busking",outcome:{token:1}},{good:!0,type:a,hid:"best_meal",outcome:{health:!0}},{good:!0,type:a,hid:"witch_riddle",outcome:{wisdom:!0}},{good:!0,type:a,hid:"princess_castle",outcome:{luck:!0}},{good:!0,type:a,hid:"foreign_language",outcome:{charisma:!0}},{good:!0,type:a,hid:"last_night",outcome:{luck:!0}},{good:!0,type:a,hid:"chasm_leap",outcome:{agility:!0}},{good:!0,type:a,hid:"coffee",outcome:{wisdom:!0}},{good:!0,type:a,hid:"gold_nugget",outcome:{coin:"medium"}},{good:!0,type:a,hid:"high_level_zone_1",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"high_level_zone_2",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"sword_in_rock",outcome:{weapon:!0}},{good:!0,type:a,hid:"sword_in_a_lake",outcome:{weapon:!0}},{good:!0,type:a,hid:"side_quests",outcome:{coin:"medium"}},{good:!0,type:a,hid:"balrog",outcome:{level:!0}},{good:!0,type:a,hid:"castle_summon",outcome:{weapon:!0}},{good:!0,type:a,hid:"murderer",outcome:{luck:!0}},{good:!0,type:a,hid:"unmatched_set",outcome:{coin:"big"}},{good:!0,type:a,hid:"village_gifts_blacksmith",outcome:{armor:!0}},{good:!0,type:a,hid:"village_strongman",outcome:{strength:!0}},{good:!0,type:a,hid:"meteor_metal",outcome:{armor_or_weapon_improvement:!0}},{good:!0,type:a,hid:"caravan_failure",outcome:{coin:"medium",armor_or_weapon:!0}},{good:!0,type:a,hid:"riddle_of_steel",outcome:{armor_or_weapon_improvement:!0}},{good:!0,type:a,hid:"give_a_shield",outcome:{armor:!0}},{good:!0,type:a,hid:"king_reward",outcome:{armor_or_weapon:!0,token:1}},{good:!0,type:a,hid:"chilies",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"bards",outcome:{charisma:!0}},{good:!0,type:a,hid:"raining_elves",outcome:{mana:!0}},{good:!0,type:a,hid:"raining_dwarves",outcome:{strength:!0}},{good:!0,type:a,hid:"need_for_speed",outcome:{agility:!0}},{good:!0,type:a,hid:"drown_in_holy_water",outcome:{mana:!0}},{good:!0,type:a,hid:"rings_of_power",outcome:{charisma:!0}},{good:!0,type:a,hid:"ribert",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"milk",outcome:{health:!0}},{good:!0,type:a,hid:"clover",outcome:{luck:!0}},{good:!0,type:a,hid:"horseshoe",outcome:{luck:!0}},{good:!0,type:a,hid:"rabbit_foot",outcome:{luck:!0}},{good:!0,type:a,hid:"magic_lamp",outcome:{luck:!0}},{good:!0,type:a,hid:"rabbit_hole",outcome:{wisdom:!0}},{good:!0,type:a,hid:"cat_out_tree",outcome:{agility:!0}},{good:!0,type:a,hid:"green_food",outcome:{health:!0}},{good:!0,type:a,hid:"conscripted",outcome:{coin:"small"}},{good:!0,type:a,hid:"duke_rescue",outcome:{coin:"medium"}},{good:!0,type:a,hid:"demon_king",outcome:{weapon:!0}},{good:!0,type:a,hid:"false_lake",outcome:{coin:"medium",armor_or_weapon:!0}},{good:!0,type:a,hid:"soul_weapon_pet_zombie",outcome:{health:!0}},{good:!0,type:a,hid:"elementals",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"fabric_of_reality",outcome:{mana:!0}},{good:!0,type:a,hid:"save_world_again",outcome:{charisma:!0,coin:"big",armor_or_weapon:!0}},{good:!0,type:a,hid:"clean_wizard_tower",outcome:{mana:!0}},{good:!0,type:a,hid:"explore_ruins",outcome:{coin:"medium",armor_or_weapon:!0}},{good:!0,type:a,hid:"inspect_sewers",outcome:{class_secondary_attribute:!0,coin:"medium"}},{good:!0,type:a,hid:"explore_catacombs",outcome:{coin:"medium",armor_or_weapon:!0}},{good:!0,type:a,hid:"bandits_punishment",outcome:{coin:"medium"}},{good:!0,type:a,hid:"magical_cooking_ragnaros",outcome:{strength:!0}},{good:!0,type:a,hid:"church_cellar_prisoner",outcome:{class_secondary_attribute:!0}},{good:!0,type:a,hid:"colossal_cave_maze",outcome:{armor_or_weapon:!0}},{good:!0,type:a,hid:"exile_GIFTS",outcome:{weapon_improvement:!0}},{good:!0,type:a,hid:"DQ_good_slime",outcome:{class_primary_attribute:!0}},{good:!0,type:a,hid:"pet_squirrel",outcome:{agility:!0}},{good:!0,type:a,hid:"pet_black_cat",outcome:{luck:!0}},{good:!0,type:a,hid:"pet_rainbow_lorikeet",outcome:{charisma:!0}},{good:!0,type:a,hid:"pet_red_eyed_unicorn",outcome:{mana:!0}},{good:!0,type:a,hid:"pet_badger_mushrooms",outcome:{strength:!0}},{good:!0,type:a,hid:"dragon_kebab",outcome:{charisma:!0}},{good:!0,type:a,hid:"found_random_mushroom",outcome:{charisma:!0}},{good:!0,type:a,hid:"elven_hydromel",outcome:{health:!0}},{good:!0,type:a,hid:"found_vermilion_potion",outcome:{charisma:!0}},{good:!0,type:a,hid:"found_silver_potion",outcome:{agility:!0}},{good:!0,type:a,hid:"found_swirling_potion",outcome:{strength:!0}},{good:!0,type:a,hid:"found_fizzing_potion",outcome:{strength:!0}},{good:!0,type:a,hid:"found_bubbly_potion",outcome:{luck:!0}},{good:!0,type:a,hid:"found_worn_out_potion",outcome:{agility:!0}},{good:!0,type:a,hid:"random_blessing",outcome:{strength:!0}},{good:!0,type:a,hid:"found_journal",outcome:{agility:!0}},{good:!0,type:a,hid:"cookies_grandmas",outcome:{agility:!0}},{good:!0,type:a,hid:"guild_party_food",outcome:{luck:!0}}];t.ENTRIES=s;const u={en:o.messages};t.i18n_messages=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o={bad_1:"🚫  You clicked too early!\nYou collapse from exhaustion 😵 , you loose all your energy⚡ !",bad_2:"🚫  You clicked too early!\nYou burn out 😵 , you loose all your energy⚡ !",bad_3:"🚫  You clicked too early!\nYou fall asleep and get eaten by a dragon 🐲 !\nyou loose all your energy💀 !",bad_4:"🚫  You clicked too early!\nYou are drowsy during a critical fight and get eaten by a monster 🦖 !\nyou loose all your energy☠ !",bad_5:"🚫  You clicked too early!\nYou fall asleep and get sucked dry by a vampire 🧛‍♀️ !\nyou loose all your energy⚰ !",bad_6:"🚫  You clicked too early!\nYou fall asleep and get eaten by wolves 🐺 🐺 🐺 !\nyou loose all your energy💀 !"},r={fight_won_coins:"\nYou have defeated a {{encounter}} !{{br}}\nYou loot {{coin}} from its corpse.",fight_won_loot:"\nYou have defeated a {{encounter}} !{{br}}\nYou loot a {{item}} from its corpse.",fight_won_any:"\nYou have defeated a {{encounter}}!{{br}}\nYou perfected your {{attr_name}} during the fight: +{{attr}} {{attr_name}}!",fight_observe:"\nYou encounter a wild {{encounter}} from afar!{{br}}\nFascinated, you observe it instead of attacking it.{{br}}\nIts behaviour makes you think of new techniques. You gain +{{attr}} {{attr_name}}!",fight_lost_any:"\nYou were attacked and nearly killed by a {{encounter}} but you got away just before it was too late.{{br}}\nYou figured out techniques to flee more efficiently: +{{attr}} {{attr_name}}!",fight_lost_shortcoming:"\nYou were attacked by a {{encounter}} and it didn’t end well... but you got away just before it was about to kill you.{{br}}\nYou reflect on your lack of {{attr_name}} in the fight and train hard: +{{attr}} {{attr_name}}!"},a={bored_log:"\nYou are so bored, you punch a log for hours!\nYou gain +{{strength}} strength!",caravan_success:"\nYou were hired to protect a caravan of merchants.\nYour presence repels them, the caravan arrives at its destination, you gain {{coin}}!",dying_man:"\nA dying man on the street left you everything he had.\nYou gain {{coin}}!",ate_bacon:"\nYou eat some delicious crispy bacon.\nYou gain +{{level}} level!",ate_zombie:"\nYou eat a zombie!\nYou gain +{{mana}} mana!",refreshing_nap:"\nYou take a nap and feel refreshed.\nYou gain +{{health}} health!",older:"\nYou feel a little older.\nYou just gained +{{level}} level!",stare_cup:"\nYou stare really hard at a cup, and it almost moves!\nYou gain +{{mana}} mana!",nuclear_fusion_paper:"\nYou write a paper on nuclear fusion.\nYou gain +{{wisdom}} wisdom!",found_green_mushroom:"\nYou find a green mushroom.\nYou gain +{{level}} level!",walk_in_mordor:"You simply walk into Mordor. You gain +{{agility}} agility.",jig:"You see a guy doing a jig, and join him! +{{agility}} agility!",good_end:"Oh, THAT end is the one you hit them with! +{{wisdom}} wisdom!",waterfall:"You sit under a pounding waterfall. +{{health}} vitality!",meteor:"A meteor JUST misses you! +{{luck}} luck!",weird_duck:"Some weird duck is trying to swim in coins, so you take them! +{{coin}} coins!",last_quest:"That last quest gave you just enough XP! Level Up!",busking:"You wail on a guitar next to the inn, and it pays off! +{{token}} token!",best_meal:"You eat the best meal you’ve ever had! +{{health}} health!",witch_riddle:"You successfully solve a riddle from a witch. You gain +{{wisdom}} wisdom!",princess_castle:"The princess was actually in this castle! +{{luck}} luck!",foreign_language:"You learn a foreign language. +{{charisma}} charisma!",last_night:"...what happened last night? +{{luck}} luck!",chasm_leap:"You successfully leap over a chasm! +{{agility}} agility!",coffee:"You drink a cup of coffee. +{{wisdom}} wisdom!",gold_nugget:"You trip on a gold nugget: +{{coin}} gold!",magic_lamp:"You stumble upon a magic lamp! You gain +{{luck}} luck!",rabbit_hole:"You find out just how deep the rabbit hole goes. You gain +{{wisdom}} wisdom.",cat_out_tree:"You help a little girl get her cat out a tree. You gain +{{agility}} agility!",green_food:"You somehow survive eating green eggs and ham. You gain +{{health}} health!",conscripted:"You are conscripted into the army, you gain +{{coin}} coins.",duke_rescue:"You rescued a duke, you are rewarded +{{coin}} coins!"},i={found_red_mushroom:"\nYou find a red mushroom and eat it.\nYou gained +{{health}} health!",found_blue_mushroom:"\nYou find a blue mushroom and eat it.\nYou gained +{{mana}} mana!",found_white_mushroom:"\nYou find a white mushroom and eat it.\nYou gained +{{strength}} strength!",found_yellow_mushroom:"\nYou find a yellow mushroom and eat it.\nYou gained +{{agility}} agility!",found_orange_mushroom:"\nYou find an orange mushroom and eat it.\nYou gained +{{charisma}} charisma!",found_black_mushroom:"\nYou find a black mushroom and eat it.\nYou gained +{{wisdom}} wisdom!",found_rainbow_mushroom:"\nYou find a glowing rainbow mushroom and eat it.\nYou gained +{{luck}} luck!",found_random_mushroom:"\nYou find a golden mushroom and eat it.\nYou gained +{{attr}} {{attr_name}}!"},s={demon_king:"\nYou swear to defeat the demon king!{{br}}\nThe local hero pledges you his sword... and leaves you with it!{{br}}\nWell, it’s loot: {{item}}",false_lake:'\nA hand holding a sword emerges from the lake:\n"take this blade and become the new king!"\nAs you reach out, the lake monster emerges and try to devour you: it’s a trap!{{br}}\nYou defeat it and find good loot from previous victims: {{item}}, +{{coin}} coin.\n\t',soul_weapon_pet_zombie:"\nYou attach a soul to your weapon (+1 enhancement) and keep the soul owner’s body as a pet zombie.{{br}}\nThe pet zombie’s aura increases your regeneration: +{{health}} heath!\n\t",class_master_sharpest_weapon:'\nYou ask your master: "What is the best weapon?".\nShe answers: "The most lethal weapon is your mind!".{{br}}\nYou’re not convinced, so you train instead of meditating.\nYou gain +{{attr}} {{attr_name}}!\n\t',good_necromancer:"\nYou meet a child weeping over his dead hamster… Thanks to necromancy, you reanimate it as a hamster-zombie!\nOddly, the child cries even more while running away.{{br}}\nFortunately, you gain +{{agility}} agility while avoiding the stones thrown by the villagers.",talk_to_all_villagers:"\nYou spoke to everyone in the village leaving no quest unanswered!{{br}}\nAlthough your head aches from discussing so much.\n+{{charisma}} charisma having met so many people!",fate_sword:'\nTo thank you for saving his wife and his children, a farmer offers you "Destiny",\nthe heirloom sword passed down in his family for generations.{{br}}\n30 minutes later, the merchant buys it off you for only {{coin}}… some heirloom!',rematch:"\nYou got beaten by a goblin!\nIn shame, you roam around the country, accepting quest after quest to train yourself before facing him again.{{br}}\nAlas, he also trained and beats you again!\nWell, the +{{level}} level is still useful…",useless:"\nArriving at the village, the mayor announces that the neighborhood is no longer dangerous.\nThe sorceress fell in love and no longer curses people.\nThe haunted cemetery was a pet cemetery, villagers are happy to have their companions back.\nThe giant is helping the farmers with their harvest.{{br}}\nYou feel useless and reflect on your place in the world. +{{wisdom}} wisdom!",escort:"\nYou are escorting an important NPC.\nFrustratingly, if you walk, he’s faster than you.\nHowever, if you run, you’re faster than him!\nBy strafing and running in circles, you manage\nto stay close to him.{{br}}\n+{{health}} health thanks to your efforts!",rare_goods_seller:"\nYou come across an old man with eccentric apparel.\nScore! It’s a rare item seller!\nHe gives you a good price for a {{item}}.",progress_loop:"\nYou would need better gear to level up.\nBut you’d need to level up to get better gear.\nCruel dilemma!{{br}}\nFortunately, you find a {{item}} at the bottom of a well!",idiot_bandits:"\nYour name is whispered across the land since you slayed the dragon and defeated the sorceress.\nBandits ambush you, aiming for your wealth. For their folly!\nThey realize their mistake one moment\nbefore your fireball incinerates them.\nFortunately, gold doesn’t burn: +{{coin}}!",princess:'\n"You won’t take back the princess!" yells the fearsome black mage,\nas you reach his throne room.\nYou reassure him: you are only here for loot.{{br}}\nHe lets you help yourself to {{coin}}\nand even enchants your weapon too!',bad_village:"\nYou reach a new village. There is no weapon shop.\nNo potion shop either! And no quests at the inn!!\nWhat a useless village. At your call, lightning and meteors wipe out this place.\nA good opportunity to practice your magic: +{{mana}} mana.",so_many_potions:"\nThe fight against the final boss was hard, very hard…\nMost importantly, +{{strength}} strength for managing to control a pressing urge during the encounter after drinking 25 health potions !",high_level_zone_1:"\nYou accidentally wander into a high level zone.\nUnexpectedly, this challenges your limits and proves to be a good training: +{{attr}} {{attr_name}}!\n\t",high_level_zone_2:"\nYou accidentally wander into a high level zone.\nYou quickly and horribly die after fleeing monsters for half an hour.\nWhat did you expect?{{br}}\nYou go back to training and gain +{{attr}} {{attr_name}}.\n\t",side_quests:"\n\tYou get distracted by side quests again!\nHopefully the loot ({{coin}} coins) and preparation (equipment enhanced) will help in the final battle!\n\t",balrog:"You tell your party members to run then kill the balrog and get all the XP. You level up!",castle_summon:'\nYou are summoned to the castle by the king.\nIn the throne room, in front of the court, he pressures you:{{br}}\n"Hero, you must defeat the demon lord to bring back peace in the land!\nTake this magical sword, only with it can you defeat the evil ones!".{{br}}\nWell, a new weapon is always welcome: {{weapon}}!\n\t',unmatched_set:"\nYou loot a powerful piece of armor but unfortunately its appearance doesn’t match with your existing ones...\nNo way, style is important for a hero! You sell this piece of armor for coin: +{{coin}} coin!"},u={bards:"\nBards start writing songs about you.\nThis fame helps you when dealing with humans.\nYou gain +{{charisma}} charisma!\n",elementals:"\nYou free some elementals. They reward you with a blessing suited to your class.\nYou gain {{attr}} {{attr_name}}!",fabric_of_reality:"\nYou battle mages to unravel the fabric of reality.\nYou gain +{{mana}} mana!",save_world_again:"\nYou saved the world. Again. You are famous: +{{charisma}} charisma!{{br}}\nBut honestly, you and me know you are doing it only for the loot ;)\nIndeed you gain a {{item}} and {{coin}} coins!",clean_wizard_tower:"\nYou clean a mad wizard’s tower.{{br}}\nYou learn some of her magic: +{{mana}} mana!",explore_ruins:"\nYou explore some ruins of an ancient civilisation the world.{{br}}\nYou find a {{item}} and worth {{coin}} of coins!",inspect_sewers:"\nYou inspect the city’s sewers and clean the vermin.{{br}}\nYou find worth {{coin}} of coins and polish your skills: +{{attr}} {{attr_name}}!",explore_catacombs:"\nYou explore the city’s old catacombs and put the undeads to rest.{{br}}\nYou find a {{item}} and worth {{coin}} of coins!",bandits_punishment:"\nYou are attacked by bandits: They are in need of some punishment!.{{br}}\nYou promptly dispense it and loot {{coin}} coins from them."},c={xxx_save_village_no_money:'\n"Please hero, save our village! We have no money but you are our only hope!"\n\t',xxx_odd_boy:'\n"A small child asks you to help him find his lost kitty.\nAs you and the child search the forest you find his pet,\nbeast\n\t',magical_cooking_ragnaros:"\nYou try magical cooking but end up summoning a tiny Ragnaros in your frying pan!{{br}}\nYou keep this avatar as a pet. His aura gives you +{{strength}} strength!\n\t",xxx_fancy_arrows:"\n\tYou \n\t",xxx_guarding_dungeon:"\nYou are so effective at raiding his dungeon\nthat the dark necromancer offers you gold to guard it instead.\nYou would be using your experience to keep other adventurers from looting it!\n\t",wise_wisewood_tree:'\nYou meet the Wise Wisewood Tree:\n"I am the Wise Wisewood Tree and I possess uncanny wisdom".\nIndeed, the talking tree impart you some: +{{wisdom}} wisdom.\n\t\t',murderer:"\nYou are accused of murder and the guards try to arrest you! You refuse, they insist and you kill them all.\nNobody is after you anymore, that was an effective way to prove your innocence!{{br}}\nYou gain +{{luck}} luck!\n\t"},l={give_a_shield:'\nThe captain of the assieged castle yells: "Give this hero a shield!"{{br}}\nThe blacksmith obey: you receive a {{item}}!\n',cookies_grandmas:"\nA group of strange grandmas bake you cookies.\nThey are incredibly good and make you crave for more!\nThey have a magical effect: you gain +{{attr}} {{attr_name}}!\n\t",treasure_in_pots:"\nYou enter a pottery shop and destroy every jug, vase and item in the store.\nYou collect +{{coin}} in coin, precious stones and other treasures found!",chicken_slayer:"\nYou enter a village and see a chicken roaming in a garden peacefully. \nYou slay the chicken mercilessly.\nThe entire cohort of guards for the town come after you and you are forced to slay them too.\nAfter hours of fighting you gain +{{strength}} strength!",arrow_in_the_knee:"\nA guard tells you stories of when he was an adventurer,\nbefore he took an arrow in the knee.\nYou feel enlightened: +{{wisdom}} wisdom!\n\t\t",sentients_killing:"\nYou introduce yourself to the captain of the guard. Your mission: kill 10 kobolds.\nAfter a brief hesitation on the ethics of the extermination of thinking creatures, you accept: you need loot and XP too badly.\nYou gain {{coin}} and +{{attr}} {{attr_name}}.\n\t\t",colossal_cave:"\nYou discover and explore a colossal cave! Undeads, goblins...\nYou emerge victoriously, with loot ({{item}}) and experience (+{{attr}} {{attr_name}})!\n\t\t",colossal_cave_maze:"\nYou explore yet another cave.\nYou are in a maze of twisty little passages, all alike.\nYou find a {{item}} on the ground and manage to find an exit after a while.\n",gehennom:"\nYou enter the dark Cavities of Gehennom. You don’t find the Amulet of Yendor,\nbut still ends up with good loot: +{{coin}}, {{item}}...\n\t\t",exile_GIFTS:'\nYou meet a tribe of Giant, Intelligent, Friendly, Talking Spiders.\nThey’re shy and all respond to the name "Spider".{{br}}\nYou buy poison from them and coat your weapon with it, providing a good enhancement!\n\t',DQ_good_slime:"The slime speaks to you: «I’m not a bad slime, you know?»{{br}}\nWhat a stupid statement: obviously slimes are monsters! You slaughter it and many others.{{br}}\nThis training earns you +{{attr}} {{attr_name}}!"},d={drown_in_holy_water:"\nYou nearly drown yourself in holy water. You gain +{{mana}} mana!\n\t",rings_of_power:"\nYou forge rings and give them to you dwarven, elven and human allies.\nThey now like you a bit more: +{{charisma}} charisma!\n\t",raining_elves:"\nIt’s raining... elves?{{br}}\nYou gain +{{mana}} mana!",raining_dwarves:"\nIt’s raining... dwarves?{{br}}\nYou gain +{{strength}} strength!",need_for_speed:"\nYou feel the need…{{br}}\n…the need for speed!{{br}}\n+{{agility}} agility!\n",xxx_goblin_slayer:'\n"The only good goblins are the one who never come out of their stinking holes!"\n\t',riddle_of_steel:"\nYou solve the riddle of steel; Obviously it’s more steel! And stronger steel!{{br}}\nYou have a blacksmith reforge your equipment to enhance it.",sword_in_rock:"\nYou find a sword planted into a stone.\nYou draw it out: {{item}}.{{br}}\nPeople nearby start worshipping you!\n",sword_in_a_lake:"\nYou find a good sword at the bottom of a lake: {{item}}.{{br}}\nWho could have thrown it there?\nNevermind, it’s good loot!\n",lost_mine:"\nYou discover a mysterious lost mine, filled with strange tools\nand glowing with mana crystals. You pick some: +{{token}}.\n\t\t",vampire_castle:"\nLost in the Dark Forest at night, you come across a gloomy castle.\nThe owner welcomes you politely, but you spot his teeth fangs. A vampire!\nAfter an intense battle, you earned the castle and its riches!{{br}}\n+{{coin}} and a {{item}}\n\t\t",mana_mana:'\n"Mah na mah na" "To to to do do"{{br}}\n+{{mana}} mana!',square_eggs:"\nDeep in the jungle, you find the marvelous square eggs of the legendary fatu-liva bird!\nYou cook an omelette, and gain +{{luck}} luck.\n\t\t"},_={foodie_friend:"\nYou meet with your foodie friend.\nHe convinces you to try the latest magic treats.\nYou gain extra energy (+{{health}} health) and a bit of weight!\n\t",chilies:"\nAt the adventuring guild party, you pickup a treat.\nTurns out it’s made of magic chilies and you can’t feel your face anymore!\nOnce the pain is gone (one day later!) you feel better than ever, you gained +{{attr}} {{attr_name}}!\n\t",caravan_failure:"\nYou were hired to protect a caravan of merchants.\nThe bandits and monsters aren’t impressed, they keep harassing the caravan until no one is left alive except you.\nYou nevertheless gain some loot and gold from the remains of both the caravan and the attackers: +{{coin}} coin and a {{item}}!",meet_old_wizard:"\nYou meet a mysterious old wizard…\nBefore giving you the quest, he tells you his loooong story: You gain +{{wisdom}} wisdom!",always_keep_potions:'\nBeing a seasoned adventurer, you kept a health potion "just in case":\nWell done, your health is top-notch!',lost:"\nWith all those quests, you forgot where you had to go…{{br}}\nBut circling around the map is good for your health: +{{health}} health!",grinding:"\nFor lack of a better thing to do, you grind for hours and hours…\nSo what? It’s an RPG, what did you expect?\nBut it pays off: +{{level}} level!",keep_watch:"\nYou are hired to keep the watch. Boring, but lives are depending on you!\nThe night pass without any trouble.\nYou gain {{coin}} as agreed. Good job!\n\t\t",critters:"\nYou hunt critters to get XP and improve your skills.\nAfter one hour of farming, +{{attr}} {{attr_name}}, not bad!\n\t\t",class_grimoire:"\nYou find a tome about your class.\nIt’s filled with interesting stuff!\nIt’s worth reading: +{{attr}} {{attr_name}}!\n\t\t",village_farmwork:"\nThe villagers hire you to do their errands.\nYou gather firewood, draw water from the well, chase pests.\nYou gain {{coin}} as agreed, +{{strength}} strength as a bonus and hopefully gain the people’s trust for better quests in the future!\n\t\t",village_lost_kid:'\nA villager runs after you "Please find my kid lost in the forest! I heard about goblins and fear the worst!".{{br}}\nYou arrive just as the goblins were about to put the kid in the cauldron.\nYou deal justice to these pests, drink their soup and bring back the kid.{{br}}\nThe parent is delighted and you looted a {{item}} in the goblin camp.\n\t\t',village_lost_father:'\nA child from the village runs after you "Please, find my father who isn’t back from the forest!".\nYou track the father to a clearing, where he took refuge in a tree, surrounded by wolves.\nYou sow death amongst the pack using your adventurer’s arts and bring back the father home.\nYou practiced your {{attr_name}} during this encounter: +{{attr}} {{attr_name}}!\nAnd the child now wants to be an adventurer...\n\t\t',village_nice_daughter:"\nThe daughter of one of the villager you helped wants to have a tea with her saviour.\nShe’s very nice. You learn from her how to have a polite conversation: + {{charisma}} charisma.\n\t\t",village_gifts_blacksmith:'\nYou helped the village so much that the inhabitants are giving you parting gifts.\n"You can’t travel without protection" say the blacksmith. He makes you an armor: {{armor}}!\n',village_strongman:'\nYou spar with the village’s strongman. His methods are crude but practical and effective.\n"You gain +{{strength}} strength!\n',capital_castle:"\nYou arrive at the Royal Castle, one of the famous landmark of the capital.\nIt’s incredible: huge, strong yet delicate, with high towers and ornaments everywhere...\nYou ponder about civilizations: +{{wisdom}} wisdom.\n\t\t",capital_royal_road:"\nYou visit the Royal Road, one of the famous landmark of the capital.\nIt’s a wide road filled with stalls with goods from the best gatherers and the best crafters.\nYou barter for a much needed equipment enhancement.\n\t\t",capital_royal_amusement_park:"\nYou visit the Royal Amusement Park, one of the famous landmark of the capital.\nYou try all the magical attractions and have a second round of your favorite ones.\nThis is a curious but effective training: +{{attr}} {{attr_name}}!\n\t\t",famous_stone_ruby:"\nIn a lost city, you looted the famous lost striped candy-pink ruby!\nYour fame increases: +{{charisma}} charisma, +{{token}}.\n\t\t",famous_stone_diamond:"\nIn a meteor crater, you looted an incredible rare black diamond!\nYour wisdom increases: +{{wisdom}} wisdom, +{{token}}.\n\t\t",famous_stone_sapphire:"\nIn a secret cave below the ocean, you looted the forgotten sapphire of Atlantis!\nYour mana increases: +{{mana}} mana, +{{token}}.\n\t\t",famous_stone_emerald:"\nOn a lost altar deep in the jungle, you looted the mysterious emerald of Shapeshifting!\nYour agility increases: +{{agility}} agility, +{{token}}.\n\t\t",class_master_primary_attr_1:'\nYour class master is playing wise:\n"You need to work on your {{attr_name}}, it’s the basis of everything! Focus on your strengths, not your weaknesses!"\nShe gives you exercises. You gain +{{attr}} {{attr_name}}.\n\t\t',class_master_primary_attr_2:'\nYour class master is playing wise again:\n"The successful warrior is the average man, with laser-like focus! Concentrate on improving your {{attr_name}}!"\nShe gives you exercises. You gain +{{attr}} {{attr_name}}.\n\t\t',class_master_second_attr:'\nAs usual, your class master is grumpy:\n"What’s the use of improving only your main attribute? You need to improve your {{attr_name}} too! Focus on your weaknesses, to become stronger!"\nShe gives you exercises. You gain +{{attr}} {{attr_name}}.\n\t\t',class_master_forbidden_knowledge:"\nYou feel that your class master is not teaching you everything.\nYou sneak into her room and read her forbidden scrolls.\nYou gain +{{attr}} {{attr_name}}!\n\t\t",class_master_dark_holocron:'\nYou feel that your class master is not teaching you everything.\nYou sneak into her room and find the holocron of a dead evil master.\nHe happily teaches you in exchange of some "services". You gain +{{attr}} {{attr_name}}!\n\t\t',class_master_coolidge:'\nYour class master implores you to meditate:\n"Persistence and determination win over talent, genius and skills!"{{br}}\nPersistence? Determination? She must be talking about levelling: You gain +{{level}} {{level}}!\n\t\t',class_master_half_battle:'\nYour class master tries to instill some common sense:\n"Knowing is half the battle!"{{br}}\nShe must means you need more experience. You spar against other classes and gain +{{attr}} {{attr_name}}!\n\t\t',church_book:"\nYou visit a church for healing and end up reading their magic books.\nYou gain +{{mana}} mana!\n\t\t",church_cellar_prisoner:"\nYou visit a church for healing and check their cellar.\nBehind a secret door, a chained prisoner offers you power in exchange of his freedom.\nYou gain +{{attr}} {{attr_name}}!\n\t\t",huge_tower:"\nYou discover and explore a huge tower. It’s filled with mad wizards, cultists and golems.\nYou reach the top and snatch some loot ({{item}}) then exit the tower,\nvictorious and more experienced (+{{attr}} {{attr_name}})!\n\t\t",make_friends:'\nYou learnt necromancy (+{{mana}} mana). With your new skills, you assemble some living corpses from remains dug in the cemetery.{{br}}\nYour mom would be proud, she was always telling you to go and "make" friends!\n\t\t',milk:"\nYou drink a lot of milk! Your bones strengthen and your health increases!\nYou gain +{{health}} health.\n\t",clover:"You find a four-leaf clover. You gain +{{luck}} luck.",horseshoe:"You find a horseshoe. You gain +{{luck}} luck.",rabbit_foot:"\nYou kill a rabbit, eat it and keep one of its foot as a good luck charm.\nYou gain +{{luck}} luck.",erika:"\nExploring the Colossal Cave, you meet Erika, a powerful sorceress\nwhose sensitive skin led her to live underground.\nShe teaches you a new spell for money: +{{mana}} mana\n\t\t",rachel:"\nBetween two villages, you meet Rachel the washer wench.\nShe competes with you in arm twisting, and win!\nGood exercise, +{{strength}} strength.\n\t\t",ribert:"\nYou meet Ribert, the head of the royal guards.{{br}}\nHe is a seasoned warrior and agrees to spar with you.{{br}}\nGood fighting exercise, you gain +{{attr}} {{attr_name}}.\n\t\t",meteor_metal:"\nA meteorite falls near your position. You rush to the crater and gather the star metal.\nYou then pay a blacksmith to coat your equipment with it.\nNice enhancement!\n\t",king_reward:"\nYou did well to help the kingdom.\nKing Gallus welcomes you again in the throne room in front of all the court assembled.\nYou are rewarded with weapons and honors: {{item}}, {{token}}...\n",pet_squirrel:"\nHaving spent so much time in the forest, you befriend and tame a squirrel.\nYou keep it as a pet.\nIts aura gives you +{{agility}} agility!\n\t",pet_black_cat:"\nYou befriend and tame a black cat.\nHe now follows you as a pet.\nIts aura gives you +{{luck}} luck!\n\t",pet_rainbow_lorikeet:"\nIn the paradise island, you befriend and tame a rainbow lorikeet.\nIt now stays on your shoulder, that’s quite a sight!\nThis makes you popular: +{{charisma}} charisma!\n\t",pet_red_eyed_unicorn:"\nYou encounter a red eyed unicorn throwing fire from her mouth.\nIt seems evil and acknowledges you.{{br}}\nYou just won yourself an epic mount! And its aura gives you +{{mana}} mana!\n\t",pet_badger_mushrooms:'\nYou dance and sing "badger badger mushrooms mushrooms"{{br}}\nYou must have eaten the wrong mushroom.{{br}}\nYou wake up with a pet badger. Its aura gives you +{{strength}} strength!\n'},m={dragon_kebab:"\nYou have the chance to taste the legendary dragon meat kebab!\nThrough this magical food, you gain +{{attr}} {{attr_name}}!\n\t",elven_hydromel:"\nYou have the chance to taste the legendary elven hydromel!\nThrough this magical drink, you gain +{{attr}} {{attr_name}}!\n\t",random_blessing:"\nYou helped a village. The village’s elder grant you a blessing.\nShe is very old and you are not very sure she knows what she’s doing…\nYou find that you gained +{{attr}} {{attr_name}}!\n\t",guild_party_food:"\nAt an adventuring guild party, you are drunk and pick something unidentified to eat.{{br}}\nOnce you wake up (one day later!) you discover that you strangely gained +{{attr}} {{attr_name}}!\n\t",found_vermilion_potion:"\nYou find a vermilion potion.\nCrazy drink, gained +{{attr}} {{attr_name}}!",found_silver_potion:"\nYou find a silver potion.\nSweet drink, gained +{{attr}} {{attr_name}}!",found_swirling_potion:"\nYou find a swirling potion.\nStrange drink, gained +{{attr}} {{attr_name}}!",found_fizzing_potion:"\nYou find a fizzing potion.\nSparkling drink, gained +{{attr}} {{attr_name}}!",found_bubbly_potion:"\nYou find a bubbly potion.\nSoft drink, gained +{{attr}} {{attr_name}}!",found_worn_out_potion:"\nYou find an old potion with an unreadable label.\nYou try your luck and drink it.\nYou gain +{{attr}} {{attr_name}}!",found_journal:"\nYou find the remains of an unlucky adventurer. She or he (you can’t tell from the remains) kept a journal.\nYou read it and learn from their failure: +{{attr}} {{attr_name}}!"},h={adventures:Object.assign({},o,r,a,i,s,u,c,l,d,_,m)},g={adventures:{}};t.messages=g,Object.keys(h.adventures).filter(e=>!e.startsWith("xxx")).forEach(e=>{g.adventures[e]=function(e){return e.split("\n").map(e=>e.trim()).filter(e=>!!e).join(" ")}(h.adventures[e])})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importStar(n(90));t.get_recap=function(e){return 0===e.revision?o.inline_fragment().pushText("You are an ").pushStrong("otherworlder").pushText(", an adventurer from another world…{{br}}").pushText("Congratulations, you were chosen to enter the unknown realm of ").pushStrong("Jaema").pushText("!{{br}}").pushText("Maybe were you just more courageous, cunning and curious than your peers?{{br}}").pushText("But for now, let’s go on an adventure, for glory ⚔ and loot 📦 💰 !").done():o.block_fragment().pushText("You are ").pushInlineFragment(e.avatar.name,{id:"name",classes:["avatar__name"]}).pushText(", the ").pushInlineFragment(e.avatar.klass,{id:"class",classes:["avatar__class"]}).pushText(" from another world.{{br}}").pushText("You are adventuring in the mysterious world of ").pushStrong("Jaema").pushText("…{{br}}").pushStrong("For glory ⚔  and loot 📦 💰 !").done()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(25),r="                                                                                                ";function a(e){return console.groupCollapsed||console.group?"":r.slice(0,2*e)}t.DEFAULT_OPTIONS={};const i=(console.groupCollapsed||console.group||console.log).bind(console),s=(console.groupEnd||console.log).bind(console),u={on_root_enter:()=>{i("⟩ [on_root_enter]")},on_root_exit:({state:e})=>(console.log("⟨ [on_root_exit]"),console.log(`  [state="${e}"]`),s(),e),on_node_enter:({$node:e,$id:t,depth:n})=>{i(a(n)+`⟩ [on_node_enter] #${t}/`+function(e){const{$type:t,$content:n}=e;return`${t}."${n}"`}(e));return console.log(a(n)+'  [state=""] (init)'),""},on_node_exit:({$node:e,$id:t,state:n,depth:o})=>(console.log(a(o)+`⟨ [on_node_exit] #${t}`),console.log(a(o)+`  [state="${n}"]`),s(),n),on_concatenate_str:({str:e,state:t,$node:n,depth:o})=>(console.log(a(o)+`+ [on_concatenate_str] "${e}"`),t+=e,console.log(a(o)+`  [state="${t}"]`),t),on_concatenate_sub_node:({state:e,sub_state:t,depth:n,$id:o,$parent_node:r})=>(console.log(a(n)+`+ [on_concatenate_sub_node] "${t}"`),e+=t,console.log(a(n)+`  [state="${e}"]`),e),on_filter:({$filter:e,$filters:t,state:n,$node:o,depth:r})=>(console.log(a(r)+`  [on_filter] "${e}`),n),on_class_before:({$class:e,state:t,$node:n,depth:o})=>(console.log(a(o)+`  [⟩on_class_before] .${e}`),t),on_class_after:({$class:e,state:t,$node:n,depth:o})=>(console.log(a(o)+`  [⟨on_class_after] .${e}`),t),on_type:({$type:e,state:t,$node:n,depth:o})=>(console.log(a(o)+`  [on_type] "${e}" ${n.$classes}`),t),on_type_br:({state:e,depth:t})=>(console.log(a(t)+"  [on_type_br]"),e+"\\\\br\\\\"),on_type_hr:({state:e,depth:t})=>(console.log(a(t)+"  [on_type_hr]"),e+"--hr--")};t.callbacks=u,t.to_debug=function(e,n=t.DEFAULT_OPTIONS){return o.walk(e,u,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(40),r=n(41);t.normalize_node=function(e){const{$v:t=1,$type:n=r.NodeType.inline_fragment,$classes:a=[],$content:i="",$sub:s={},$hints:u={}}=e;if(t!==o.SCHEMA_VERSION)throw new Error(`${o.LIB}: unknown schema version "${t}"!`);return{$v:t,$type:n,$classes:a,$content:i,$sub:s,$hints:u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(25);t.DEFAULT_OPTIONS={};const r={on_node_enter:()=>({actions:[]}),on_concatenate_str:({state:e,str:t})=>e,on_concatenate_sub_node:({state:e,sub_state:t,$node:n,$id:o,$parent_node:r})=>(e.actions=e.actions.concat(...t.actions),e),on_type:({$type:e,state:t,$node:n,depth:o})=>(n.$hints.href&&t.actions.push({$node:n,type:"link",data:n.$hints.href}),t)};t.callbacks=r,t.to_actions=function(e,n=t.DEFAULT_OPTIONS){return o.walk(e,r,n).actions}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(40),r=n(25),a=n(58);t.DEFAULT_OPTIONS={style:"advanced"};const i=Object.freeze({sub_nodes:[],starts_with_block:!1,ends_with_block:!1,margin_top:0,margin_bottom:0,str:""}),s={on_node_enter:()=>Object.assign({},i,{sub_nodes:[]}),on_concatenate_str:({state:e,str:t})=>(e.ends_with_block&&(e.str+="".padStart(e.margin_bottom+1,"\n"),e.ends_with_block=!1,e.margin_bottom=0),e.str+=t,e),on_concatenate_sub_node:({state:e,sub_state:t,$node:n,$id:o,$parent_node:r},{style:a})=>{let i=t.str,s=t.starts_with_block;switch(e.sub_nodes.push(n),r.$type){case"ul":s=!0,i=(()=>"none"===r.$hints.bullets_style&&"advanced"===a?"":"- ")()+i;break;case"ol":s=!0,i=(()=>"markdown"===a?`${o}. `:`${(" "+o).slice(-2)}. `)()+i}return 0===e.str.length?t.starts_with_block&&(e.starts_with_block=!0,e.margin_top=Math.max(e.margin_top,t.margin_top)):(e.ends_with_block||s)&&(e.str+="".padStart(Math.max(e.margin_bottom,t.margin_top)+1,"\n")),e.str+=i,e.ends_with_block=t.ends_with_block,e},on_node_exit:({state:e,$node:t,depth:n},{style:r})=>{switch(t.$type){case"br":e.ends_with_block=!0}if("markdown"===r){switch(t.$type){case"heading":e.str=`### ${e.str}`,e.margin_top=Math.max(e.margin_top,1),e.margin_bottom=Math.max(e.margin_bottom,1);break;case"strong":e.str=`**${e.str}**`;break;case"weak":break;case"em":e.str=`_${e.str}_`;break;case"hr":e.str="---"}a.is_link(t)&&(e.str=`[${e.str}](${t.$hints.href})`)}else{switch(t.$type){case"heading":e.margin_top=Math.max(e.margin_top,1);break;case"hr":e.str="------------------------------------------------------------"}if("advanced"===r&&a.is_KVP_list(t)){const t=[];let n=0,o=0;e.sub_nodes.forEach(e=>{const r=e.$sub.content,a=r.$sub.key,i=r.$sub.value,s=u(a),c=u(i);n=Math.max(n,s.length),o=Math.max(o,c.length),t.push([s,c])}),e.str=t.map(([e,t])=>e.padEnd(n+1,".")+t.padStart(o+1,".")).join("\n")}}return"block"===o.NODE_TYPE_TO_DISPLAY_MODE[t.$type]&&(e.starts_with_block=!0,e.ends_with_block=!0),e}};function u(e,n=t.DEFAULT_OPTIONS,o={}){return r.walk(e,Object.assign({},s,o),n).str}t.callbacks=s,t.to_text=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(25),r=n(58),a="\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t";function i(e){return a.slice(0,e)}t.DEFAULT_OPTIONS={};const s={[o.NodeType.weak]:"span",[o.NodeType.heading]:"h3",[o.NodeType.inline_fragment]:"span",[o.NodeType.block_fragment]:"div"},u={on_node_enter:()=>({sub_nodes:[],str:""}),on_concatenate_str:({state:e,str:t})=>(e.str+=t,e),on_concatenate_sub_node:({$node:e,state:t,sub_state:n})=>(t.sub_nodes.push(e),t.str=t.str+n.str,t),on_node_exit:({state:e,$node:t,depth:n})=>{const{$type:o,$classes:a,$sub:u,$hints:c}=t,l=Object.keys(u).length;if("br"===o)return e.str="<br/>\n",e;if("hr"===o)return e.str="\n<hr/>\n",e;let d="",_=!1;const m=[...a];switch(o){case"strong":case"em":_=!0;break;case"weak":m.push("o⋄color⁚secondary"),_=!0;break;case"inline_fragment":_=!0}_||(d+="\n"+i(n));const h=s[o]||o;if(r.is_list(t)){switch(m.push("o⋄rich-text⋄list"),c.bullets_style){case"none":m.push("o⋄rich-text⋄list--no-bullet")}r.is_uuid_list(t)&&m.push("o⋄rich-text⋄list--interactive"),r.is_KVP_list(t)&&(m.push("o⋄rich-text⋄list--no-bullet"),console.warn("rich_text_to_html TODO KVP"))}return d+=`<${h}`,m.length&&(d+=` class="${m.join(" ")}"`),d+=">"+e.str+(l?"\n"+i(n):"")+`</${h}>`,r.is_link(t)&&(d=`<a href="${c.href}" target="_blank">${d}</a>`),c.uuid&&(d=`<button class="o⋄button--inline o⋄rich-text⋄interactive" ${c.uuid}">${d}</button>`),e.str=d,e}};t.callbacks=u,t.to_html=function(e,n=t.DEFAULT_OPTIONS){return'<div class="o⋄rich-text">\n\t'+o.walk(e,u,n).str+"\n</div>\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(40),r=n(41);function a(e){const t={$v:o.SCHEMA_VERSION,$type:e,$classes:[],$content:"",$sub:{},$hints:{}},n={addClass:function(...e){return t.$classes.push(...e),n},addHints:function(e){return t.$hints=Object.assign({},t.$hints,e),n},pushText:function(e){return t.$content+=e,n},pushRawNode:m,pushNode:h,pushInlineFragment:function(e,t){return _(i(),e,t)},pushBlockFragment:function(e,t){return _(s(),e,t)},pushStrong:function(e,t){return _(c(),e,t)},pushWeak:function(e,t){return _(l(),e,t)},pushHeading:function(e,t){return _(u(),e,t)},pushHorizontalRule:function(){return t.$content+="{{hr}}",n},pushLineBreak:function(){return t.$content+="{{br}}",n},pushKeyValue:function(e,n,a={}){if(t.$type!==r.NodeType.ol&&t.$type!==r.NodeType.ul)throw new Error(`${o.LIB}: Key/value is intended to be used in a ol/ul only!`);a=Object.assign({classes:[]},a);const i=d(e,n).addClass(...a.classes).done();return delete a.classes,m(i,a)},done:function(){return t}};let a=0;function _(e,t,n={}){n=Object.assign({classes:[]},n);const o=e.pushText(t).addClass(...n.classes).done();return delete n.classes,h(o,n)}function m(e,o={}){const r=o.id||("000"+ ++a).slice(-4);return t.$sub[r]=e,o.classes&&t.$classes.push(...o.classes),n}function h(e,n={}){const o=n.id||("000"+ ++a).slice(-4);return t.$content+=`{{${o}}}`,m(e,Object.assign({},n,{id:o}))}return n}function i(){return a(r.NodeType.inline_fragment)}function s(){return a(r.NodeType.block_fragment)}function u(){return a(r.NodeType.heading)}function c(){return a(r.NodeType.strong)}function l(){return a(r.NodeType.weak)}function d(e,t){const n="string"==typeof e?i().pushText(e).done():e,o="string"==typeof t?i().pushText(t).done():t;return i().pushNode(n,{id:"key"}).pushText(": ").pushNode(o,{id:"value"})}t.NodeType=r.NodeType,t.create=a,t.inline_fragment=i,t.block_fragment=s,t.heading=u,t.strong=c,t.weak=l,t.ordered_list=function(){return a(r.NodeType.ol)},t.unordered_list=function(){return a(r.NodeType.ul)},t.key_value=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importStar(n(90)),r=n(89);t.get_engagement_message=function(e){const{engagement:{key:t},params:n}=e;switch(t){case r.EngagementKey["just-some-text"]:return o.block_fragment().pushText(n.text).done();case r.EngagementKey["hello_world--flow"]:case r.EngagementKey["hello_world--aside"]:case r.EngagementKey["hello_world--warning"]:return o.block_fragment().pushText("[TEST] Hello, ").pushInlineFragment(n.name||"world",{id:"name"}).pushText("!").done();case r.EngagementKey["tip--first_play"]:return o.block_fragment().pushStrong("Tip: ").pushText("Select ").pushStrong("play").pushText(" to start adventuring!").done();case r.EngagementKey["code_redemption--failed"]:return o.block_fragment().pushStrong("Error: This code is either non-existing or non redeemable at the moment.").done();case r.EngagementKey["code_redemption--succeeded"]:return o.block_fragment().pushWeak("Code successfully redeemed.").done();case r.EngagementKey["achievement-unlocked"]:return o.block_fragment().pushStrong("🏆 Achievement unlocked:").pushLineBreak().pushText(`“${n.icon} ${n.name}“`).done();case r.EngagementKey.reborn:return o.block_fragment().pushStrong("You got reborn").pushLineBreak().pushText("Sorry, I changed the data format 😰.").done();default:throw new Error(`Missing engagement message for "${t}"! (not implemented?)`)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(14);t.get_available_energy_float=function(e){return o.get_available_energy_float(e.energy)},t.get_human_time_to_next_energy=function({u_state:e,t_state:t}){return o.get_human_time_to_next(e.energy,t.energy)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=n(8),a=n(36),i=n(8);function s(e,t){return i.get_item_in_slot(e.inventory,t)}t.appraise_item_value=function(e,t){const n=i.get_item(e.inventory,t);if(!n)throw new Error("appraise_item_value(): No item!");return a.appraise_sell_value(n)},t.appraise_item_power=function(e,t){const n=i.get_item(e.inventory,t);if(!n)throw new Error("appraise_item_power(): No item!");return a.appraise_power(n)},t.is_inventory_full=function(e){return r.is_full(e.inventory)},t.get_item_in_slot=s,t.get_item=function(e,t){return i.get_item(e.inventory,t)},t.find_better_unequipped_armor=function(e){const t=function(e){const t=e.inventory.unslotted.find(e=>e.slot===o.InventorySlot.armor);return t||null}(e);return t&&a.appraise_power(t)>a.appraise_power(s(e,o.InventorySlot.armor))?t:null},t.find_better_unequipped_weapon=function(e){const t=function(e){const t=e.inventory.unslotted.find(e=>e.slot===o.InventorySlot.weapon);return t||null}(e);return t&&a.appraise_power(t)>a.appraise_power(s(e,o.InventorySlot.weapon))?t:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.has_account=function(e){return!1},t.is_alpha=function(){return!0},t.is_player_since_alpha=function(e){return!0},t.is_registered_alpha_player=function(e){return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(2),a=n(7),i=n(1),s=n(36),u=n(8),c=n(12),l=n(18),d=n(57);t.appraise_player_power=function(e){let t=1;return i.ITEM_SLOTS.forEach(n=>{const o=u.get_item_in_slot(e.inventory,n);o&&(t+=s.appraise_power(o))}),t},t.find_element=function(e,t){let n=null;try{n=d.get_achievement_snapshot_by_uuid(e,t)}catch(e){}return n||u.get_item(e.inventory,t)},t.get_oldest_pending_flow_engagement=function(e){const t=c.get_oldest_queued_flow(e.engagement);return t?{uid:t.uid,$doc:l.get_engagement_message(t),pe:t}:null},t.get_oldest_pending_non_flow_engagement=function(e){const t=c.get_oldest_queued_non_flow(e.engagement);return t?{uid:t.uid,$doc:l.get_engagement_message(t),pe:t}:null},t.get_available_classes=function(e){return r.Enum.keys(a.CharacterClass).filter(e=>e!==a.CharacterClass.novice)},o.__exportStar(n(57),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);o.__exportStar(n(91),t),o.__exportStar(n(207),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importStar(n(4)),r=n(4),a=n(37),i=n(9),s=n(93),u="adventure_archetype--good",c=30;t.play_good=function(e,t){let n=e.u_state.prng;const l=r.get_prng(n),d=t?a.get_archetype(t):function(e,t){let n;return r.regenerate_until_not_recently_encountered({id:u,generate:()=>(n=a.pick_random_good_archetype(t)).hid,state:e.prng,max_tries:10*c}),n}(e.u_state,l);if(!d)throw new Error(`${i.LIB}: play_good(): hinted adventure archetype "${t}" could not be found!`);if(!d.good)throw new Error(`${i.LIB}: play_good(): hinted adventure archetype "${t}" is a "bad click" one!`);return t||(n=o.update_use_count(e.u_state.prng,l)),e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{prng:r.register_recently_used(n,u,d.hid,c)})}),e=s.play_adventure(e,d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importStar(n(4)),r=n(4),a=n(37),i=n(9),s=n(93),u="adventure_archetype--bad",c=2;t.play_bad=function(e,t){let n=e.u_state.prng;const l=r.get_prng(n),d=t?a.get_archetype(t):function(e,t){let n;return r.regenerate_until_not_recently_encountered({id:u,generate:()=>(n=a.pick_random_bad_archetype(t)).hid,state:e.prng,max_tries:10*c}),n}(e.u_state,l);if(!d)throw new Error(`${i.LIB}: play_bad(): hinted adventure archetype "${t}" could not be found!`);if(d.good)throw new Error(`${i.LIB}: play_bad(): hinted adventure archetype "${t}" is a "good click" one!`);return t||(n=o.update_use_count(e.u_state.prng,l)),e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{prng:r.register_recently_used(n,u,d.hid,c)})}),e=s.play_adventure(e,d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importStar(n(14)),a=o.__importStar(n(12)),i=o.__importStar(n(4)),s=o.__importStar(n(24)),u=o.__importStar(n(15)),c=n(1),l=n(4),d=n(11),_=n(13),m=n(18),h=n(205),g=n(19),p=n(26),f=n(94),y=n(38);t.attempt_to_redeem_code=function(e,t){let n=m.EngagementKey["code_redemption--failed"],o={};t=s.normalize_code(t);const v=h.CODE_SPECS_BY_KEY[t];let{u_state:b,t_state:w}=e;if(v&&s.is_code_redeemable(b.codes,v,e))switch(b=(e=g._update_to_now(e)).u_state,w=e.t_state,b=Object.assign({},b,{codes:s.attempt_to_redeem_code(b.codes,v,e)}),n=m.EngagementKey["code_redemption--succeeded"],o.code=t,t){case"TESTNOTIFS":b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.flow,key:m.EngagementKey["hello_world--flow"]},{name:"flow from TESTNOTIFS"})}),b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.aside,key:m.EngagementKey["hello_world--aside"]},{name:"aside default from TESTNOTIFS"})}),b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.aside,key:m.EngagementKey["hello_world--aside"]},{semantic_level:"error",name:"aside error from TESTNOTIFS"})}),b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.aside,key:m.EngagementKey["hello_world--aside"]},{semantic_level:"warning",name:"aside warning from TESTNOTIFS"})}),b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.aside,key:m.EngagementKey["hello_world--aside"]},{semantic_level:"info",name:"aside info from TESTNOTIFS"})}),b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.aside,key:m.EngagementKey["hello_world--aside"]},{semantic_level:"success",name:"aside success from TESTNOTIFS"})}),b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.warning,key:m.EngagementKey["hello_world--warning"]},{name:"warning from TESTNOTIFS"})});break;case"TESTACH":b=Object.assign({},b,{progress:u.on_achieved(b.progress,"TEST",u.AchievementStatus.revealed)});break;case"BORED":w=Object.assign({},w,{energy:r.restore_energy([b.energy,w.energy],1)});break;case"XYZZY":b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.flow,key:m.EngagementKey["just-some-text"]},{text:"fee fie foe foo ;)"})});break;case"PLUGH":b=Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.flow,key:m.EngagementKey["just-some-text"]},{text:'A hollow voice says "Ahhhhhhh".'})});break;case"REBORNX":e=y.reseed(e),b=(e=f.reset_and_salvage(e)).u_state,w=e.t_state,b=Object.assign({},b,{progress:u.on_achieved(b.progress,"Reborn!",u.AchievementStatus.unlocked)});break;case"REBORN":b=(e=f.reset_and_salvage(e)).u_state,w=e.t_state,b=Object.assign({},b,{progress:u.on_achieved(b.progress,"Reborn!",u.AchievementStatus.unlocked)});break;case"ALPHATWINK":{const t=l.get_prng(b.prng),n=d.create(t,{quality:c.ItemQuality.artifact,qualifier2_hid:"twink"}),o=_.create(t,{quality:c.ItemQuality.artifact,qualifier2_hid:"twink"});e=g._auto_make_room(e),e=g._receive_item(e,n),e=g._auto_make_room(e),b=(e=g._receive_item(e,o)).u_state,w=e.t_state,b=Object.assign({},b,{prng:i.update_use_count(b.prng,t,6)});break}default:throw new Error(`Internal error: code "${t}" not implemented!`)}return p._refresh_achievements(Object.assign({},e,{u_state:Object.assign({},b,{engagement:a.enqueue(b.engagement,{type:a.EngagementType.flow,key:n},o),revision:b.revision+1}),t_state:w}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5),r=n(24),a=n(17),i={TESTNOTIFS:{redeem_limit:null,is_redeemable:()=>!0},TESTACH:{redeem_limit:null,is_redeemable:()=>!0},REBORNX:{redeem_limit:null,is_redeemable:()=>a.is_alpha()}},s={REBORN:{redeem_limit:null,is_redeemable:()=>a.is_alpha()},ALPHATWINK:{redeem_limit:1,is_redeemable:()=>a.is_alpha()}},u={BORED:{redeem_limit:null,is_redeemable:(e,t)=>{if(!(a.get_available_energy_float(e.t_state)<1))return!1;if(!t.redeemed_codes.BORED)return!0;const n=o.get_human_readable_UTC_timestamp_minutes(),r=t.redeemed_codes.BORED.last_redeem_date_minutes;return!(n.slice(0,8)===r.slice(0,8))}},XYZZY:{redeem_limit:null,is_redeemable:()=>!0},PLUGH:{redeem_limit:null,is_redeemable:()=>!0}},c=Object.assign({},i,s,u),l=Object.keys(c).map(e=>{const{code:t,redeem_limit:n,is_redeemable:o}=c[e];if(t)throw new Error(`Code entry "${e}" redundantly specifies a code!`);if(e!==r.normalize_code(e))throw new Error(`Code entry "${e}" should have normalized form "${r.normalize_code(e)}"!`);return{code:e,redeem_limit:n,is_redeemable:o}}).reduce((e,t)=>(e[t.code]=t,e),{});t.CODE_SPECS_BY_KEY=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(2),a=n(6),i=n(5),s=o.__importStar(n(7)),u=o.__importStar(n(14)),c=n(7),l=n(17),d=n(19),_=n(59),m=n(92),h=n(26);function g(e,t={}){const{DEBUG:n}=t;if(n&&console.log(`  - Autogroom… (inventory holding ${e.u_state.inventory.unslotted.length} items)`),e.u_state.avatar.klass===c.CharacterClass.novice){let t=a.Random.pick(a.Random.engines.nativeMath,r.Enum.values(c.CharacterClass));n&&console.log(`    - Changing class to ${t}…`),e=_.change_avatar_class(e,t)}if(e.u_state.avatar.name===s.DEFAULT_AVATAR_NAME){let t="A"+e.u_state.uuid.slice(3);n&&console.log(`    - renaming to ${t}…`),e=_.rename_avatar(e,t)}const o=l.find_better_unequipped_weapon(e.u_state);o&&(e=_.equip_item(e,o.uuid));const i=l.find_better_unequipped_armor(e.u_state);return i&&(e=_.equip_item(e,i.uuid)),e=d._auto_make_room(e,t),e=d._ack_all_engagements(e)}t._autogroom=g,t.autoplay=function(e,t={}){let{target_good_play_count:n,target_bad_play_count:o,DEBUG:r}=t;if(r&&console.log(`- Autoplay g=${n}, b=${o}..`),o=o||0,(n=n||0)<0)throw new Error("invalid target_good_play_count!");if(o<0)throw new Error("invalid target_bad_play_count!");0===n&&0===o&&(n=e.u_state.progress.statistics.good_play_count+1);let a=(()=>{const t=Math.ceil((n-e.u_state.progress.statistics.good_play_count)/8),o=Number(i.get_human_readable_UTC_timestamp_days())-t;return Math.min(o,Number(e.u_state.progress.statistics.last_visited_timestamp))})();a!==Number(e.u_state.progress.statistics.last_visited_timestamp)&&(e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{progress:Object.assign({},e.u_state.progress,{statistics:Object.assign({},e.u_state.progress.statistics,{last_visited_timestamp:String(a)})})})})),e=g(e,t);let s=l.get_available_energy_float(e.t_state)>=1;if(o>e.u_state.progress.statistics.bad_play_count){s&&(e=d._loose_all_energy(e));for(let n=e.u_state.progress.statistics.bad_play_count;n<o;++n)r&&console.log("  - playing bad..."),e=g(e=m.play(e),t)}if(n>e.u_state.progress.statistics.good_play_count)for(let o=e.u_state.progress.statistics.good_play_count;o<n;++o){if(!(s=l.get_available_energy_float(e.t_state)>=1)){const t=u.restore_energy([e.u_state.energy,e.t_state.energy]);a++,e=Object.assign({},e,{u_state:Object.assign({},e.u_state,{progress:Object.assign({},e.u_state.progress,{statistics:Object.assign({},e.u_state.progress.statistics,{last_visited_timestamp:String(a)})})}),t_state:Object.assign({},e.t_state,{energy:t})})}r&&console.log("  - playing good..."),e=g(e=m.play(e),t)}return e=h._refresh_achievements(e),e=d._ack_all_engagements(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importStar(n(7)),a=o.__importStar(n(23)),i=o.__importStar(n(8)),s=o.__importStar(n(4)),u=o.__importStar(n(14)),c=o.__importStar(n(12)),l=o.__importStar(n(24)),d=o.__importStar(n(15)),_=o.__importStar(n(35)),m=n(9),h=n(39),g=n(94),p=9;t.SUB_U_REDUCERS_COUNT=p;const f=4,y=1,v=0;t.migrate_to_latest=function(e,t,n={}){const o=(()=>t&&t.schema_version?t.schema_version:0)();return(e=h.get_lib_SEC(e).setAnalyticsAndErrorDetails({version_from:o,version_to:m.SCHEMA_VERSION})).xTry("migrate_to_latest",({SEC:e,logger:h})=>{if(o>m.SCHEMA_VERSION)throw new Error("Your data is from a more recent version of this lib. Please update!");let b=t;if(o<m.SCHEMA_VERSION){h.warn(`${m.LIB}: attempting to migrate schema from v${o} to v${m.SCHEMA_VERSION}:`),e.fireAnalyticsEvent("schema_migration.began");try{b=function(e,t,n){if(t.schema_version>=10)throw new Error("migrate_to_10 was called from an outdated/buggy root code, please update!");throw new Error("Alpha release outdated schema, won’t migrate, would take too much time and schema is still unstable!")}(0,t)}catch(n){e.fireAnalyticsEvent("schema_migration.failed",{step:"main"}),h.error(`${m.LIB}: failed migrating schema, reseting and salvaging!`,{err:n}),b=g.reset_and_salvage(t),e.fireAnalyticsEvent("schema_migration.salvaged",{step:"main"})}}try{let{u_state:w,t_state:E}=b;!function(){if(Object.keys(w).length!==p+f)throw h.error("migrate_to_latest",{SUB_REDUCERS_COUNT:p,OTHER_KEYS_COUNT:f,actual_count:Object.keys(w).length,keys:Object.keys(w)}),new Error("migrate_to_latest src [S.U.1] is outdated, please update!");let t=[];if((w=Object.assign({},w)).avatar=r.migrate_to_latest(e,w.avatar,n.avatar),t.push("avatar"),w.inventory=i.migrate_to_latest(e,w.inventory,n.inventory),t.push("inventory"),w.wallet=a.migrate_to_latest(e,w.wallet,n.wallet),t.push("wallet"),w.prng=s.migrate_to_latest(e,w.prng,n.prng),t.push("prng"),w.energy=u.migrate_to_latest(e,[w.energy,E.energy],n.energy)[0],t.push("energy"),w.engagement=c.migrate_to_latest(e,w.engagement,n.engagement),t.push("engagement"),w.codes=l.migrate_to_latest(e,w.codes,n.codes),t.push("codes"),w.progress=d.migrate_to_latest(e,w.progress,n.progress),t.push("progress"),w.meta=_.migrate_to_latest(e,w.meta,n.meta),t.push("meta"),t.length!==p)throw new Error("migrate_to_latest src [S.U.2] is outdated, please update!")}(),function(){if(Object.keys(E).length!==y+v)throw h.error("migrate_to_latest",{SUB_REDUCERS_COUNT:y,OTHER_KEYS_COUNT:v,actual_count:Object.keys(E).length,keys:Object.keys(E)}),new Error("migrate_to_latest src [S.T.1] is outdated, please update!");let t=[];if((E=Object.assign({},E)).energy=u.migrate_to_latest(e,[w.energy,E.energy],n.energy)[1],t.push("energy"),t.length!==y)throw new Error("migrate_to_latest src [S.T.2] is outdated, please update!")}(),b=Object.assign({},b,{u_state:w,t_state:E}),h.info(`${m.LIB}: schema migration from v${o} to v${m.SCHEMA_VERSION} successful.`),e.fireAnalyticsEvent("schema migration.ended")}catch(n){e.fireAnalyticsEvent("schema_migration.failed",{step:"sub"}),h.error(`${m.LIB}: failed migrating sub-reducers, reseting and salvaging!`,{err:n}),b=g.reset_and_salvage(t),e.fireAnalyticsEvent("schema_migration.salvaged",{step:"sub"})}return b})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="0.58.3",t.BUILD_DATE="20190306_23h29"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importDefault(n(65)),a=o.__importDefault(n(210)),i=n(2),s=n(5),u=o.__importStar(n(20)),c=n(211),l=n(214),d=n(215),_=i.Enum("model_change","view_change");function m(e,t){return t}t.create_game_instance=function({SEC:e,app_state:t}){return e.xTry("creating tbrpg instance",({SEC:e,logger:n})=>{t=t||{};const o=new r.default,i=c.create(e,t.model,(e,t)=>{o.emit(_.model_change,`${t}[in-mem]`)});function h(e){i.dispatch(e)}return o.on(_.model_change,e=>{t=Object.assign({},t,{model:i.get()}),o.emit(_.view_change,`model.${e}`)}),{commands:Object.assign({},l.get_commands(h),{dispatch(e){h(e=Object.assign({},e,{time:e.time||s.get_UTC_timestamp_ms()}))}}),queries:Object.assign({},d.get_queries(i)),model:{get:i.get,set:i.set,reset(){const e=u.reseed(u.create());n.verbose("Savegame reseted:",{new_state:e}),i.set(e)},subscribe:(e,t)=>o.on(_.model_change,n=>{const{revision:o}=i.get().u_state;console.log(`🌀 model change #${o} reported to subscriber "${e}" (source: ${n})`),t()})},view:{get:()=>t,set_state(e){const n=e(t);console.log("⚡ view change requested",n),t=Object.assign({},a.default(t,n,{arrayMerge:m}),{model:i.get()}),o.emit(_.view_change,"set_state(…)")},subscribe:(e,t)=>o.on(_.view_change,n=>{console.log(`🌀🌀 root/view state change reported to subscriber "${e}" (model: #${i.get().u_state.revision}, source: view/${n})`),t()})},_libs:{"@tbrpg/state":u}}})}},function(e,t,n){e.exports=function(){"use strict";var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var n=Object.prototype.toString.call(e);return"[object RegExp]"===n||"[object Date]"===n||function(e){return e.$$typeof===t}(e)}(e)},t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,o){return e.concat(t).map(function(e){return n(e,o)})}function r(e,t,o){var r={};return o.isMergeableObject(e)&&Object.keys(e).forEach(function(t){r[t]=n(e[t],o)}),Object.keys(t).forEach(function(i){o.isMergeableObject(t[i])&&e[i]?r[i]=function(e,t){if(!t.customMerge)return a;var n=t.customMerge(e);return"function"==typeof n?n:a}(i,o)(e[i],t[i],o):r[i]=n(t[i],o)}),r}function a(t,a,i){(i=i||{}).arrayMerge=i.arrayMerge||o,i.isMergeableObject=i.isMergeableObject||e;var s=Array.isArray(a),u=Array.isArray(t),c=s===u;return c?s?i.arrayMerge(t,a,i):r(t,a,i):n(a,i)}return a.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(e,n){return a(e,n,t)},{})},a}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=o.__importDefault(n(212)),a=o.__importStar(n(20)),i=o.__importStar(n(4)),s=n(95),u=n(213);t.create=function(e,t,n){return e.xTry(`creating ${s.LIB} in-memory store`,({SEC:e,logger:o})=>{let s=t;const c=r.default(n);return e.xTry("auto creating/migrating",({SEC:e,logger:t})=>{const n=!s||0===Object.keys(s).length;s=n?a.reseed(a.create(e)):a.migrate_to_latest(e,s),n?t.verbose("Clean savegame created from scratch:",{state:s}):t.trace("migrated state:",{state:s}),s.u_state.prng.seed===i.DEFAULT_SEED&&(s=a.reseed(s),t.warn("re-seeding that shouldn’t be needed!")),c(s,"migration")}),{dispatch:function(e){s=u.reduce_action(s,e),c(s,e.type)},get:()=>s,set:e=>{c(s=e,"forced set()")}}})}},function(e,t,n){"use strict";n.r(t);var o=function(e,t){return e.length===t.length&&e.every(function(e,n){return o=e,r=t[n],o===r;var o,r})};t.default=function(e,t){var n;void 0===t&&(t=o);var r,a=[],i=!1;return function(){for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return i&&n===this&&t(s,a)?r:(r=e.apply(this,s),i=!0,n=this,a=s,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importStar(n(20)),r=n(42);t.reduce_action=function(e,t){const{expected_state_revision:n}=t;if(n&&e.u_state.revision!==n)throw new Error("Trying to execute an outdated action!");switch(t.type){case r.ActionType.on_start_session:return o.on_start_session(e,t.is_web_diversity_supporter);case r.ActionType.play:return o.play(e);case r.ActionType.equip_item:return o.equip_item(e,t.target_uuid);case r.ActionType.sell_item:return o.sell_item(e,t.target_uuid);case r.ActionType.rename_avatar:return o.rename_avatar(e,t.new_name);case r.ActionType.change_avatar_class:return o.change_avatar_class(e,t.new_class);case r.ActionType.redeem_code:return o.attempt_to_redeem_code(e,t.code);case r.ActionType.acknowledge_engagement_msg_seen:return o.acknowledge_engagement_msg_seen(e,t.uid);case r.ActionType.update_to_now:return o.update_to_now(e);case r.ActionType.hack:return t.custom_reducer(o.update_to_now(e));default:throw new Error("reduce_action(): Unhandled switch value(s)!")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5),r=n(42);t.get_commands=function(e){return{on_start_session(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.on_start_session,is_web_diversity_supporter:t};e(a)},play(t=o.get_UTC_timestamp_ms()){const n={time:t,type:r.ActionType.play};e(n)},equip_item(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.equip_item,target_uuid:t};e(a)},sell_item(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.sell_item,target_uuid:t};e(a)},rename_avatar(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.rename_avatar,new_name:t};e(a)},change_avatar_class(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.change_avatar_class,new_class:t};e(a)},attempt_to_redeem_code(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.redeem_code,code:t};e(a)},acknowledge_engagement_msg_seen(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.acknowledge_engagement_msg_seen,uid:t};e(a)},update_to_now(t=o.get_UTC_timestamp_ms()){const n={time:t,type:r.ActionType.update_to_now};e(n)},custom(t,n=o.get_UTC_timestamp_ms()){const a={time:n,type:r.ActionType.hack,custom_reducer:t};e(a)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0).__importStar(n(20)),r=n(216);t.get_queries=function(e){return{get_item:(t,n=e.get())=>o.get_item(n.u_state,t),appraise_item_value:(t,n=e.get())=>o.appraise_item_value(n.u_state,t),appraise_item_power:(t,n=e.get())=>o.appraise_item_power(n.u_state,t),find_element:(t,n=e.get())=>o.find_element(n.u_state,t),get_actions_for_element:(t,n=e.get())=>r.get_actions_for_element(n.u_state,t),get_oldest_pending_flow_engagement:(t=e.get())=>o.get_oldest_pending_flow_engagement(t.u_state),get_oldest_pending_non_flow_engagement:(t=e.get())=>o.get_oldest_pending_non_flow_engagement(t.u_state),get_achievements_snapshot:(t=e.get())=>o.get_achievements_snapshot(t.u_state),get_available_energy_float:(t=e.get())=>o.get_available_energy_float(t.t_state),get_human_time_to_next_energy:(t=e.get())=>o.get_human_time_to_next_energy(t),get_achievements_completion:(t=e.get())=>o.get_achievements_completion(t.u_state),get_last_adventure:(t=e.get())=>t.u_state.last_adventure,get_recap:(t=e.get())=>o.get_recap(t.u_state),is_inventory_full:(t=e.get())=>o.is_inventory_full(t.u_state),get_available_classes:(t=e.get())=>o.get_available_classes(t.u_state),get_sub_state:(t,n=e.get())=>n.u_state[t]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(8),r=n(42);t.get_actions_for_element=function(e,t){const n=[];return o.get_unslotted_item(e.inventory,t)&&n.push(...function(e,t){const n=[],o={time:0,type:r.ActionType.equip_item,target_uuid:t};n.push(o);const a={time:0,type:r.ActionType.sell_item,target_uuid:t};return n.push(a),n}(0,t)),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.result={},delete t.error,t}}]));